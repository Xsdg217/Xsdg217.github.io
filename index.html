<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|Amita:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="BLOG">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="BLOG">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Hsu Quinn">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>BLOG</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ER8FH828WC"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ER8FH828WC');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d5cf64a751ac91d8a331bada0477e161";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">BLOG</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/06/2023-3-6-Linux-%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A42/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/06/2023-3-6-Linux-%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A42/" class="post-title-link" itemprop="url">Linux 基本命令与 Shell 脚本(2)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-06 13:03:04 / 修改时间：13:09:37" itemprop="dateCreated datePublished" datetime="2023-03-06T13:03:04+08:00">2023-03-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Some-Notes/" itemprop="url" rel="index"><span itemprop="name">Some Notes</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1-tar"><a href="#1-tar" class="headerlink" title="1. tar"></a>1. tar</h3><h3 id="About-tar"><a href="#About-tar" class="headerlink" title="About tar"></a>About tar</h3><p>-c: 建立压缩档案<br>-x：解压<br>-t：查看内容<br>-r：向压缩归档文件末尾追加文件<br>-u：更新原压缩包中的文件</p>
<p>-z：有gzip属性的<br>-j：有bz2属性的<br>-Z：有compress属性的<br>-v：显示所有过程<br>-O：将文件解开到标准输出</p>
<p>-f: 使用档案名字，切记，这个参数是最后一个参数，后面只能接档案名。</p>
<p><strong>Summary：</strong></p>
<p><em>.tar 用 tar -xvf 解压
</em>.gz 用 gzip -d或者gunzip 解压<br>.tar.gz和.tgz 用 tar -xzf 解压<br><em>.bz2 用 bzip2 -d或者用bunzip2 解压
</em>.tar.bz2用tar -xjf 解压<br><em>.Z 用 uncompress 解压
</em>.tar.Z 用tar -xZf 解压<br><em>.rar 用 unrar e解压
</em>.zip 用 unzip 解压</p>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/03/06/%E8%87%AA%E6%97%8B%E8%BD%A8%E9%81%93%E8%80%A6%E5%90%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/06/%E8%87%AA%E6%97%8B%E8%BD%A8%E9%81%93%E8%80%A6%E5%90%88/" class="post-title-link" itemprop="url">自旋轨道耦合（Spin–orbit interaction）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-03-06 00:05:30 / 修改时间：00:06:28" itemprop="dateCreated datePublished" datetime="2023-03-06T00:05:30+08:00">2023-03-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Some-Notes/" itemprop="url" rel="index"><span itemprop="name">Some Notes</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Spin–orbit-interaction"><a href="#Spin–orbit-interaction" class="headerlink" title="Spin–orbit interaction"></a>Spin–orbit interaction</h2><h3 id="1-自旋轨道耦合效应的起源："><a href="#1-自旋轨道耦合效应的起源：" class="headerlink" title="1 自旋轨道耦合效应的起源："></a>1 自旋轨道耦合效应的起源：</h3><p>​    自旋轨道耦合效应其实就是电子绕原子核旋转产生的轨道磁矩与电子自身具有的自旋磁矩的相互作用，略去磁矩就称之为自旋轨道耦合效应：</p>
<script type="math/tex; mode=display">
U_{S} = -\mu_{s}B_{R}</script><p>​    狭义相对论给出：</p>
<script type="math/tex; mode=display">
U_s=\left(g_s-1\right) \frac{1}{2} \frac{1}{4 \pi \varepsilon_0} \frac{Z e^2}{r^3} \frac{1}{m^2 c^2} \mathbf{1} \cdot \mathbf{S}</script><script type="math/tex; mode=display">
H_{s o}=-\frac{\hbar}{4 m^2 c^2} \sigma \cdot p \times \quad\left(\nabla V_0\right)</script><p>​    关于对称性P，T：</p>
<script type="math/tex; mode=display">
\begin{aligned}
& T H(k) T^{-1}=H(-k)^* \\
& T: t \rightarrow-t \\
& P H(k) P^{-1}=H(-k) \\
& P: x, y, z \rightarrow-x,-y,-z
\end{aligned}</script><p>​    在 k→−k 不变的那些时间反演动量不变点（TRIM）上有：</p>
<p>​    如果存在空间反演对称性P，那么每个TRIM 上的点都和 P 对易，每个本征态都可以用 P 的本征值+-1 来标记。如果有 T，那么由 Kramer简并 ，每个 TRIM 上的本征态都是二重简并的。如果同时具有俩种对称性那么，整个布里渊区上由于 Kramer degeneracy 都是二重简并的。</p>
<p>​    对于无中心反演对称的情况，SOC的出现会破坏Kramer degeneracy ，导致能级的退简并，而对于时间反演对称性无关，所以说Kramer degeneracy是受时间反演对称性保护的。所以通常的拓扑绝缘体都是无磁有时间反演对称的SOC的材料。如果其中一个对称性破缺，但是体系仍然具有PT联合的 对称性，那么整个布里渊区上由于 Kramer degeneracy 都是二重简并的结论仍然成立。</p>
<p>​    </p>
<h3 id="2-自旋轨道耦合效应分类："><a href="#2-自旋轨道耦合效应分类：" class="headerlink" title="2 自旋轨道耦合效应分类："></a>2 自旋轨道耦合效应分类：</h3><h4 id="1-Rashba自旋轨道耦合效应"><a href="#1-Rashba自旋轨道耦合效应" class="headerlink" title="1 Rashba自旋轨道耦合效应"></a>1 Rashba自旋轨道耦合效应</h4><p>​    由于材料的结构反演不对称导致的能带倾斜的情况，在二维垂直平面内再加一个有效点场后，带电粒子在此平面的运动就会受到磁场的作用。门电压调节强度</p>
<script type="math/tex; mode=display">
H_R=-\alpha_R(\sigma \times p) \cdot z=-\alpha_R\left(\sigma_x p_y-\sigma_y p_x\right)</script><h4 id="2-Dresselhauss自旋轨道耦合"><a href="#2-Dresselhauss自旋轨道耦合" class="headerlink" title="2 Dresselhauss自旋轨道耦合"></a>2 Dresselhauss自旋轨道耦合</h4><p>​    在没有反演对称性的晶体结构中，导带由于自旋轨道耦合而引起的能级劈裂，劈裂的大小正比于波函数的3次方:</p>
<script type="math/tex; mode=display">
H=\beta\left[\sigma_x k_x\left(k_y^2-k_x^2\right)+\sigma_y k_y\left(k_z^2-k_x^2\right)+\sigma_z k_z\left(k_z^2-k_y^{2)}\right]\right.</script><p>​    两者线性项产生等效的磁场：</p>
<div  align="center">    
<img src=https://s2.loli.net/2023/03/06/eiWOcJSHIwrLUgE.jpg />
</div>
      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/02/26/linux%20command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/02/26/linux%20command/" class="post-title-link" itemprop="url">Linux 基本命令与 Shell 脚本(1)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-02-26 23:06:04" itemprop="dateCreated datePublished" datetime="2023-02-26T23:06:04+08:00">2023-02-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-03-06 13:08:29" itemprop="dateModified" datetime="2023-03-06T13:08:29+08:00">2023-03-06</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Some-Notes/" itemprop="url" rel="index"><span itemprop="name">Some Notes</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>开个小坑，记一下要用的脚本命令啥的</p>
<p>pwd —打印出当前工作目录名</p>
<p>cd —更改目录</p>
<p>ls —列出目录内容</p>
<p>cd /usr/bin——回到绝对路径下的目录</p>
<p>cd ..——回到上级目录</p>
<p>ls——在当前目 录下所有文件和子目录的列表</p>
<p>ls /usr 查看指定目录下的文件</p>
<p>ls -1 查看目录下文件的更多信息</p>
<p>ls -a 列出所有文件 </p>
<p>ls -h 以字节数显示文件大小</p>
<p>ls -t 按照修改时间</p>
<p>ls -r 反向排序</p>
<p>less filename 浏览文件内容</p>
<p>cp —复制文件和目录 </p>
<p>mv —移动/重命名文件和目录 </p>
<p>mkdir —创建目录 </p>
<p>rm —删除文件和目录 </p>
<p> ln —创建硬链接和符号链接</p>
<p>type –说明怎样解释一个命令名 </p>
<p>which –显示会执行哪个可执行程序 </p>
<p>man –显示命令手册页 </p>
<p>apropos –显示一系列适合的命令 </p>
<p>info –显示命令 info </p>
<p>whatis –显示一个命令的简洁描述 </p>
<p>alias –创建命令别名</p>
<p>cat －连接文件 </p>
<p>sort －排序文本行 </p>
<p>uniq －报道或省略重复行 </p>
<p>grep －打印匹配行 </p>
<p>wc －打印文件中换行符，字，和字节个数 </p>
<p>head －输出文件第一部分 </p>
<p>tail - 输出文件最后一部分 </p>
<p>tee - 从标准输入读取数据，并同时写到标准输出和文件</p>
<p>clear - 清空屏幕</p>
<p>history - 显示历史记录</p>
<p>grep “cm-1” OUTCAR-查看频率</p>
<p>grep “f/i” OUTCAR 查看虚频</p>
<p> tail -f OSZICAR 查看收敛能量</p>
<p>grep E-fermi OUTCAR 查看费米能级</p>
<p>grep irreducible OUTCAR 查看倒格矢</p>
<p>grep ZVAL OUTCAR 查看价电子</p>
<p>grep TIT POTCAR 检查赝势</p>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/28/AF-transition-in-Hubbard-Model/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/28/AF-transition-in-Hubbard-Model/" class="post-title-link" itemprop="url">AF transition in Hubbard Model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-28 21:31:23 / 修改时间：22:30:44" itemprop="dateCreated datePublished" datetime="2022-12-28T21:31:23+08:00">2022-12-28</time>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Antiferromagnetic-Transition-in-the-Hubbard-Model"><a href="#Antiferromagnetic-Transition-in-the-Hubbard-Model" class="headerlink" title="Antiferromagnetic Transition in the Hubbard Model"></a>Antiferromagnetic Transition in the Hubbard Model</h2><ul>
<li><h3 id="The-Hubard-Model"><a href="#The-Hubard-Model" class="headerlink" title="The Hubard Model"></a>The Hubard Model</h3><p>哈伯德模型是对费米子通过短程相互作用相互作用的程式化描述。哈密顿量描述如下：</p>
<script type="math/tex; mode=display">
H = - \sum_{s,\langle i,j\rangle}t_{ij}c_{is}^{+}c_{js} + U\sum_{j}c_{j\downarrow}^{+}c_{j\uparrow}^{+}c_{j\uparrow}c_{j\downarrow}</script><p>如下图所示，蓝色框内是选取的 unit cell。箭头线表示 n.n. 的hoping，大小为 t，相位为 pi/4。单线表示对角的 hopping，大小为 t’，相位为 0（虚线） 或者 pi（实线）。</p>
</li>
</ul>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/12/28/LAbNOsUo7qCftH8.gif style="zoom:50%" />
  </div>

<ul>
<li><h3 id="Mean-Field-Solution"><a href="#Mean-Field-Solution" class="headerlink" title="Mean-Field Solution"></a>Mean-Field Solution</h3><p>平均场近似下，四体相互作用替换为两体相互作用：</p>
<script type="math/tex; mode=display">
c_{j \downarrow}^{\dagger} c_{j \uparrow}^{\dagger} c_{j \uparrow} c_{j \downarrow} \rightarrow\left\langle c_{j \downarrow}^{\dagger} c_{j \downarrow}\right\rangle c_{j \uparrow}^{\dagger} c_{j \uparrow}+\left\langle c_{j \uparrow}^{\dagger} c_{j \uparrow}\right\rangle c_{j \downarrow}^{\dagger} c_{j \downarrow}</script><p>预测反铁磁性，我们猜测平均磁场值：</p>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/12/28/HW_QMC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/12/28/HW_QMC/" class="post-title-link" itemprop="url">Monte Carlo Wave Functions in Non-Hermitian Evolution </font></a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-12-28 21:10:30 / 修改时间：21:23:52" itemprop="dateCreated datePublished" datetime="2022-12-28T21:10:30+08:00">2022-12-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Monte Carlo Wave Functions in Non-Hermitian Evolution </font>

<ul>
<li><p>A bit of theory : non-hermitian evolution</p>
<p>  首先是关于我们研究问题的背景。我们知道，量子力学领域中，厄米系统是比较常见的系统，其显著特点就是该系统下的哈密顿量等于其哈密顿量的共轭。如果我们考虑一个开放系统，也就是一个小的系统和环境之间的耦合的过程，它的密度矩阵演化可以近似用一个主方程来描述: </p>
<script type="math/tex; mode=display">
  \dot{\rho}=-\frac{\mathrm{i}}{\hbar}\left[\mathcal{H}_s, \rho\right]+\mathcal{L}[\rho]</script><p>  其中第二项描述的就是不可逆耗散的非厄密部分：</p>
<script type="math/tex; mode=display">
  \mathcal{L}[\rho]=-\frac{1}{2} \sum_i\left(C_i^{\dagger} C_i \rho+\rho C_i^{\dagger} C_i\right)+\sum_i C_i \rho C_i^{\dagger}</script><p>  我们做一个简单的重写，将主方程中的耗散项写进对易关系里：</p>
<script type="math/tex; mode=display">
  \dot{\rho}=-\frac{\mathrm{i}}{\hbar}\left(\mathcal{H}_{\text {eff }} \rho-\rho \mathcal{H}_{\text {eff }}^{\dagger}\right)+\mathcal{L}_{\text {jump }}[\rho]</script><p>  其中</p>
<script type="math/tex; mode=display">
  \mathcal{H}_{\mathrm{eff}} \equiv \mathcal{H}_s-\frac{\mathrm{i} \hbar}{2} \sum_i C_i^{\dagger} C_i</script><script type="math/tex; mode=display">
  \mathcal{L}_{\text {jump }}[\rho] \equiv \sum_i C_i \rho C_i^{\dagger}</script><p>  得到了一个非厄密的有效哈密顿量和一个量子跃迁项。这也就意味着，我们对态矢的演化可以分解为一个Schrödinger-like的部分和一个jump的部分，蒙特卡洛模拟就是对大量的这种演化过程做统计平均。</p>
<p>  对于有效非厄密哈密顿量，$C$ 是湮灭算符，对应于一个单独的不可逆过程，速率是 $\gamma$。非厄密的结果是耗散的产生，可以来描述有系统和环境耦合的情形，注意到对于极小时间内的一个演化，波函数是不归一的，即</p>
<script type="math/tex; mode=display">
  |\tilde{\psi}(t+\delta t)\rangle=\left(1-\frac{\mathrm{i} \mathcal{H}_{\mathrm{eff}} \delta t}{\hbar}\right)|\psi(t)\rangle</script><script type="math/tex; mode=display">
  \begin{aligned}
  & \langle\tilde{\psi}(t+\delta t)| \tilde{\psi}(t+\delta t)\rangle=\left\langle\psi(t)\left|\left(1+\frac{\mathrm{i \mathcal {H }}_{\mathrm{eff}}^{\dagger} \delta t}{\hbar}\right)\left(1-\frac{\mathcal{i \mathcal { H }}_{\mathrm{eff}} \delta t}{\hbar}\right)\right| \psi(t)\right\rangle =1-\delta p \\
  &
  \end{aligned}</script><script type="math/tex; mode=display">
  \delta p=\frac{\mathrm{i}}{\hbar} \delta t\left\langle\psi(t)\left|\mathcal{H}_{\mathrm{eff}}-\mathcal{H}_{\mathrm{eff}}^{\dagger}\right| \psi(t)\right\rangle=\delta t     \sum_i\left\langle\psi(t)\left|C_i^{\dagger} C_i\right| \psi(t)\right\rangle \equiv \sum_i \delta p_i</script><p>  其中 $\delta p$ 的损失是因为没有考虑 $L_{jump}$ 项，可以理解为量子跃迁（decay）概率的占比。因此对于计算模拟而言，可以用蒙特卡洛来选择是进行非厄密演化还是量子跃迁。</p>
<p>  一个一般化的计算流程：</p>
  <div  align="left">    
  <img src=https://s2.loli.net/2022/12/28/BfDY5WtzaQ17lb9.png style="zoom:60%" />   
  </div>




</li>
</ul>
<ul>
<li><p>下面是具体的模拟计算：</p>
</li>
<li><p>首先是一个 easy 的 toy test，考虑一个 optical cavity 的光场。实际上就是去求解一个大的矩阵。显然是比较麻烦的，我们只想做一下简单的测试，那么考虑弱耦合的情形，并假设初态零温真空光场的光子数很多，取初始态为 $|n = 1000\rangle$，每一步发生 jump， 即耗散一个光子到环境中的概率为：</p>
<script type="math/tex; mode=display">
  \delta_p=\delta_t \gamma\left\langle\phi\left|a^{\dagger} a\right| \phi\right\rangle=\delta_t \gamma n</script><p>  判断 random r 和 $\delta p$ 的大小关系，决定下一步是 $|n\rangle$ 还是 $|n-1\rangle$</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#weak coupling</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">num = <span class="number">1000</span>                                                  <span class="comment"># 模拟轨迹次数</span></span><br><span class="line">iteration = <span class="number">10000</span>                                           <span class="comment"># 迭代次数</span></span><br><span class="line">alpha = <span class="number">0.001</span>                                               <span class="comment"># 衰减速率 gamma</span></span><br><span class="line">dt = <span class="number">0.5</span>                                                    <span class="comment"># 间隔 delta t</span></span><br><span class="line">initnum = <span class="number">1000</span>                                              <span class="comment"># 初始腔内的光子数目            </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">singlemc</span>():</span><br><span class="line">    count = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iteration):</span><br><span class="line">        count.append(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        n = initnum</span><br><span class="line">        <span class="keyword">for</span> step <span class="keyword">in</span> <span class="built_in">range</span>(iteration):</span><br><span class="line">            count[step] += n                                <span class="comment"># count 对时间步做光子数的统计(平均)</span></span><br><span class="line">            r = np.random.random()</span><br><span class="line">            delta = alpha * dt * n</span><br><span class="line">            <span class="keyword">if</span> (r&gt;delta):</span><br><span class="line">                n = n                                       <span class="comment"># 演化</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                n = (n-<span class="number">1</span>) <span class="keyword">if</span> n &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span>                   <span class="comment"># 光子耗散</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> count</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw</span>(<span class="params">array</span>):</span><br><span class="line">    x = []</span><br><span class="line">    y = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iteration):</span><br><span class="line">        x.append(i * dt)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> array:</span><br><span class="line">        y.append(item/num)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;t&#x27;</span>)  </span><br><span class="line">    plt.ylabel(<span class="string">&#x27;photons number&#x27;</span>)</span><br><span class="line">    plt.plot(x,y)</span><br><span class="line">    <span class="comment">#plt.legend()</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    ans = singlemc()</span><br><span class="line">    draw(ans)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Running time: %.4s Seconds&#x27;</span>%(end-start))</span><br><span class="line">    </span><br></pre></td></tr></table></figure>
<pre><code>Running time: 4.96 Seconds
</code></pre><p><img src="https://s2.loli.net/2022/12/28/n3NySbpTQaCEwGu.png" alt="png">)</p>
<ul>
<li><p>可以看到，这是一个指数衰减的过程，和理论是相匹配的：如上假设下的 cavity 内光子行为对应于无驱动力的阻尼衰减。</p>
</li>
<li><p>然后我们研究一下光耦合的两能级体系，模拟从高能级向低能级的衰减过程。理论上我们知道：</p>
<script type="math/tex; mode=display">
  \begin{gathered}
  \mathcal{H}_{\mathrm{eff}}=\frac{1}{2} \omega \sigma_z-\frac{\mathrm{i} \hbar \Gamma}{2} \sigma_{+} \sigma_{-} \\
  \mathcal{L}_{\text {jump }}[\rho]=\Gamma \sigma_{-} \rho \sigma_{+} .
  \end{gathered}</script><p>  数值模拟中，我们设初态为高能级占据态($|upper\rangle$)，每一步发生坍缩的概率应为：</p>
<script type="math/tex; mode=display">
  \delta_p=\delta_t \gamma\left\langle\phi\left|a^{\dagger} a\right| \phi\right\rangle=\delta_t \gamma|a|^2</script><p>  $|a|^2$ 是高能级的占据概率，判断 r 和 $\delta p$ 的大小关系，决定下一步是正常演化还是坍缩到低能级态($|lower\rangle$)。</p>
<p>  对于所谓的 pump, 我们用 w 来表示光激发的大小，下面分别取 w = 0,0.01,0.02,0.1, $\gamma$ 取  0.005， 1000次5000步间隔为 0.1(s)的模拟，得到了不同强度光激发下，高能级态占据数随时间变化的关系图：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#two level</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">num = <span class="number">1000</span>                                                      <span class="comment"># 模拟轨迹次数</span></span><br><span class="line">iteration = <span class="number">5000</span>                                                <span class="comment"># 迭代次数</span></span><br><span class="line">dt = <span class="number">0.1</span>                                                        <span class="comment"># 间隔 delta t</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setup</span>():</span><br><span class="line">    I = []</span><br><span class="line">    I.append((<span class="number">0</span>,<span class="number">0.005</span>))                                         <span class="comment"># （w,gamma）表示 pump 和 dacay 的强度</span></span><br><span class="line">    I.append((<span class="number">0.01</span>,<span class="number">0.005</span>))</span><br><span class="line">    I.append((<span class="number">0.02</span>,<span class="number">0.005</span>))</span><br><span class="line">    I.append((<span class="number">0.1</span>,<span class="number">0.005</span>))</span><br><span class="line">    <span class="keyword">return</span> I</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">evolution</span>(<span class="params">I</span>):       </span><br><span class="line">    ans = []</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> I:</span><br><span class="line">        w = item[<span class="number">0</span>]</span><br><span class="line">        alpha = item[<span class="number">1</span>]</span><br><span class="line">        A1 = []</span><br><span class="line">        A2 = []</span><br><span class="line">        P1 = []                                                 <span class="comment"># P1 存 高能级的占据概率</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iteration):</span><br><span class="line">            A1.append(<span class="number">0</span>)</span><br><span class="line">            A2.append(<span class="number">0</span>)</span><br><span class="line">            P1.append(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">            a1 = <span class="number">1</span></span><br><span class="line">            a2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> step <span class="keyword">in</span> <span class="built_in">range</span>(iteration):</span><br><span class="line">                A1[step] += a1</span><br><span class="line">                A2[step] += a2</span><br><span class="line">                r = np.random.random()</span><br><span class="line">                delta = alpha * dt * np.power(<span class="built_in">abs</span>(a1),<span class="number">2</span>)</span><br><span class="line">                <span class="keyword">if</span> (r&gt;delta):                                   <span class="comment"># 正常的nonhermitian 演化</span></span><br><span class="line">                    a1_new = a1 - <span class="number">1.0j</span> * dt * w * a2</span><br><span class="line">                    a2_new = - <span class="number">1.0j</span> * dt * w * a1 + a2 * (<span class="number">1.0</span> - alpha * dt)</span><br><span class="line">                    norm = np.sqrt(np.power(<span class="built_in">abs</span>(a1_new),<span class="number">2</span>) + np.power(<span class="built_in">abs</span>(a2_new),<span class="number">2</span>))       <span class="comment"># 注意要归一</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    a1_new = <span class="number">0</span>                                  <span class="comment"># 坍缩到低能级态</span></span><br><span class="line">                    b1_new = <span class="number">1</span></span><br><span class="line">                a1 = a1_new</span><br><span class="line">                a2 = a2_new</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iteration):</span><br><span class="line">            <span class="comment">#P1[i] = (np.power(abs(a1[i]),2)) / (num*num)</span></span><br><span class="line">            P1[i] = (<span class="built_in">abs</span>(A1[i])*<span class="built_in">abs</span>(A1[i])) / (num*num)</span><br><span class="line">        ans.append(P1)</span><br><span class="line">        cnt = cnt + <span class="number">1</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">str</span>(cnt)+<span class="string">&quot;/&quot;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(I))+<span class="string">&quot; finished &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_two_level</span>(<span class="params">array</span>):</span><br><span class="line">    index = <span class="number">221</span></span><br><span class="line">    plt.figure(figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br><span class="line">    x = []</span><br><span class="line">    y = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(iteration):</span><br><span class="line">        x.append(i * dt)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> array:</span><br><span class="line">        p1 = plt.subplot(index)</span><br><span class="line">        y = []</span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> item:</span><br><span class="line">            y.append(p)</span><br><span class="line">        plt.xlabel(<span class="string">&#x27;t&#x27;</span>)  </span><br><span class="line">        plt.ylabel(<span class="string">&#x27;occupation of state1&#x27;</span>)</span><br><span class="line">        plt.plot(x,y)</span><br><span class="line">        <span class="comment">#plt.legend()</span></span><br><span class="line">        index = index + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    start = time.time()</span><br><span class="line">    init = setup()</span><br><span class="line">    res = evolution(init)</span><br><span class="line">    draw_two_level(res)</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Running time: %.6s Seconds&#x27;</span>%(end-start))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>1/4 finished 
2/4 finished 
3/4 finished 
4/4 finished 
Running time: 126.53 Seconds
</code></pre><p><img src="https://s2.loli.net/2022/12/28/1ENclnwyhoq94Pp.png" alt="221226_6_1.png"></p>
<ul>
<li><p>Reference：</p>
<p>  [1] Meystre P, Sargent M. Elements of quantum optics[M]. Springer Science &amp; Business Media, 2007.</p>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/24/Eh&TSH/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/24/Eh&TSH/" class="post-title-link" itemprop="url">A bit theory of nonadiabatic dynamics</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-11-24 17:33:30 / 修改时间：17:34:44" itemprop="dateCreated datePublished" datetime="2022-11-24T17:33:30+08:00">2022-11-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Some-Notes/" itemprop="url" rel="index"><span itemprop="name">Some Notes</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Nonadiabatic-Dynamics"><a href="#Nonadiabatic-Dynamics" class="headerlink" title="Nonadiabatic Dynamics"></a>Nonadiabatic Dynamics</h2><h3 id="1-Ehrenfest-Dynamics"><a href="#1-Ehrenfest-Dynamics" class="headerlink" title="1. Ehrenfest Dynamics"></a><strong>1. Ehrenfest Dynamics</strong></h3><p>We use a single-configuration Ansatz for the total wavefunction:</p>
<script type="math/tex; mode=display">
\Psi(\boldsymbol{r}, \boldsymbol{R}, t)=\Phi(\boldsymbol{r}, t) \Omega(\boldsymbol{R}, t) \exp \left[\frac{i}{\hbar} \int_{t_0}^t d t^{\prime} E_{e l}\left(t^{\prime}\right)\right] .</script><p>The exponential part  is called the “phase term”:</p>
<script type="math/tex; mode=display">
\begin{gathered}
E_{e l}(t)=\iint d r d \boldsymbol{R} \Phi^*(\boldsymbol{r}, t) \Omega^*(\boldsymbol{R}, t) \hat{\mathcal{H}}_{e l}(\boldsymbol{r}, \boldsymbol{R}) 
\times \Phi(\boldsymbol{r}, t) \Omega(\boldsymbol{R}, t)
\end{gathered}</script><p>Insert the representation into TDSE,  left multiplication by $\Omega^*(R, t)$  and integrating over R：</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar  \frac{\partial \Phi(r, t)}{\partial t}=& -\frac{\hbar^2}{2} \sum_j \nabla_i^2 \Phi(r, t)\\
&+\left[\int d R \Omega^*(R, t) \hat{V}(r, R) \Omega(R, t)\right] \Phi(r, t) 
\end{aligned} \tag1</script><p>Similarly,</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar  \frac{\partial \Omega(\boldsymbol{R}, t)}{\partial t}&=-\frac{\hbar^2}{2} \sum_\gamma M_\gamma^{-1} \nabla_\gamma^2 \Omega(\boldsymbol{R}, t) \\
& +\left[\int d r \Phi^*(r, t) \hat{\mathcal{H}}_{e /}(r, R) \Phi(r, t)\right] \Omega(\boldsymbol{R}, t) .
\end{aligned} \tag 2</script><p> forms the so-called mean-field time-dependent self-consistent field (TDSCF) method.</p>
<h4 id="1-1-The-Time-Dependent-Nuclear-Equation"><a href="#1-1-The-Time-Dependent-Nuclear-Equation" class="headerlink" title="1.1  The Time-Dependent Nuclear Equation"></a>1.1  The Time-Dependent Nuclear Equation</h4><p>The  polar representation:</p>
<script type="math/tex; mode=display">
\Omega(\boldsymbol{R}, t)=A(\boldsymbol{R}, t) \exp \left[\frac{i}{\hbar} S(\boldsymbol{R}, t)\right] \tag3</script><p>Insert (3) into (2):</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar & \frac{\partial A(\boldsymbol{R}, t)}{\partial t}-A(\boldsymbol{R}, t) \frac{\partial S(\boldsymbol{R}, t)}{\partial t}=\\
&-\frac{\hbar^2}{2} \sum_\gamma M_\gamma^{-1} \nabla_\gamma^2 A(\boldsymbol{R}, t) 
-i \hbar \sum_\gamma M_\gamma^{-1} \nabla_\gamma A(\boldsymbol{R}, t) \cdot \nabla_\gamma S(\boldsymbol{R}, t) \\
&-\frac{i \hbar}{2} \sum_\gamma M_\gamma^{-1} A(\boldsymbol{R}, t) \nabla_\gamma^2 S(\boldsymbol{R}, t) 
+\frac{1}{2} \sum_\gamma M_\gamma^{-1} A(\boldsymbol{R}, t)\left(\nabla_\gamma S(\boldsymbol{R}, t)\right)^2 \\
&+\left[\int_\gamma \Phi^*(\boldsymbol{r}, t) \hat{\mathcal{H}}_{e /}(\boldsymbol{r}, \boldsymbol{R}) \Phi(\boldsymbol{r}, t)\right] A(\boldsymbol{R}, t) .
\end{aligned}</script><p>Taking the classical limit:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial S(R, t)}{\partial t}=&-\frac{1}{2} \sum_\gamma M_\gamma^{-1}\left(\nabla_\gamma S(R, t)\right)^2 \\
&-\left[\int d r \Phi^*(r, t) \hat{\mathcal{H}}_{e l}(r, R) \Phi(r, t)\right] 
\end{aligned}\tag 4</script><p>Like the “Hamilton–Jacobi” (HJ) equation, </p>
<script type="math/tex; mode=display">
\mathbf{P}\left(t_0\right)=\left.\nabla_{\mathbf{R}} S(\mathbf{R})\right|_{\mathbf{R}\left(t_0\right)}</script><p>We obtain the Newton-like equation for the nuclear trajectories corresponding to the HJ Equation (4):</p>
<script type="math/tex; mode=display">
\frac{d \boldsymbol{P}_\gamma(t)}{d t}=-\nabla_\gamma\left[\int d r \Phi^*(\boldsymbol{r}, t) \hat{\mathcal{H}}_{e l}(\boldsymbol{r}, \boldsymbol{R}(t)) \Phi(\boldsymbol{r}, t)\right]</script><p>or </p>
<script type="math/tex; mode=display">
M_\gamma \ddot{R}_\gamma(t)=-\nabla_\gamma\left\langle\hat{\mathcal{H}}_{e l}(\boldsymbol{r}, \boldsymbol{R}(t))\right\rangle \tag 5</script><h4 id="1-2-The-Time-Dependent-Electronic-Equation"><a href="#1-2-The-Time-Dependent-Electronic-Equation" class="headerlink" title="1.2   The Time-Dependent Electronic Equation"></a>1.2   The Time-Dependent Electronic Equation</h4><p>We take the classical limit of the nuclear degrees of freedom:</p>
<script type="math/tex; mode=display">
|\Omega(\boldsymbol{R}, t)|^2=\prod_\gamma \delta\left(\boldsymbol{R}_\gamma-\boldsymbol{R}_\gamma(t)\right)</script><script type="math/tex; mode=display">
i \hbar \frac{\partial \Phi(r ; R(t), t)}{\partial t}=\hat{\mathcal{H}}_{e l}(r, R(t)) \Phi(r ; R(t), t)</script><h3 id="2-BO-MD-and-Its-Nonadiabatic-Extensions"><a href="#2-BO-MD-and-Its-Nonadiabatic-Extensions" class="headerlink" title="2. BO-MD and Its Nonadiabatic Extensions"></a><strong>2. BO-MD and Its Nonadiabatic Extensions</strong></h3><script type="math/tex; mode=display">
\Psi(\boldsymbol{r}, \boldsymbol{R}, t)=\sum_i^{\infty} \Omega_i(\boldsymbol{R}, t) \Phi_i(\boldsymbol{r} ; \boldsymbol{R})\tag 6</script><script type="math/tex; mode=display">
\hat{\mathcal{H}}_{e l}(r, R) \Phi_i(r ; R)=E_i^{e l}(R) \Phi_i(r ; R)</script><p>Similarly,</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar \frac{\partial}{\partial t} \Omega_j(R, t)=& {\left[-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2+E_j^{e l}(R)\right] \Omega_j(R, t) } \\
&+\sum_j^{\infty} \mathcal{F}_{j i} \Omega_i(R, t) .
\end{aligned}\tag 7</script><script type="math/tex; mode=display">
\begin{aligned}
&\mathcal{F}_{j i}(\boldsymbol{R})=\int d \boldsymbol{r} \Phi_j^*(\boldsymbol{r}: \boldsymbol{R})\left[-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2\right] \Phi_i(\boldsymbol{r};\boldsymbol{R}) \\
&\quad+\sum_\gamma \frac{1}{M_\gamma}\left\{\int d r \Phi_j^*(\boldsymbol{r} ; \boldsymbol{R})\left[-i \hbar \nabla_\gamma\right] \Phi_i(\boldsymbol{r} ; \boldsymbol{R})\right\}\times\left[-i \hbar \nabla_\gamma\right] 
\end{aligned}\tag 8</script><h4 id="2-1-The-Adiabatic-BOA"><a href="#2-1-The-Adiabatic-BOA" class="headerlink" title="2.1 The Adiabatic BOA"></a>2.1 The Adiabatic BOA</h4><p>Only remain diagonal terms （diagonal correction）:</p>
<script type="math/tex; mode=display">
\mathcal{F}_{j j}(\boldsymbol{R})=\int d \boldsymbol{r} \Phi_j^*(\boldsymbol{r} ; \boldsymbol{R})\left[-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2\right] \Phi_j(\boldsymbol{r} ; \boldsymbol{R})\tag 9</script><p>As in 1.1,let all Fji(R) = 0,insert (10) into (7):</p>
<script type="math/tex; mode=display">
\Omega_j(\boldsymbol{R}, t)=A_j(\boldsymbol{R}, t) \exp \left[\frac{i}{\hbar} S_j(\boldsymbol{R}, t)\right] .\tag {10}</script><script type="math/tex; mode=display">
\frac{\partial S_j(R, t)}{\partial t}=-\frac{1}{2} \sum M_\gamma^{-1}\left(\nabla_\gamma S_j(R, t)\right)^2-E_j^{e l}(\boldsymbol{R}) \tag{11}</script><p>Using the relation </p>
<script type="math/tex; mode=display">
\left.\nabla_\gamma S_j\right|_{\mathbf{R}(t)}=\mathbf{P}_j^\gamma(t)</script><p>obtain a Newton-like equation of motion for the “classical” nuclei evolving in electronic state j :</p>
<script type="math/tex; mode=display">
M_\gamma \boldsymbol{R}_j^\gamma(t)=-\nabla_\gamma E_j^{e l}(\boldsymbol{R}(t))</script><p>In summary, the BO-MD equations:</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\hat{\mathcal{H}}_{e l}(r, R(t)) \Phi_j(r ; \boldsymbol{R}(t))=E_j^{e l}(\boldsymbol{R}(t)) \Phi_j(r ; R(t))\\
&\begin{aligned}
M_\gamma \ddot{R}_j^\gamma(t) &=-\nabla_\gamma E_j^{e l}(R(t)) \\
&=-\nabla_\gamma\underset{\min \Phi_j}{ }\left\langle\Phi_j\left|\hat{\mathcal{H}}_{el}(\boldsymbol{r}, \boldsymbol{R}(t))\right| \Phi_j\right\rangle,
\end{aligned}
\end{aligned}</script><p>Due to the assumption that  Fji =0, BO-MD always evolves on a single electronic PES( ground state).</p>
<h4 id="2-2-Trajectory-Based-Nonadiabatic-Dynamics"><a href="#2-2-Trajectory-Based-Nonadiabatic-Dynamics" class="headerlink" title="2.2. Trajectory-Based Nonadiabatic Dynamics"></a>2.2. Trajectory-Based Nonadiabatic Dynamics</h4><p>Rewrite (7) into :</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar \frac{\partial \Omega_j(R, t)}{\partial t}=&-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2 \Omega_j(R, t) \\
&+E_j^{e l}(R) \Omega_j(R, t) \\
&+\sum_{\gamma i} \frac{\hbar^2}{2 M_\gamma} D_{j i}^\gamma(R) \Omega_i(R, t) \\
&-\sum_{\gamma, i \neq j} \frac{\hbar^2}{M_\gamma} d_{j i}^\gamma(R) \cdot \nabla_\gamma \Omega_i(R, t)
\end{aligned}\tag {12}</script><p>where</p>
<script type="math/tex; mode=display">
d_{j i}^\gamma(R)=\int d r \Phi_j^*(r ; R) \nabla_\gamma \Phi_i(r ; R)</script><script type="math/tex; mode=display">
D_{j i}^\gamma(R)=-\int d r \Phi_j^*(r ; R) \nabla_\gamma^2 \Phi_i(r ; R)</script><h4 id="2-3-The-Nonadiabatic-Bohmian-Dynamics-NABDY-Equations"><a href="#2-3-The-Nonadiabatic-Bohmian-Dynamics-NABDY-Equations" class="headerlink" title="2.3 The Nonadiabatic Bohmian Dynamics (NABDY) Equations"></a>2.3 The Nonadiabatic Bohmian Dynamics (NABDY) Equations</h4><p>The polar representation (10) in Eq(12):</p>
<script type="math/tex; mode=display">
\begin{aligned}
-& \frac{\partial S_j(\boldsymbol{R}, t)}{\partial t}=\sum_\gamma \frac{1}{2 M_\gamma}\left(\nabla_\gamma S_j(\boldsymbol{R}, t)\right)^2+E_j^{e \prime}(\boldsymbol{R}) \\
&-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \frac{\nabla_\gamma^2 A_j(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \\
&+\sum_{\gamma i} \frac{\hbar^2}{2 M_\gamma} D_{j i}^\gamma(\boldsymbol{R}) \frac{A_i(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \Re\left[e^{i \phi_{i j}(R, t)}\right] \\
&-\sum_{\gamma, i \neq j} \frac{\hbar^2}{M_\gamma} \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \frac{\nabla_\gamma A_i(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \Re\left[e^{i \phi_{i j}(\boldsymbol{R}, t)}\right] \\
&+\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} \frac{A_j(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \nabla_\gamma S_i(\boldsymbol{R}, t) \\
& \times \Im\left[e^{i \phi_{i j}(\boldsymbol{R}, t)}\right]
\end{aligned}\tag{13}</script><p>and </p>
<script type="math/tex; mode=display">
\begin{aligned}
&\hbar \frac{\partial A_j(R, t)}{\partial t}=-\sum_\gamma \frac{\hbar}{M_\gamma} \nabla_\gamma A_j(R, t) \cdot \nabla_\gamma S_j(R, t) \\
&-\sum_\gamma \frac{\hbar}{2 M_\gamma} A_j(R, t) \nabla_\gamma^2 S_j(R, t) \\
&+\sum_{\gamma i} \frac{\hbar^2}{2 M_\gamma} D_{j i}^\gamma(R) A_i(R, t) \Im\left[e^{i \phi_{i j}(R, t)}\right] \\
&-\sum_{\gamma, i \neq j} \frac{\hbar^2}{M_\gamma} d_{j i}^\gamma(R) \cdot \nabla_\gamma A_i(R, t) \Im\left[e^{i \phi_{i j}(R, t)}\right] \\
&-\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} A_i(R, t) d_{j i}^\gamma(R) \cdot \nabla_\gamma S_i(R, t) \\
&\times \Re\left[e^{i \phi_{i j}(R, t)}\right]  \\
&
\end{aligned}\tag{14}</script><p>where </p>
<script type="math/tex; mode=display">
\phi_{ij}(\mathbf{R},t)= \frac{1}{\hbar}\left(S_i(\mathbf{R}, t)-S_j(\mathbf{R}, t)\right)</script><p>(13)(14) correspond to the exact S.Eq. for a nuclear-wave-func. evolving in the potential of the different elec-surfaces.            invlove fo-,so-, coupling elements from other PESs.</p>
<p>In (13), 1,2-terms: classical H-J eq for action S;      3-term: all quantum effects in a single elec-state and introduce nonlocality;    4,5,6-terms: non-adiabatic quantum potential, describle interstate contributions.     Use HJ definition </p>
<script type="math/tex; mode=display">
\left.\nabla_\beta S_j(\mathbf{R}, t)\right|_{\mathbf{R}(t)}=\mathbf{P}_j^\beta(t)</script><p>have </p>
<script type="math/tex; mode=display">
\begin{aligned}
M_\beta \frac{d^2 \boldsymbol{R}_\beta(t)}{\left(d t^j\right)^2}=&-\nabla_\beta\left[E_j^{e l}(\boldsymbol{R}(t))+\mathcal{Q}_j(\boldsymbol{R}(t), t)\right.\\
&\left.+\sum_i \mathcal{D}_{j i}(\boldsymbol{R}(t), t)\right]
\end{aligned}\tag{15}</script><h4 id="2-4-The-TSH-Dynamics"><a href="#2-4-The-TSH-Dynamics" class="headerlink" title="2.4 The TSH Dynamics"></a>2.4 The TSH Dynamics</h4><p>An approximation to the “in principle” exact NABDY formulation of the nuclear equations of motion.</p>
<p>From (13),(14):</p>
<script type="math/tex; mode=display">
\begin{aligned}
-& \frac{\partial S_j(\boldsymbol{R}, t)}{\partial t}=\sum_\gamma \frac{1}{2 M_\gamma}\left(\nabla_\gamma S_j(\boldsymbol{R}, t)\right)^2+E_j^{e l}(\boldsymbol{R}) \\
&+\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} \frac{A_i(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \nabla_\gamma S_i(\boldsymbol{R}, t) \\
& \times \Im\left[e^{i \phi_{i j}(R, t)}\right]
\end{aligned}\tag{16}</script><script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial A_j(\boldsymbol{R}, t)}{\partial t}=&-\sum_\gamma \frac{1}{M_\gamma} \nabla_\gamma A_j(\boldsymbol{R}, t) \cdot \nabla_\gamma S_j(\boldsymbol{R}, t) \\
&-\sum_\gamma \frac{1}{2 M_\gamma} A_j(\boldsymbol{R}, t) \nabla_\gamma^2 S_j(\boldsymbol{R}, t) \\
&-\sum_{\gamma, i \neq j} \frac{1}{M_\gamma} A_i(\boldsymbol{R}, t) \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \nabla_\gamma S_i(\boldsymbol{R}, t) \\
& \times \Re\left[e^{i \phi_{i j}(R, t)}\right] .
\end{aligned}\tag{17}</script><p>Consider this “classically”:the different trajectories (with different initial conditions) are assumed to be independent from each other. （ITA）</p>
<script type="math/tex; mode=display">
\left(A_j^{C L}(R(t), t)\right)^2=\frac{N_j(R(t), d V, t)}{N_t} \frac{1}{d V}</script><p>In TSH, the EOM of nuclear trajectories given by (16) , which independent with d：</p>
<script type="math/tex; mode=display">
\frac{d \boldsymbol{P}_j^\beta(t)}{d t^j}=-\nabla_\beta E_j^{e l}(\boldsymbol{R}(t))\tag{18}</script><p>If NACs are negligible, the trajectories evolve along the adiabatic PES.</p>
<p>If a region of strong coupling is encountered:</p>
<script type="math/tex; mode=display">
\begin{aligned}
-& \frac{\partial S_j^{Q M}(\boldsymbol{R}(t), t)}{\partial t}=E_j^{e l}(\boldsymbol{R}(t)) +\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} \frac{A_i^{Q M}(\boldsymbol{R}(t), t)}{A_j^{Q M}(\boldsymbol{R}(t), t)} \times \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}(t)) \cdot \dot{R}_\gamma(t) \Im\left[e^{i \phi_{i j}^{Q M}(R(t), t)}\right]
\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial A_j^{Q M}(R(t), t)}{\partial t}=-\sum_{\gamma, i \neq j} \frac{1}{M_\gamma} A_i^{Q M}(R(t), t)\times \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}(t)) \cdot \dot{R}_\gamma(t) \Re\left[e^{i \phi_{i j}^{Q M}(R(t), t)}\right]
\end{aligned}</script><p>i.e.</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar & \frac{\partial C_j(\boldsymbol{R}(t), t)}{\partial t}=C_j(\boldsymbol{R}(t), t) E_j^{\mathrm{el}}(\boldsymbol{R}(t)) -i \hbar \sum_i\left(\boldsymbol{d}_{j i}(\boldsymbol{R}(t)) \cdot \boldsymbol{R}(t) C_i(\boldsymbol{R}(t), t)\right)
\end{aligned}\tag{19}</script><p>with </p>
<script type="math/tex; mode=display">
C_j(\mathbf{R}(t), t)=A_j^{\mathrm{QM}}(\mathbf{R}(t), t) \exp \left[\frac{i}{\hbar} S_j^{\mathrm{QM}}(\mathbf{R}(t), t)\right]</script><p>In TSH , after enough sampling, internal consistency criterion:</p>
<script type="math/tex; mode=display">
\left(A_j^{C L}(R(t), t)\right)^2=\left(A_j^{Q M}(R(t), t)\right)^2</script><p>Tully gives:</p>
<script type="math/tex; mode=display">
\begin{aligned}
&p_{i \leftarrow j}^{[\alpha]}(t, t+\Delta t)= \\
&-2 \int_t^{t+\Delta t} d \tau \frac{\Re\left[C_i^{[\alpha]}(\tau) C_j^{[\alpha] *}(\tau) \boldsymbol{R}(\tau) \cdot \boldsymbol{d}_{i j}(\boldsymbol{R}(\tau))\right]}{C_j^{[\alpha]}(\tau) C_j^{[\alpha] *}(\tau)}
\end{aligned}\tag{20}</script><p>Reference：</p>
<p>D. Marx, J. Hutter, Ab Initio Molecular Dynamics: Basic Theory and Advanced Methods, Cambridge University Press, Cambridge, 20</p>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/22/mc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/22/mc/" class="post-title-link" itemprop="url">Monte Carlo in 2D Ising Model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-11-22 14:44:30" itemprop="dateCreated datePublished" datetime="2022-11-22T14:44:30+08:00">2022-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-24 17:50:37" itemprop="dateModified" datetime="2022-11-24T17:50:37+08:00">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework </font>

<ul>
<li>consider the 2D classical Ising model on a L×L square lattice with periodic boundary conditions in both directions</li>
</ul>
<script type="math/tex; mode=display">\mathscr{H}=-J \sum_{\langle i, j\rangle} \sigma_i \sigma_j+H \sum_i \sigma_i</script><ul>
<li><p>write a code for the Metropolis algorithm</p>
</li>
<li><p>plot the average energy, average magnetization, specific heat, and magnetic susceptibility as functions of temperature T</p>
</li>
<li><p>explore the scaling behavior near the critical point $T_c=\frac{2 \mathrm{~J}}{\ln (1+\sqrt{2})} \simeq 2.269 \mathrm{~J}$, compare with exact results</p>
</li>
<li><font size = 4.5> A brief summary of theory and algorithm </font>
</li>
<li><p>Monte Carlo simulation</p>
<p>  (1) initialization: choose an initial configuration for the spins</p>
<p>  (2) trial move: we propose a move by randomly choosing a spin and flip it</p>
<p>  (3) acceptation: for a flip 𝜎 old to 𝜎 trival , evaluate the number $\Delta E=2 \sigma_j\left(J \sum \sigma_{\text {near }}-H\right)$, then we generate a uniform random number r ∈ (0,1), if r &lt; 𝛼, accept the move, 𝜎 new = 𝜎 old</p>
<p>  (4) iteration: then we use 𝜎 new as the new starting point and go back to (2)</p>
<p>  we proceed with the process for at least 10^5 - 10^6 Monte Carlo steps</p>
</li>
<li><p>2D Ising Model:</p>
<p>  系统哈密顿量：$\mathscr{H}=-J \sum_{\langle i, j\rangle} \sigma_i \sigma_j+H \sum_i \sigma_i$</p>
<p>  通常忽略外场作用，$H = 0$, 系统能量 $<E> =-J \sum_{N} \sum_{\langle i, j\rangle} \sigma_i \sigma_j$</p>
<p>  平均能量：$<e> = <E> / N$</p>
<p>  磁化强度： $<M> = \sum_{i} s_{i}$</p>
<p>  热容： $C=\frac{1}{N T^2}\left(\left\langle E^2\right\rangle-\langle E\rangle^2\right)$</p>
<p>  磁化率 ：$\chi=\frac{1}{N T}\left(\left\langle M^2\right\rangle-\langle M\rangle^2\right)=\frac{N}{T}\left(\left\langle m^2\right\rangle-\langle m\rangle^2\right)$</p>
</li>
</ul>
<ul>
<li><p>关于计算参数：</p>
<ul>
<li><p>热化步数 Relaxation = 500， 迭代步数 Iteration = 200000（在本地跑大约13分钟）</p>
</li>
<li><p>温度范围：1 ~ 3.5 K，取点间隔为 0.05 K</p>
</li>
<li><p>大小分别取 L = 10,20,30， 周期性边界条件</p>
</li>
<li><p>de_corr = 3 是为了减少数据关联性，两次测量之间的等待步数</p>
<p>代码如下：</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">Tstart = <span class="number">0.85</span>                                           <span class="comment">#起始温度</span></span><br><span class="line">Tend = <span class="number">3.5</span>                                              <span class="comment">#终点温度</span></span><br><span class="line">Tstep = <span class="number">0.05</span>                                            <span class="comment">#步长</span></span><br><span class="line"></span><br><span class="line">J = <span class="number">1</span>                                                   <span class="comment">#Ising model 参数</span></span><br><span class="line">H = <span class="number">0</span></span><br><span class="line">Tc = <span class="number">2</span>*J / np.log(<span class="number">1</span>+np.sqrt(<span class="number">2</span>))                         <span class="comment"># Tc = 2.269J    </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_state</span>(<span class="params">L</span>):                                    <span class="comment">#返回一个 L*L 的随机spin构型</span></span><br><span class="line">    M = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, (L, L)) * <span class="number">2</span> - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_choose</span>(<span class="params">L</span>):                                   <span class="comment">#在 L*L Lattice 中随机选一个点</span></span><br><span class="line">    x = np.random.randint(L)</span><br><span class="line">    y = np.random.randint(L)</span><br><span class="line">    <span class="keyword">return</span> x,y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nn</span>(<span class="params">x,y,L</span>):                                          <span class="comment"># 返回 (x,y) 最近邻的四个点</span></span><br><span class="line">    <span class="keyword">return</span> (((x-<span class="number">1</span>)%L,y) , (x,(y+<span class="number">1</span>)%L) , ((x+<span class="number">1</span>)%L,y) , (x,(y-<span class="number">1</span>)%L))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">single_point_E</span>(<span class="params">x,y,<span class="built_in">map</span>,s,N</span>):                        <span class="comment"># 返回 (x,y) 点 s 自旋构型的最近邻能量</span></span><br><span class="line">    tmp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (xx,yy) <span class="keyword">in</span> nn(x,y,N):</span><br><span class="line">        tmp += <span class="built_in">map</span>[xx][yy]</span><br><span class="line">    <span class="keyword">return</span> s * (-J * tmp + H)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal_total_E</span>(<span class="params"><span class="built_in">map</span>,N</span>):                                 <span class="comment"># 返回 map 自旋构型的总能量</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">            <span class="built_in">sum</span> += single_point_E(i,j,<span class="built_in">map</span>,<span class="built_in">map</span>[i][j],N)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>/<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MC</span>(<span class="params">T,L,MainLoops,RelaxLoops,step,spin</span>):             <span class="comment"># Monte Carlo 主循环</span></span><br><span class="line">    S = L * L</span><br><span class="line">    Q_M = []</span><br><span class="line">    Q_M2 = []</span><br><span class="line">    Q_E = []</span><br><span class="line">    Q_E2 = []</span><br><span class="line">    Etotal = cal_total_E(spin,L)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(MainLoops+RelaxLoops):               <span class="comment">#循环包括 Relax 和 Sweep</span></span><br><span class="line"></span><br><span class="line">        x,y = random_choose(L)</span><br><span class="line">        s = spin[x][y]</span><br><span class="line">        curE = single_point_E(x,y,spin,s,L)</span><br><span class="line">        newE = single_point_E(x,y,spin,-s,L)</span><br><span class="line">        deltaE = newE - curE</span><br><span class="line">        alpha = np.exp(- deltaE / T)                    <span class="comment">#计算 alpha</span></span><br><span class="line">        <span class="keyword">if</span> deltaE &lt;= <span class="number">0</span>:                                 <span class="comment"># Metropolis 算法</span></span><br><span class="line">            spin[x][y] = -spin[x][y]</span><br><span class="line">            Etotal = Etotal + deltaE</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> np.random.random() &lt; alpha:</span><br><span class="line">                spin[x][y] = -spin[x][y]</span><br><span class="line">                Etotal = Etotal + deltaE</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (i &gt; RelaxLoops <span class="keyword">and</span> (i-RelaxLoops)%step == <span class="number">0</span>):       <span class="comment">#如果是 sweep 部分，且减少数据关联性</span></span><br><span class="line">        <span class="comment">#if (i &gt; RelaxLoops):</span></span><br><span class="line">            M = np.<span class="built_in">abs</span>(np.<span class="built_in">sum</span>(spin))</span><br><span class="line">            m = M / S</span><br><span class="line">            m2 = m * m</span><br><span class="line">            Q_M.append(m)</span><br><span class="line">            Q_M2.append(m2)</span><br><span class="line"></span><br><span class="line">            e = Etotal / S</span><br><span class="line">            e2 = e * e</span><br><span class="line">            Q_E.append(e)</span><br><span class="line">            Q_E2.append(e2)</span><br><span class="line"></span><br><span class="line">    M_avg = np.mean(Q_M)</span><br><span class="line">    E_avg = np.mean(Q_E)</span><br><span class="line">    C = (np.mean(Q_E2) - np.mean(Q_E) ** <span class="number">2</span>) / (T ** <span class="number">2</span>)</span><br><span class="line">    X = (np.mean(Q_M2) - np.mean(Q_M) ** <span class="number">2</span>) / T</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> spin,E_avg,M_avg,C * S,X * S                         <span class="comment">#返回 自选构型，平均能，平均磁化强度，热容，磁化率</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_results</span>(<span class="params">A</span>):                                            <span class="comment"># 画四个物理量的图</span></span><br><span class="line">    plt.figure(figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br><span class="line">    p1 = plt.subplot(<span class="number">221</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)  </span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;E&gt;&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">1</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">1</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">1</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    p1 = plt.subplot(<span class="number">222</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;M&gt;&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">2</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">2</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">2</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    p1 = plt.subplot(<span class="number">223</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">3</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">3</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">3</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    p1 = plt.subplot(<span class="number">224</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">4</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">4</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">4</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.show()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="type">List</span> = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>]</span><br><span class="line">    Iteration = <span class="number">200000</span></span><br><span class="line">    <span class="comment">#Iteration = 600000</span></span><br><span class="line">    Relaxation = <span class="number">500</span></span><br><span class="line">    de_corr = <span class="number">3</span></span><br><span class="line">    Ans = []</span><br><span class="line">    <span class="keyword">for</span> L <span class="keyword">in</span> <span class="type">List</span>:</span><br><span class="line">        TList = []</span><br><span class="line">        MList = []</span><br><span class="line">        EList = []</span><br><span class="line">        CList = []</span><br><span class="line">        XList = []</span><br><span class="line">        spin = random_state(L)</span><br><span class="line">        <span class="keyword">for</span> T <span class="keyword">in</span> np.arange(Tstart,Tend,Tstep):</span><br><span class="line">            TList.append(T)</span><br><span class="line">            spin,E,M,C,X = MC(T,L,Iteration,Relaxation,de_corr,spin)</span><br><span class="line">            EList.append(E)</span><br><span class="line">            MList.append(M)</span><br><span class="line">            CList.append(C)</span><br><span class="line">            XList.append(X)</span><br><span class="line">        Ans.append((TList[<span class="number">3</span>:],EList[<span class="number">3</span>:],MList[<span class="number">3</span>:],CList[<span class="number">3</span>:],XList[<span class="number">3</span>:]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;compelete : &quot;</span>+<span class="built_in">str</span>(<span class="built_in">round</span>(L/<span class="number">10</span>))+<span class="string">&quot;/3&quot;</span>)</span><br><span class="line">    draw_results(Ans)  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>compelete : 1/3
compelete : 2/3
compelete : 3/3
</code></pre><ul>
<li><p>关于临界指数：考虑 $M\sim|T-T_c|^{\beta}$ 和 $\chi \sim |T-T_c|^{-\gamma}$, 我们知道 Excat solution 是 </p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/22/DcelYIoZ4BvPQw8.png style="zoom:70%" />   
  </div>


</li>
</ul>
<pre><code>取对数坐标，分别绘图如下：
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">draw_exponent_M</span>(<span class="params">A,<span class="type">List</span></span>):                                      <span class="comment"># 画临界指数 : M~|T-Tc|^beta</span></span><br><span class="line">    </span><br><span class="line">    plt.figure(figsize = (<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;|T-Tc|*L&#x27;</span>)  </span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;M&gt;*L^1/8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> M <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">2</span>]:</span><br><span class="line">        Y.append(M * np.power(L,<span class="number">1</span>/<span class="number">8</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>, color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> M <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">2</span>]:</span><br><span class="line">        Y.append(M * np.power(L,<span class="number">1</span>/<span class="number">8</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> M <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">2</span>]:</span><br><span class="line">        Y.append(M * np.power(L,<span class="number">1</span>/<span class="number">8</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    plt.show()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_exponent_chi</span>(<span class="params">A,<span class="type">List</span></span>):                                      <span class="comment"># 画临界指数 X ~ |T-Tc|^(-gamma)</span></span><br><span class="line">    </span><br><span class="line">    plt.figure(figsize = (<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;|T-Tc|*L&#x27;</span>)  </span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;X&gt;*L^(-7/4)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> Chi <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">3</span>]:</span><br><span class="line">        Y.append(Chi * np.power(L,-<span class="number">7</span>/<span class="number">4</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>, color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> Chi <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">3</span>]:</span><br><span class="line">        Y.append(Chi * np.power(L,-<span class="number">7</span>/<span class="number">4</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> Chi <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">3</span>]:</span><br><span class="line">        Y.append(Chi * np.power(L,-<span class="number">7</span>/<span class="number">4</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">draw_exponent_M(Ans,<span class="type">List</span>) </span><br><span class="line"></span><br><span class="line">draw_exponent_chi(Ans,<span class="type">List</span>) </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>​    </p>
<ul>
<li><p>平均能、磁化强度、磁化率和热容对应的比较好，可以确定 Tc 的范围，但受限于算法的复杂度，要想提高精度则需要更长的 Iteration，意味着更长的耗时。</p>
</li>
<li><p>这里我在本地运行 Iteration = 600000(6*10^5)结果截图如下(大约半小时)：</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/24/at3PQCLDpwBOTZM.png style="zoom:60%" />   
  </div>

  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/24/dm5AFZ86Vj12JnW.png style="zoom:50%" />   
  </div>

  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/24/PSXUBoYHsJ5WdFx.png style="zoom:50%" />   
  </div>
</li>
<li><p>和 1/8 (-7/4) 的精确解斜率符合得较好</p>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/22/HW_itebd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/22/HW_itebd/" class="post-title-link" itemprop="url">3-site iTEBD method</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-11-22 14:32:30 / 修改时间：14:32:35" itemprop="dateCreated datePublished" datetime="2022-11-22T14:32:30+08:00">2022-11-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework</font>

<ul>
<li>consider the 1D spin model with open boundary condition</li>
</ul>
<script type="math/tex; mode=display">
H=-\sum_j\left(\sigma_{j-1}^z \sigma_j^y \sigma_{j+1}^z+\sigma_j^x\right)</script><ul>
<li><p>write a code for the 3-site iTEBD method</p>
<p>  choose $D_{s} =  6 $, calculate the ground state energy $E$ per site, and the magnetization per site $\left\langle\sigma_i^z\right\rangle$ and $\left\langle\sigma_i^x\right\rangle$</p>
<p>  show the data of entanglement entropy and entanglement spectrum</p>
</li>
</ul>
<font size=3.5> A brief summary of theory and algorithm </font>

<ul>
<li><p>对于 3-site 的 iTEBD，有三种 T 和 G，如下图所示；不同颜色的方框表示不同的TG的演化合并的过程，如此迭代</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/22/9hA6bVFf14rXKks.png style="zoom:50%" />   
  </div>
</li>
<li><p>update 的过程包含两次 SVD 分解，第二次注意要把 Gm1 作为环境乘进去：</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/22/CO4zIKdUijMYmEP.png style="zoom:60%" />   
  </div>
</li>
<li><p>代码如下：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3-site iTEBD method</span></span><br><span class="line"><span class="string">1D spin model with OBC</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> numpy.linalg <span class="keyword">as</span> LA</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LAs</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line"><span class="keyword">import</span> Sub180221 <span class="keyword">as</span> Sub</span><br><span class="line"><span class="keyword">import</span> math,copy,pickle</span><br><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> pl</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetHam_3sitespin</span>(<span class="params">Dp</span>):													<span class="comment">#生成哈密顿量</span></span><br><span class="line">	S0,Sp,Sm,Sz,Sx,Sy = Sub.SpinOper(Dp)</span><br><span class="line">	sz = <span class="number">2</span>* Sz</span><br><span class="line">	sx = <span class="number">2</span>* Sx</span><br><span class="line">	sy = <span class="number">2</span>* Sy</span><br><span class="line">	Ham = - (np.kron(np.kron(sz,sy),sz)) - (np.kron(np.kron(S0,sx),S0))</span><br><span class="line">	Ham = np.reshape(Ham,[Dp,Dp,Dp,Dp,Dp,Dp])</span><br><span class="line">	<span class="keyword">return</span> Ham</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetExpHam</span>(<span class="params">Ham,Tau</span>):														<span class="comment">#乘演化的 exp</span></span><br><span class="line">	Dp = np.shape(Ham)[<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> LA.norm(Ham) &lt; <span class="number">1.0e-12</span>:</span><br><span class="line">		UH = np.reshape(np.eye(Dp**<span class="number">3</span>),[Dp,Dp,Dp,Dp,Dp,Dp])</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		A = np.reshape(Ham,[Dp**<span class="number">3</span>,Dp**<span class="number">3</span>])</span><br><span class="line">		V,S,Dc = Sub.SplitEigh(A,Dp**<span class="number">3</span>)</span><br><span class="line">		</span><br><span class="line">		W = np.diag(np.exp(-Tau*S))</span><br><span class="line">		A = np.dot(np.dot(V,W),np.transpose(np.conj(V)))</span><br><span class="line">		UH = np.reshape(A,[Dp,Dp,Dp,Dp,Dp,Dp])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> UH</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitTG</span>(<span class="params">Dp,Ds,kind</span>):														</span><br><span class="line">	T = [<span class="literal">None</span>]*<span class="number">3</span></span><br><span class="line">	G = [<span class="literal">None</span>]*<span class="number">3</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> kind == <span class="string">&#x27;rand&#x27;</span>:</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">			T[i] = np.random.rand(Ds,Dp,Ds)</span><br><span class="line">			G[i] = np.random.rand(Ds)</span><br><span class="line">	<span class="keyword">return</span> T,G</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ImportTG</span>(<span class="params">Ds,Label</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		File_TG = <span class="built_in">open</span>(<span class="string">&#x27;Tebd&#x27;</span>+Label+<span class="string">&#x27;.pklz&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">		TG = pickle.load(File_TG)</span><br><span class="line">		File_TG.close()</span><br><span class="line">		(T,G) = (TG[<span class="string">&#x27;T&#x27;</span>],TG[<span class="string">&#x27;G&#x27;</span>])</span><br><span class="line">	<span class="keyword">except</span> IOError:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;Missing&#x27;</span>) </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> T,G</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ExportTG</span>(<span class="params">Ds,T,G,Label</span>):</span><br><span class="line">	TG = &#123;<span class="string">&#x27;T&#x27;</span>:T,<span class="string">&#x27;G&#x27;</span>:G&#125;</span><br><span class="line">	File_TG = <span class="built_in">open</span>(<span class="string">&#x27;Tebd&#x27;</span>+Label+<span class="string">&#x27;.pklz&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">	pickle.dump(TG,File_TG)</span><br><span class="line">	File_TG.close()</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mySVD</span>(<span class="params">A,Dcut</span>):</span><br><span class="line">	U,S,V = LA.svd(A)</span><br><span class="line">	U = U[:,:Dcut]</span><br><span class="line">	S = S[:Dcut]</span><br><span class="line">	V = V[:Dcut,:]</span><br><span class="line">	<span class="keyword">return</span> U,S,V</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Evo_Bond</span>(<span class="params">Tl,Tm,Tr,Gll,Gl,Gr,Grr,Ds,UH</span>):									<span class="comment">#update 过程，做两次 SVD</span></span><br><span class="line">	A = Sub.NCon([np.diag(Gll),Tl,np.diag(Gl),Tm,np.diag(Gr),Tr,np.diag(Grr),UH],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">7</span>,<span class="number">2</span>],[<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>],[<span class="number">4</span>,<span class="number">5</span>],[<span class="number">5</span>,<span class="number">9</span>,<span class="number">6</span>],[<span class="number">6</span>,-<span class="number">5</span>],[-<span class="number">2</span>,-<span class="number">3</span>,-<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</span><br><span class="line">	DA = np.shape(A)</span><br><span class="line">	A = Sub.Group(A,[[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]])										<span class="comment">#重整成一个矩阵</span></span><br><span class="line"></span><br><span class="line">	U1,Gm1,V1,Dc1 = Sub.SplitSvd_Lapack(A,Ds,<span class="number">0</span>,prec=<span class="number">1.0e-12</span>)</span><br><span class="line">	Gm1 /= np.sqrt(np.<span class="built_in">sum</span>(Gm1**<span class="number">2</span>))</span><br><span class="line">	U1 = np.reshape(U1,[DA[<span class="number">0</span>],DA[<span class="number">1</span>],Dc1])</span><br><span class="line">	Tl = np.tensordot(np.diag(<span class="number">1.0</span>/Gll),U1,(<span class="number">1</span>,<span class="number">0</span>))							<span class="comment">#将 Gll 还原出去</span></span><br><span class="line">	V1 = np.tensordot(np.diag(Gm1),V1,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">	V1 = np.reshape(V1,[<span class="number">12</span>,<span class="number">12</span>])												<span class="comment">#重整成一个矩阵		</span></span><br><span class="line"></span><br><span class="line">	U2,Gm2,V2,Dc2 = Sub.SplitSvd_Lapack(V1,Ds,<span class="number">0</span>,prec=<span class="number">1.0e-12</span>)</span><br><span class="line">	Gm2 /= np.sqrt(np.<span class="built_in">sum</span>(Gm2**<span class="number">2</span>))	</span><br><span class="line">	V2 = np.reshape(V2,[Dc2,DA[<span class="number">3</span>],DA[<span class="number">4</span>]])</span><br><span class="line">	Tr = np.tensordot(V2,np.diag(<span class="number">1.0</span>/Grr),(<span class="number">2</span>,<span class="number">0</span>))							<span class="comment">#将 Grr 还原出去</span></span><br><span class="line">	Tm = np.reshape(U2,[DA[<span class="number">0</span>],DA[<span class="number">1</span>],Dc1])</span><br><span class="line">	Tm = np.tensordot(np.diag(<span class="number">1.0</span>/Gm1),Tm,(<span class="number">1</span>,<span class="number">0</span>))							<span class="comment">#将 Gl 还原出去</span></span><br><span class="line">	<span class="keyword">return</span> Tl,Tm,Tr,Gm1,Gm2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Evo</span>(<span class="params">Ds,Ham,Tau,Iter,Prec,Label</span>):										<span class="comment">#主循环</span></span><br><span class="line">	Dp = np.shape(Ham)[<span class="number">0</span>]</span><br><span class="line">	T,G = InitTG(Dp,Ds,<span class="string">&#x27;rand&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	File_Log = <span class="built_in">open</span>(<span class="string">&#x27;Log&#x27;</span>+Label+<span class="string">&#x27;.dat&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	r0 = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> idt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Tau)):</span><br><span class="line">		dt = Tau[idt]</span><br><span class="line">		UH = GetExpHam(Ham,dt)</span><br><span class="line">		</span><br><span class="line">		G0 = np.ones(<span class="number">3</span>)</span><br><span class="line">		<span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(Iter):</span><br><span class="line">			<span class="keyword">for</span> ib <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">				T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)] =\</span><br><span class="line">				Evo_Bond(T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],G[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],Ds,UH)</span><br><span class="line">			Err = <span class="number">0.0</span></span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">				Err += <span class="built_in">abs</span>(G[i][<span class="number">0</span>]-G0[i])</span><br><span class="line">			<span class="keyword">if</span> np.mod(r,<span class="number">100</span>) == <span class="number">1</span>:</span><br><span class="line">				<span class="comment">#print(r+r0,Err)</span></span><br><span class="line">				File_Log.write(<span class="string">&#x27;%d \t %0.15f \n&#x27;</span> % <span class="built_in">tuple</span>((r+r0,Err)))</span><br><span class="line">				File_Log.flush()</span><br><span class="line">			<span class="keyword">if</span> Err &lt; Prec[idt]:</span><br><span class="line">				r0 += r</span><br><span class="line">				<span class="built_in">print</span>(dt,r+r0,Err)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">				G0[i] = G[i][<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	File_Log.close()</span><br><span class="line">	ExportTG(Ds,T,G,Label)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cal_Bond</span>(<span class="params">Op,Tl,Tm,Tr,Gll,Gl,Gr,Grr</span>):									<span class="comment">#计算 &lt;psi|OP|psi&gt;				</span></span><br><span class="line">	A = Sub.NCon([np.diag(Gll),Tl,np.diag(Gl),Tm,np.diag(Gr),Tr,np.diag(Grr)],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">2</span>,<span class="number">2</span>],[<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,-<span class="number">3</span>,<span class="number">4</span>],[<span class="number">4</span>,<span class="number">5</span>],[<span class="number">5</span>,-<span class="number">4</span>,<span class="number">6</span>],[<span class="number">6</span>,-<span class="number">5</span>]])</span><br><span class="line">	Val = Sub.NCon([A,Op,np.conj(A)],[[<span class="number">7</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">8</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">7</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">8</span>]])</span><br><span class="line">	<span class="keyword">return</span> np.real(Val)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cal_Site</span>(<span class="params">Op,T,Gl,Gr</span>):													<span class="comment"># 计算单个 site 的 &lt;site|OP|site&gt;</span></span><br><span class="line">	A = Sub.NCon([np.diag(Gl),T,np.diag(Gr)],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">2</span>,<span class="number">2</span>],[<span class="number">2</span>,-<span class="number">3</span>]])</span><br><span class="line">	Val = Sub.NCon([A,Op,np.conj(A)],[[<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>],[<span class="number">2</span>,<span class="number">1</span>],[<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>]])</span><br><span class="line">	<span class="keyword">return</span> np.real(Val)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cal</span>(<span class="params">Ds,Ham,Label</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;***************************************************************************************&quot;</span>)</span><br><span class="line">	T,G = ImportTG(Ds,Label)</span><br><span class="line">	</span><br><span class="line">	D = np.shape(Ham)[<span class="number">0</span>]</span><br><span class="line">	H00 = np.reshape(np.eye(D**<span class="number">3</span>,D**<span class="number">3</span>),[D,D,D,D,D,D])</span><br><span class="line">	S0,Sp,Sm,Sz,Sx,Sy = Sub.SpinOper(D)</span><br><span class="line">	sz = <span class="number">2</span>* Sz</span><br><span class="line">	sx = <span class="number">2</span>* Sx</span><br><span class="line"></span><br><span class="line">	Nom = np.zeros(<span class="number">3</span>)</span><br><span class="line">	Eng = np.zeros(<span class="number">3</span>)</span><br><span class="line">	Mz = np.zeros(<span class="number">3</span>)</span><br><span class="line">	Mx = np.zeros(<span class="number">3</span>)</span><br><span class="line">	EE = []</span><br><span class="line">	ES = []</span><br><span class="line">	avgES = []</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;ib &quot;</span>+<span class="string">&quot; Nom &quot;</span>+<span class="string">&quot; Eng &quot;</span>+<span class="string">&quot; Mag z &quot;</span>+<span class="string">&quot; Mag x &quot;</span>+<span class="string">&quot; entanglement entropy &quot;</span>+<span class="string">&quot; entanglement spectrum &quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> ib <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">		Nom[ib] = Cal_Bond(H00,T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],G[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)])</span><br><span class="line">		Eng[ib] = Cal_Bond(Ham,T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],G[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)])</span><br><span class="line">		Mz[ib] = Cal_Site(sz,T[ib],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib])</span><br><span class="line">		Mx[ib] = Cal_Site(sx,T[ib],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib])</span><br><span class="line">		Eng[ib] /= Nom[ib]</span><br><span class="line">		Mz[ib] /= Nom[ib]</span><br><span class="line">		Mx[ib] /= Nom[ib]</span><br><span class="line"></span><br><span class="line">		ES.append(G[ib])</span><br><span class="line">		ln_EV = np.matrix(np.log2(ES[ib]))</span><br><span class="line">		EV = np.matrix(ES[ib])</span><br><span class="line">		EE.append(-np.dot(EV, ln_EV.H))</span><br><span class="line"></span><br><span class="line">		<span class="built_in">print</span>(ib,np.around(Nom[ib],<span class="number">6</span>),np.around(Eng[ib],<span class="number">6</span>),np.around(Mz[ib],<span class="number">7</span>),np.around(Mx[ib],<span class="number">7</span>),EE[ib],ES[ib])</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;***************************************************************************************&quot;</span>)</span><br><span class="line"></span><br><span class="line">	Eng = np.mean(Eng)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;ground E per site:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(Eng)</span><br><span class="line">	</span><br><span class="line">	Mz = np.mean(Mz)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;magnetization z per site:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(Mz)</span><br><span class="line">	Mx = np.mean(Mx)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;magnetization x per site:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(Mx)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;entanglement entropy and entanglement spectrum:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(np.mean(EE))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">		avgES.append((ES[<span class="number">0</span>][i]+ES[<span class="number">1</span>][i]+ES[<span class="number">2</span>][i])/<span class="number">3</span>)</span><br><span class="line">	<span class="built_in">print</span>(avgES)</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Plot</span>(<span class="params">Ds</span>):</span><br><span class="line">	Label = <span class="string">&#x27;-D&#x27;</span>+<span class="built_in">str</span>(Ds)</span><br><span class="line">	Err = np.loadtxt(<span class="string">&#x27;Log&#x27;</span>+Label+<span class="string">&#x27;.dat&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	fig = pl.figure()</span><br><span class="line">	pl.plot(Err[:,<span class="number">0</span>],np.log(np.<span class="built_in">abs</span>(Err[:,<span class="number">1</span>]))/np.log(<span class="number">10</span>))</span><br><span class="line">	pl.xlabel(<span class="string">&#x27;Iteration&#x27;</span>)</span><br><span class="line">	pl.ylabel(<span class="string">&#x27;Error&#x27;</span>)</span><br><span class="line">	fig.savefig(<span class="string">&#x27;Err&#x27;</span>+Label+<span class="string">&#x27;.pdf&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	Ds = <span class="number">6</span></span><br><span class="line">	Dp = <span class="number">2</span></span><br><span class="line">	</span><br><span class="line">	Tau = [<span class="number">0.1</span>,<span class="number">0.01</span>,<span class="number">0.001</span>]</span><br><span class="line">	Iter = <span class="number">100000</span></span><br><span class="line">	Prec = [<span class="number">1.0e-10</span>]*<span class="number">3</span></span><br><span class="line">	Label = <span class="string">&#x27;-D&#x27;</span>+<span class="built_in">str</span>(Ds)</span><br><span class="line">	</span><br><span class="line">	Ham = GetHam_3sitespin(Dp)</span><br><span class="line">	Evo(Ds,Ham,Tau,Iter,Prec,Label)</span><br><span class="line">	Plot(Ds)</span><br><span class="line">	Cal(Ds,Ham,Label)</span><br></pre></td></tr></table></figure>
<pre><code>0.1 5894 9.963463387663296e-11
0.01 29097 9.996781180632297e-11
0.001 102908 9.999789885029031e-11
***************************************************************************************
ib  Nom  Eng  Mag z  Mag x  entanglement entropy  entanglement spectrum 
0 1.0 -1.196414 -0.1612558 0.6107703 [[1.68910627]] [0.88586489 0.42204271 0.16637421 0.08864772 0.03659217 0.0156705 ]
1 1.0 -1.197 -0.1616391 0.6101772 [[1.68961957]] [0.88582456 0.42207902 0.16644626 0.08872146 0.03663422 0.01569149]
2 1.0 -1.197545 0.1614238 0.6104471 [[1.6896294]] [0.88582307 0.42208483 0.16643798 0.0887227  0.0366377  0.01569247]
***************************************************************************************
ground E per site:
-1.196986423260931
magnetization z per site:
-0.05382368800930137
magnetization x per site:
0.6104648847112727
entanglement entropy and entanglement spectrum:
1.6894517483722928
[0.8858375061701803, 0.42206885253163623, 0.1664194864064454, 0.08869729347868575, 0.03662135992053934, 0.01568481868848111]
</code></pre><div  align="center">    
<img src=https://s2.loli.net/2022/11/22/gIfsPoDp6CQYAmw.png style="zoom:50%" />   
</div>

<p>​    </p>
<ul>
<li><p>小结：</p>
<ul>
<li><p>基态能量约为 -1.197， 和上次的 ED / MPS 结果基本相符合（考虑到iTEBD是N无限大的OBC）。</p>
</li>
<li><p>sigmaz 磁化强度约为 0 ，sigmax 磁化强度约为 0.61</p>
</li>
<li><p>纠缠熵(log2)约为 1.689，纠缠谱数据如下：</p>
<p>  [0.8858375061701803, 0.42206885253163623, 0.1664194864064454, 0.08869729347868575, 0.03662135992053934, 0.01568481868848111]</p>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/13/HW_MPS1107/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/HW_MPS1107/" class="post-title-link" itemprop="url">2-site variational MPS method in 1D spin model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-11-13 15:44:30 / 修改时间：15:57:08" itemprop="dateCreated datePublished" datetime="2022-11-13T15:44:30+08:00">2022-11-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework </font>

<ul>
<li>read and understand the sample code 1-site variational MPS method</li>
<li>consider the 1D spin model with open boundary condition</li>
</ul>
<script type="math/tex; mode=display">
H=-\sum_j\left(\sigma_{j-1}^z \sigma_j^y \sigma_{j+1}^z+\sigma_j^x\right)</script><ul>
<li><p>write a code for the 2-site variational MPS method</p>
<p>  choose $N = 10$ , $D_{s} = 4 , 6 $, calculate the ground state energy $E$ per site, and the magnetization per site $\left\langle\sigma_i^z\right\rangle$ and $\left\langle\sigma_i^x\right\rangle$</p>
<p>  compare with the results obtained from exact diagonalization</p>
</li>
<li><font size = 4> a brief summary of theory and algorithm </font>

<p>  sample code 主要步骤如下：</p>
<ol>
<li><p>write Hamiltonian as an MPO</p>
</li>
<li><p>tensor initialization</p>
</li>
<li><p>environment initialization</p>
</li>
<li><p>sweep back and forth to optimize each tensor</p>
<p>对于给定的 1 D spin model，注意到其包括两部分：相邻三体和单体。（除去端点处）有平移对称性，MPO 如下:</p>
<script type="math/tex; mode=display">
\left(\begin{array}{cccc}
I & -\sigma^{z} & 0 & -\sigma^{x} \\
0 & 0 & \sigma^{y} & 0 \\
0 & 0 & 0 & \sigma^{z} \\
0 & 0 & 0 & I
\end{array}\right)</script><p>端点处（site0 和 site9）的 MPO ：</p>
<script type="math/tex; mode=display">
\left(\begin{array}{cccc}
I & 0 & 0 & -\sigma^{x} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & I
\end{array}\right)</script><p>下面的 code 中近似地忽略端点处的 MPO，这一点与后面的 Exact solution 对比可以发现这种近似的精度是合理的。 </p>
<p>张量和环境的初始化和 1-site 的类似，这里主要讨论 2-site 的 sweep 如何实现。</p>
<div  align="center">    
<img src=https://s2.loli.net/2022/11/13/F3gIuawYMWZERi9.png style="zoom:70%" />   
</div>



</li>
</ol>
</li>
</ul>
<p>optimize two sites : 一次将两个相邻的 T 相乘，作 SVD 分解。对于向右 sweep 的过程，将分解得到的 U 作为新的 T[i] ，得到的 S 和 V 相乘作为新的 T[i+1] ，如此继续循环；对于向左的 sweep 过程同理。 其中要注意的是分解的 U，S，V 需要根据原来的 T[i] 和 T[i+1] 之间耦合的维度 Dcut 做截断。</p>
<p>code 中 NCon 的 index 对应如下：</p>
<div  align="center">    
<img src=https://s2.loli.net/2022/11/13/YagrZSJl45khiX2.jpg style="zoom:30%" />   
</div>    


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> numpy.linalg <span class="keyword">as</span> LA</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LAs</span><br><span class="line"><span class="keyword">import</span> Sub180221 <span class="keyword">as</span> Sub</span><br><span class="line"><span class="keyword">import</span> math,copy</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Mi =</span></span><br><span class="line"><span class="string">s0	-sz	0	-sx</span></span><br><span class="line"><span class="string">0	0	sy	0</span></span><br><span class="line"><span class="string">0	0	0	sz</span></span><br><span class="line"><span class="string">0	0	0	s0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetMpo_Heisenberg_Obc</span>(<span class="params">Dp</span>):									<span class="comment">#生成 MPO</span></span><br><span class="line">	S0,Sp,Sm,Sz,Sx,Sy = Sub.SpinOper(Dp)</span><br><span class="line">	</span><br><span class="line">	Dmpo = <span class="number">4</span></span><br><span class="line">	Mpo = np.zeros((Dmpo,Dp,Dmpo,Dp),dtype = <span class="built_in">complex</span>)</span><br><span class="line">	</span><br><span class="line">	Mpo[<span class="number">0</span>,:,<span class="number">0</span>,:] = S0</span><br><span class="line">	Mpo[<span class="number">0</span>,:,<span class="number">1</span>,:] = -<span class="number">2</span> * Sz</span><br><span class="line">	Mpo[<span class="number">0</span>,:,<span class="number">3</span>,:] = -<span class="number">2</span> * Sx</span><br><span class="line">	Mpo[<span class="number">1</span>,:,<span class="number">2</span>,:] = <span class="number">2</span> * Sy</span><br><span class="line">	Mpo[<span class="number">2</span>,:,<span class="number">3</span>,:] = <span class="number">2</span> * Sz</span><br><span class="line">	Mpo[<span class="number">3</span>,:,<span class="number">3</span>,:] = S0</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Mpo</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitMps</span>(<span class="params">Ns,Dp,Ds</span>):											<span class="comment">#初始化 MPS</span></span><br><span class="line">	T = [<span class="literal">None</span>]*Ns</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns):</span><br><span class="line">		Dl = <span class="built_in">min</span>(Dp**i,Dp**(Ns-i),Ds)</span><br><span class="line">		Dr = <span class="built_in">min</span>(Dp**(i+<span class="number">1</span>),Dp**(Ns-<span class="number">1</span>-i),Ds)</span><br><span class="line">		T[i] = np.random.rand(Dl,Dp,Dr)</span><br><span class="line">	U = np.eye(np.shape(T[-<span class="number">1</span>])[-<span class="number">1</span>])</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">		U,T[i] = Sub.Mps_LQP(T[i],U)</span><br><span class="line">	<span class="keyword">return</span> T</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitH</span>(<span class="params">Mpo,T</span>):												<span class="comment">#初始化环境 HL HR</span></span><br><span class="line">	Ns = <span class="built_in">len</span>(T)</span><br><span class="line">	Dmpo = np.shape(Mpo)[<span class="number">0</span>]</span><br><span class="line">	HL = [<span class="literal">None</span>]*Ns</span><br><span class="line">	HR = [<span class="literal">None</span>]*Ns</span><br><span class="line">	HL[<span class="number">0</span>] = np.zeros((<span class="number">1</span>,Dmpo,<span class="number">1</span>))</span><br><span class="line">	HL[<span class="number">0</span>][<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>] = <span class="number">1.0</span></span><br><span class="line">	HR[-<span class="number">1</span>] = np.zeros((<span class="number">1</span>,Dmpo,<span class="number">1</span>))</span><br><span class="line">	HR[-<span class="number">1</span>][<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>] = <span class="number">1.0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">		HR[i-<span class="number">1</span>] = Sub.NCon([HR[i],T[i],Mpo,np.conj(T[i])],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],[-<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>],[-<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[-<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">	<span class="keyword">return</span> HL,HR</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OptTSite</span>(<span class="params">Mpo,HL,HR,T,Method=<span class="number">0</span></span>):								<span class="comment">#2-site的 OptTSite，这里的 T 其实是相邻两个 site 的 T 的积</span></span><br><span class="line">	DT = np.shape(T)</span><br><span class="line">	<span class="keyword">if</span> Method == <span class="number">0</span>:</span><br><span class="line">		A = Sub.NCon([HL,Mpo,Mpo,HR],[[-<span class="number">1</span>,<span class="number">1</span>,-<span class="number">5</span>],[<span class="number">1</span>,-<span class="number">6</span>,<span class="number">2</span>,-<span class="number">2</span>],[<span class="number">2</span>,-<span class="number">7</span>,<span class="number">3</span>,-<span class="number">3</span>],[-<span class="number">8</span>,<span class="number">3</span>,-<span class="number">4</span>]])</span><br><span class="line">		A = Sub.Group(A,[[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]])</span><br><span class="line">		Eig,V = LAs.eigsh(A,k=<span class="number">1</span>,which=<span class="string">&#x27;SA&#x27;</span>)</span><br><span class="line">		T = np.reshape(V,(DT[<span class="number">0</span>]*DT[<span class="number">1</span>],DT[<span class="number">2</span>]*DT[<span class="number">3</span>]))        		<span class="comment">#V reshape 成四阶张量 T</span></span><br><span class="line">	<span class="keyword">return</span> T,Eig</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OptT</span>(<span class="params">Mpo,HL,HR,T</span>):</span><br><span class="line">	Ns = <span class="built_in">len</span>(T)</span><br><span class="line">	Eng0 = np.zeros(Ns)</span><br><span class="line">	Eng1 = np.zeros(Ns)</span><br><span class="line">	<span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">		<span class="built_in">print</span>(r)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>):									<span class="comment"># 向右 sweep</span></span><br><span class="line">			temp,Eng1[i] = OptTSite(Mpo,HL[i],HR[i+<span class="number">1</span>],np.tensordot(T[i],T[i+<span class="number">1</span>],(<span class="number">2</span>,<span class="number">0</span>)),Method=<span class="number">0</span>)	<span class="comment">#T[i]*T[i+1]作为新的张量传过去</span></span><br><span class="line">			Dcut = np.shape(T[i])[<span class="number">2</span>]								<span class="comment"># Dcut 是截断维数</span></span><br><span class="line">			U,S,V = LA.svd(temp,full_matrices=<span class="number">0</span>)</span><br><span class="line">			U = U[:,<span class="number">0</span>:Dcut]</span><br><span class="line">			S = S[<span class="number">0</span>:Dcut]</span><br><span class="line">			V = V[<span class="number">0</span>:Dcut,:]</span><br><span class="line">			T[i] = np.reshape(U,np.shape(T[i]))					<span class="comment">#更新 T[i],T[i+1],HL[i+1]</span></span><br><span class="line">			SV = np.dot(np.diag(S),V)</span><br><span class="line">			T[i+<span class="number">1</span>] = np.reshape(SV,np.shape(T[i+<span class="number">1</span>]))</span><br><span class="line">			HL[i+<span class="number">1</span>] = Sub.NCon([HL[i],np.conj(T[i]),Mpo,T[i]],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],[<span class="number">1</span>,<span class="number">2</span>,-<span class="number">1</span>],[<span class="number">3</span>,<span class="number">4</span>,-<span class="number">2</span>,<span class="number">2</span>],[<span class="number">5</span>,<span class="number">4</span>,-<span class="number">3</span>]])</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):								<span class="comment"># 向左 sweep</span></span><br><span class="line">			temp,Eng1[i] = OptTSite(Mpo,HL[i-<span class="number">1</span>],HR[i],np.tensordot(T[i-<span class="number">1</span>],T[i],(<span class="number">2</span>,<span class="number">0</span>)),Method=<span class="number">0</span>)	<span class="comment">#T[i-1]*T[i]作为新的张量传过去</span></span><br><span class="line">			Dcut = np.shape(T[i])[<span class="number">0</span>]								<span class="comment"># Dcut 是截断维数</span></span><br><span class="line">			U,S,V = LA.svd(temp,full_matrices=<span class="number">0</span>)</span><br><span class="line">			U = U[:,<span class="number">0</span>:Dcut]</span><br><span class="line">			S = S[<span class="number">0</span>:Dcut]</span><br><span class="line">			V = V[<span class="number">0</span>:Dcut,:]</span><br><span class="line">			T[i] = np.reshape(V,np.shape(T[i]))					<span class="comment">#更新 T[i],T[i-1],HR[i-1]</span></span><br><span class="line">			US = np.dot(U,np.diag(S))</span><br><span class="line">			T[i-<span class="number">1</span>] = np.reshape(US,np.shape(T[i-<span class="number">1</span>]))</span><br><span class="line">			HR[i-<span class="number">1</span>] = Sub.NCon([HR[i],T[i],Mpo,np.conj(T[i])],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],[-<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>],[-<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[-<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(Eng1)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">abs</span>(Eng1[<span class="number">1</span>]-Eng0[<span class="number">1</span>]) &lt; <span class="number">1.0e-7</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		Eng0 = copy.copy(Eng1)</span><br><span class="line">	<span class="built_in">print</span>(Eng1/<span class="built_in">float</span>(Ns))</span><br><span class="line">	<span class="keyword">return</span> T,Eng1/<span class="built_in">float</span>(Ns)</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	Ns = <span class="number">10</span></span><br><span class="line">	Dp = <span class="number">2</span></span><br><span class="line">	Ds = [<span class="number">4</span>,<span class="number">6</span>]</span><br><span class="line">	Answer = []</span><br><span class="line"></span><br><span class="line">	Mpo = GetMpo_Heisenberg_Obc(Dp)</span><br><span class="line">	<span class="keyword">for</span> ds <span class="keyword">in</span> Ds:</span><br><span class="line">		T = InitMps(Ns,Dp,ds)</span><br><span class="line">		HL,HR = InitH(Mpo,T)</span><br><span class="line">		T,E= OptT(Mpo,HL,HR,T)</span><br><span class="line">		GS = T[<span class="number">0</span>]</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>):</span><br><span class="line">			GS = np.tensordot(GS,T[i+<span class="number">1</span>],(i+<span class="number">2</span>,<span class="number">0</span>))</span><br><span class="line">		GS = np.reshape(GS,(<span class="number">1024</span>,<span class="number">1</span>))</span><br><span class="line">		Answer.append((ds,E,GS))</span><br></pre></td></tr></table></figure>
<pre><code>0
[ -9.94119199 -11.48599436 -11.48599436 -11.48641231 -11.48638648
 -11.48628296 -11.4859645  -11.48480444 -11.4844155  -11.4844155 ]
1
[-11.48599436 -11.48597508 -11.48597508 -11.48639425 -11.48660135
 -11.48666644 -11.48660205 -11.48639534 -11.48597623 -11.48597623]
2
[-11.48597508 -11.48597502 -11.48597502 -11.4863942  -11.48660113
 -11.48666585 -11.48660113 -11.4863942  -11.48597503 -11.48597503]
[-1.14859751 -1.1485975  -1.1485975  -1.14863942 -1.14866011 -1.14866659
 -1.14866011 -1.14863942 -1.1485975  -1.1485975 ]
0
[-10.09613213 -11.48870684 -11.48870684 -11.48878776 -11.4888277
 -11.48872879 -11.48838718 -11.48821485 -11.48813509 -11.48813509]
1
[-11.48870684 -11.48870695 -11.48870695 -11.48878788 -11.48886592
 -11.48888725 -11.48886592 -11.48878788 -11.48870695 -11.48870695]
2
[-11.48870695 -11.48870695 -11.48870695 -11.48878788 -11.48886592
 -11.48888725 -11.48886592 -11.48878788 -11.48870695 -11.48870695]
[-1.14887069 -1.14887069 -1.14887069 -1.14887879 -1.14888659 -1.14888873
 -1.14888659 -1.14887879 -1.14887069 -1.14887069]
</code></pre><ul>
<li><p>这里的列表 Answer = [(ds,E,GS)] 分别储存的截断 Ds，基态能量 per site E，以及 groud state GS。 </p>
</li>
<li><p>下面计算 $D_{s} = 4 , 6 $ 情况下的 ： 1. ground state energy $E$ per site； 2. magnetization per site $\left\langle\sigma_i^z\right\rangle$ and $\left\langle\sigma_i^x\right\rangle$</p>
</li>
<li><p>先定义计算磁化强度的 mag_x 和 mag_z 函数：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">FlipBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> i^(<span class="number">1</span>&lt;&lt;n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReadBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (i&amp;(<span class="number">1</span>&lt;&lt;n))&gt;&gt;n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mag_z</span>(<span class="params">W</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;z:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns):</span><br><span class="line">        SzW = np.zeros(<span class="number">1024</span>,dtype = <span class="built_in">complex</span>)</span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        n = <span class="number">1</span>&lt;&lt;Ns</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            sign = <span class="number">1</span> <span class="keyword">if</span> ReadBit(state, i) == <span class="number">1</span> <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">            SzW[state] = sign * W[state]</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            res = res + np.conj(W)[state] * SzW[state]</span><br><span class="line">        <span class="built_in">print</span>(i,np.real(res))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mag_x</span>(<span class="params">W</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns):</span><br><span class="line">        SxW = np.zeros(<span class="number">1024</span>,dtype = <span class="built_in">complex</span>)</span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        n = <span class="number">1</span>&lt;&lt;Ns</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            SxW[FlipBit(state,i)] =  W[state]</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            res = res + np.conj(W)[state] * SxW[state]</span><br><span class="line">        <span class="built_in">print</span>(i,np.real(res))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>对于 Ds = 4：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ds=&quot;</span>+<span class="built_in">str</span>(Answer[<span class="number">0</span>][<span class="number">0</span>])+<span class="string">&quot;:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ground state energy E per site:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(Answer[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:&quot;</span>)</span><br><span class="line">mag_z(Answer[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">mag_x(Answer[<span class="number">0</span>][<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<pre><code>Ds=4:
ground state energy E per site:
[-1.14859751 -1.1485975  -1.1485975  -1.14863942 -1.14866011 -1.14866659
 -1.14866011 -1.14863942 -1.1485975  -1.1485975 ]
magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:
z:
0 [7.21557529e-09]
1 [-9.58418942e-09]
2 [-5.03324422e-09]
3 [2.40059455e-09]
4 [-1.82414969e-09]
5 [-2.32618917e-09]
6 [1.5960039e-09]
7 [-2.92614971e-09]
8 [-2.37970759e-09]
9 [1.22052863e-09]
x:
0 [0.9173015]
1 [0.84768239]
2 [0.78414904]
3 [0.7604599]
4 [0.75185056]
5 [0.75202071]
6 [0.76080662]
7 [0.78431687]
8 [0.84831043]
9 [0.91792175]
</code></pre><ul>
<li>对于 Ds = 6:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ds=&quot;</span>+<span class="built_in">str</span>(Answer[<span class="number">1</span>][<span class="number">0</span>])+<span class="string">&quot;:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ground state energy E per site:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(Answer[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:&quot;</span>)</span><br><span class="line">mag_z(Answer[<span class="number">1</span>][<span class="number">2</span>])</span><br><span class="line">mag_x(Answer[<span class="number">1</span>][<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<pre><code>Ds=6:
ground state energy E per site:
[-1.14887069 -1.14887069 -1.14887069 -1.14887879 -1.14888659 -1.14888873
 -1.14888659 -1.14887879 -1.14887069 -1.14887069]
magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:
z:
0 [-1.43079909e-10]
1 [1.24069037e-08]
2 [-6.39897362e-09]
3 [-8.64023536e-10]
4 [9.2880419e-09]
5 [-3.83658105e-09]
6 [-9.85073963e-10]
7 [8.11689286e-09]
8 [-2.77860332e-09]
9 [-2.90920866e-10]
x:
0 [0.91675276]
1 [0.84696303]
2 [0.78332349]
3 [0.76008148]
4 [0.75169612]
5 [0.75168807]
6 [0.76005655]
7 [0.78330731]
8 [0.84695633]
9 [0.91675164]
</code></pre><ul>
<li><p>可见 z 方向 magnetization 约为零， x 方向上有正的 magnetization，在两边的边界处略大于中间。</p>
</li>
<li><p>作为对比，该问题的精确解如下：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Exact diagonalization Solution</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LA</span><br><span class="line"></span><br><span class="line">N = <span class="number">10</span></span><br><span class="line">n = <span class="number">1</span>&lt;&lt;N</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FlipBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> i^(<span class="number">1</span>&lt;&lt;n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReadBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (i&amp;(<span class="number">1</span>&lt;&lt;n))&gt;&gt;n</span><br><span class="line"></span><br><span class="line">H = np.zeros([n,n], dtype = <span class="built_in">complex</span>)</span><br><span class="line"><span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        res = FlipBit(state, j)</span><br><span class="line">        H[state][res] += -<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,N-<span class="number">1</span>):</span><br><span class="line">        flag = ReadBit(state, j+<span class="number">1</span>) + ReadBit(state, j) + ReadBit(state, j-<span class="number">1</span>)</span><br><span class="line">        sign = <span class="number">1</span> <span class="keyword">if</span> flag % <span class="number">2</span> == <span class="number">1</span> <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">        res = FlipBit(state, j)</span><br><span class="line">        H[state][res] += -<span class="number">1.0j</span> * sign</span><br><span class="line">E,eigenV = LA.eigsh(H,<span class="number">1</span>,which = <span class="string">&#x27;SA&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;exact ground state energy E per site:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(E[<span class="number">0</span>]/N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:&quot;</span>)</span><br><span class="line">mag_z(eigenV)</span><br><span class="line">mag_x(eigenV)</span><br></pre></td></tr></table></figure>
<pre><code>exact ground state energy E per site:
-1.1489442065958528
magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:
z:
0 [-4.02022166e-16]
1 [-1.9246757e-15]
2 [2.60815675e-15]
3 [-3.47812057e-16]
4 [-2.47631776e-15]
5 [3.13724741e-15]
6 [-3.0444397e-16]
7 [-2.10855639e-15]
8 [2.42948023e-15]
9 [-3.0444397e-16]
x:
0 [0.91622482]
1 [0.84621457]
2 [0.78255915]
3 [0.75946665]
4 [0.75122694]
5 [0.75122694]
6 [0.75946665]
7 [0.78255915]
8 [0.84621457]
9 [0.91622482]
</code></pre><ul>
<li><p>最后把结果放在这里方便对比：</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/13/DFUErtflWHhb3Lv.png style="zoom:60%" />  
  <img src=https://s2.loli.net/2022/11/13/BIuGqLTzptO3yr6.png style="zoom:60%" /> 
  <img src=https://s2.loli.net/2022/11/13/JKEgYBLitGrQ2eS.png style="zoom:65%" />  
  </div>



</li>
</ul>
<ul>
<li><p>注：Sub180221.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright:</span></span><br><span class="line"><span class="string">Shuo Yang, shuoyang@tsinghua.edu.cn</span></span><br><span class="line"><span class="string">Nov 1, 2021, Tsinghua, Beijing, China</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> numpy.linalg <span class="keyword">as</span> LA</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LAs</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Group</span>(<span class="params">A,shapeA</span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; transpose + reshape &quot;&quot;&quot;</span></span><br><span class="line">	dimA = np.asarray(np.shape(A))</span><br><span class="line">	rankA = <span class="built_in">len</span>(shapeA)</span><br><span class="line">	</span><br><span class="line">	shapeB = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,rankA):</span><br><span class="line">		shapeB += [np.prod(dimA[shapeA[i]])]</span><br><span class="line">	</span><br><span class="line">	orderB = <span class="built_in">sum</span>(shapeA,[])</span><br><span class="line">	A = np.reshape(np.transpose(A,orderB),shapeB)</span><br><span class="line">	<span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">NCon</span>(<span class="params">Tensor,Index</span>):</span><br><span class="line">	ConList = <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">max</span>(<span class="built_in">sum</span>(Index,[]))+<span class="number">1</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="built_in">len</span>(ConList) &gt; <span class="number">0</span>:</span><br><span class="line">	</span><br><span class="line">		Icon = []</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Index)):</span><br><span class="line">			<span class="keyword">if</span> ConList[<span class="number">0</span>] <span class="keyword">in</span> Index[i]:</span><br><span class="line">				Icon.append(i)</span><br><span class="line">				<span class="keyword">if</span> <span class="built_in">len</span>(Icon) == <span class="number">2</span>:</span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(Icon) == <span class="number">1</span>:</span><br><span class="line">			IndCommon = <span class="built_in">list</span>(<span class="built_in">set</span>([x <span class="keyword">for</span> x <span class="keyword">in</span> Index[Icon[<span class="number">0</span>]] <span class="keyword">if</span> Index[Icon[<span class="number">0</span>]].count(x)&gt;<span class="number">1</span>]))</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span> icom <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IndCommon)):</span><br><span class="line">				Pos = <span class="built_in">sorted</span>([i <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(Index[Icon[<span class="number">0</span>]]) <span class="keyword">if</span> x==IndCommon[icom]])</span><br><span class="line">				Tensor[Icon[<span class="number">0</span>]] = np.trace(Tensor[Icon[<span class="number">0</span>]],axis1=Pos[<span class="number">0</span>],axis2=Pos[<span class="number">1</span>])</span><br><span class="line">				Index[Icon[<span class="number">0</span>]].pop(Pos[<span class="number">1</span>])</span><br><span class="line">				Index[Icon[<span class="number">0</span>]].pop(Pos[<span class="number">0</span>])</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			IndCommon = <span class="built_in">list</span>(<span class="built_in">set</span>(Index[Icon[<span class="number">0</span>]]) &amp; <span class="built_in">set</span>(Index[Icon[<span class="number">1</span>]]))		</span><br><span class="line">			Pos = [[],[]]</span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">				<span class="keyword">for</span> ind <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IndCommon)):</span><br><span class="line">					Pos[i].append(Index[Icon[i]].index(IndCommon[ind]))</span><br><span class="line">			A = np.tensordot(Tensor[Icon[<span class="number">0</span>]],Tensor[Icon[<span class="number">1</span>]],(Pos[<span class="number">0</span>],Pos[<span class="number">1</span>]))</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">				<span class="keyword">for</span> ind <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IndCommon)):</span><br><span class="line">					Index[Icon[i]].remove(IndCommon[ind])</span><br><span class="line">			Index[Icon[<span class="number">0</span>]] = Index[Icon[<span class="number">0</span>]]+Index[Icon[<span class="number">1</span>]]</span><br><span class="line">			Index.pop(Icon[<span class="number">1</span>])</span><br><span class="line">			Tensor[Icon[<span class="number">0</span>]] = A</span><br><span class="line">			Tensor.pop(Icon[<span class="number">1</span>])</span><br><span class="line">		</span><br><span class="line">		ConList = <span class="built_in">list</span>(<span class="built_in">set</span>(ConList)^<span class="built_in">set</span>(IndCommon))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="built_in">len</span>(Index) &gt; <span class="number">1</span>:</span><br><span class="line">		</span><br><span class="line">		Tensor[<span class="number">0</span>] = np.multiply.outer(Tensor[<span class="number">0</span>],Tensor[<span class="number">1</span>])</span><br><span class="line">		Tensor.pop(<span class="number">1</span>)</span><br><span class="line">		Index[<span class="number">0</span>] = Index[<span class="number">0</span>]+Index[<span class="number">1</span>]</span><br><span class="line">		Index.pop(<span class="number">1</span>)</span><br><span class="line">	</span><br><span class="line">	Index = Index[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(Index) &gt; <span class="number">0</span>:</span><br><span class="line">		Order = <span class="built_in">sorted</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(Index)),key=<span class="keyword">lambda</span> k:Index[k])[::-<span class="number">1</span>]	</span><br><span class="line">		Tensor = np.transpose(Tensor[<span class="number">0</span>],Order)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		Tensor = Tensor[<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Tensor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SpinOper</span>(<span class="params">ss</span>):</span><br><span class="line">	spin = (ss-<span class="number">1</span>)/<span class="number">2.0</span></span><br><span class="line">	dz = np.zeros(ss)</span><br><span class="line">	mp = np.zeros(ss-<span class="number">1</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ss):</span><br><span class="line">		dz[i] = spin-i</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ss-<span class="number">1</span>):</span><br><span class="line">		mp[i] = np.sqrt((<span class="number">2</span>*spin-i)*(i+<span class="number">1</span>))</span><br><span class="line">	</span><br><span class="line">	S0 = np.eye(ss)</span><br><span class="line">	Sp = np.diag(mp,<span class="number">1</span>)</span><br><span class="line">	Sm = np.diag(mp,-<span class="number">1</span>)</span><br><span class="line">	Sx = <span class="number">0.5</span>*(Sp+Sm)</span><br><span class="line">	Sy = -<span class="number">0.5j</span>*(Sp-Sm)</span><br><span class="line">	Sz = np.diag(dz)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> S0,Sp,Sm,Sz,Sx,Sy</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OutputT</span>(<span class="params">T,prec=<span class="number">1.0e-10</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; output nonzero elements &quot;&quot;&quot;</span></span><br><span class="line">	pos = np.nonzero(np.<span class="built_in">abs</span>(T)&gt;prec)</span><br><span class="line">	val = T[pos]</span><br><span class="line">	pos = np.transpose(pos)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(val)):</span><br><span class="line">		<span class="built_in">print</span>(pos[i],val[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OutputTFile</span>(<span class="params">file,T,prec=<span class="number">1.0e-10</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; output nonzero elements to file &quot;&quot;&quot;</span></span><br><span class="line">	pos = np.nonzero(np.<span class="built_in">abs</span>(T)&gt;prec)</span><br><span class="line">	val = T[pos]</span><br><span class="line">	pos = np.transpose(pos)</span><br><span class="line">	val = np.reshape(val,[<span class="built_in">len</span>(val),<span class="number">1</span>])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> LA.norm(np.imag(T)) &gt; prec:</span><br><span class="line">		out = np.concatenate((pos+<span class="number">1</span>,np.real(val),np.imag(val)),axis=<span class="number">1</span>)</span><br><span class="line">		np.savetxt(file,out,fmt = <span class="string">&#x27;%d\t&#x27;</span>*np.shape(pos)[<span class="number">1</span>] + <span class="string">&#x27;%0.6f \t %0.6f&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		out = np.concatenate((pos,np.real(val)),axis=<span class="number">1</span>)</span><br><span class="line">		np.savetxt(file,out,fmt = <span class="string">&#x27;%d\t&#x27;</span>*np.shape(pos)[<span class="number">1</span>] + <span class="string">&#x27;%0.6f&#x27;</span>)</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SplitEig</span>(<span class="params">A,Dcut,prec=<span class="number">1.0e-12</span>,safe=<span class="number">3</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; Eig, Lapack + Arpack &quot;&quot;&quot;</span></span><br><span class="line">	D = np.<span class="built_in">min</span>(np.shape(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Dcut &gt;= D-<span class="number">1</span>:</span><br><span class="line">		S,V = LA.eig(A)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		k_ask = <span class="built_in">min</span>(Dcut+safe,D-<span class="number">2</span>)</span><br><span class="line">		S,V = LAs.eigs(A,k=k_ask)</span><br><span class="line">	</span><br><span class="line">	idx = np.isfinite(S)</span><br><span class="line">	<span class="keyword">if</span> idx.<span class="built_in">any</span>() != <span class="literal">False</span>:</span><br><span class="line">		S = S[idx]</span><br><span class="line">		V = V[:,idx]</span><br><span class="line">	order = np.argsort(<span class="built_in">abs</span>(S))[::-<span class="number">1</span>]</span><br><span class="line">	S = S[order]</span><br><span class="line">	V = V[:,order]</span><br><span class="line">	</span><br><span class="line">	S = S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&gt;prec]</span><br><span class="line">	Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">	S = S[:Dc]</span><br><span class="line">	V = V[:,:Dc]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> V,S,Dc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SplitEigh</span>(<span class="params">A,Dcut,mode=<span class="string">&#x27;P&#x27;</span>,prec=<span class="number">1.0e-12</span>,safe=<span class="number">3</span>,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; Eig, Hermitian, Lapack + Arpack &quot;&quot;&quot;</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot; P = perserve, C = cut &quot;&quot;&quot;</span></span><br><span class="line">	D = np.<span class="built_in">min</span>(np.shape(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Dcut &gt;= D-<span class="number">1</span>:</span><br><span class="line">		S,V = LA.eigh(A)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		k_ask = <span class="built_in">min</span>(Dcut+safe,D-<span class="number">2</span>)</span><br><span class="line">		S,V = LAs.eigsh(A,k=k_ask)</span><br><span class="line">	</span><br><span class="line">	idx = np.isfinite(S)</span><br><span class="line">	<span class="keyword">if</span> idx.<span class="built_in">any</span>() != <span class="literal">False</span>:</span><br><span class="line">		S = S[idx]</span><br><span class="line">		V = V[:,idx]</span><br><span class="line">	order = np.argsort(<span class="built_in">abs</span>(S))[::-<span class="number">1</span>]</span><br><span class="line">	S = S[order]</span><br><span class="line">	V = V[:,order]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;P&#x27;</span>:</span><br><span class="line">		S = S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&gt;<span class="number">1.0e-15</span>]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		V = V[:,:Dc]</span><br><span class="line">		S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&lt;prec] = prec*np.sign(S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&lt;prec])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">		S = S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&gt;prec]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		V = V[:,:Dc]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(np.dot(V,np.dot(np.diag(S),np.transpose(np.conj(V))))-A)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> V,S,Dc</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SplitSvd_Lapack</span>(<span class="params">A,Dcut,iweight,mode=<span class="string">&#x27;P&#x27;</span>,prec=<span class="number">1.0e-12</span>,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; SVD, Lapack only &quot;&quot;&quot;</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot; P = perserve, C = cut &quot;&quot;&quot;</span></span><br><span class="line">	</span><br><span class="line">	U,S,V = LA.svd(A,full_matrices=<span class="number">0</span>)</span><br><span class="line">	</span><br><span class="line">	S = np.<span class="built_in">abs</span>(S)</span><br><span class="line">	idx = np.isfinite(S)</span><br><span class="line">	<span class="keyword">if</span> idx.<span class="built_in">any</span>() != <span class="literal">False</span>:</span><br><span class="line">		S = S[idx]</span><br><span class="line">		U = U[:,idx]</span><br><span class="line">		V = V[idx,:]</span><br><span class="line">	order = np.argsort(S)[::-<span class="number">1</span>]</span><br><span class="line">	S = S[order]</span><br><span class="line">	U = U[:,order]</span><br><span class="line">	V = V[order,:]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;P&#x27;</span>:</span><br><span class="line">		S = S[S/S[<span class="number">0</span>]&gt;<span class="number">1.0e-15</span>]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		U = U[:,:Dc]</span><br><span class="line">		V = V[:Dc,:]</span><br><span class="line">		S[S/S[<span class="number">0</span>]&lt;prec] = prec</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">		S = S[S/S[<span class="number">0</span>]&gt;prec]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		U = U[:,:Dc]</span><br><span class="line">		V = V[:Dc,:]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> iweight == <span class="number">1</span>:</span><br><span class="line">		U = np.dot(U,np.diag(np.sqrt(S)))</span><br><span class="line">		V = np.dot(np.diag(np.sqrt(S)),V)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">if</span> iweight == <span class="number">0</span>:</span><br><span class="line">			<span class="built_in">print</span>(LA.norm(np.dot(U,np.dot(np.diag(S),V))-A)/LA.norm(A))</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(LA.norm(np.dot(U,V)-A)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> U,S,V,Dc</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_QRP</span>(<span class="params">UL,T,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-UL-1)(0-T-L) -&gt; (0-Tnew-L)(0-UR-1) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.tensordot(UL,T,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">	A = np.reshape(A,[np.prod(shapeT[:-<span class="number">1</span>]),shapeT[-<span class="number">1</span>]])</span><br><span class="line">	Tnew,UR = linalg.qr(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UR)))</span><br><span class="line">	Tnew = np.dot(Tnew,Sign)</span><br><span class="line">	UR = np.dot(Sign,UR)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		A = np.reshape(A,shapeT)</span><br><span class="line">		B = np.tensordot(Tnew,UR,(rankT-<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>),<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[-<span class="number">1</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Tnew,UR</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_LQP</span>(<span class="params">T,UR,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-T-L)(0-UR-1) -&gt; (0-UL-1)(0-Tnew-L) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.tensordot(T,UR,(rankT-<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">	A = np.reshape(A,[shapeT[<span class="number">0</span>],np.prod(shapeT[<span class="number">1</span>:])])</span><br><span class="line">	UL,Tnew = linalg.rq(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UL)))</span><br><span class="line">	UL = np.dot(UL,Sign)</span><br><span class="line">	Tnew = np.dot(Sign,Tnew)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		A = np.reshape(A,shapeT)</span><br><span class="line">		B = np.tensordot(UL,Tnew,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">1</span>,rankT),<span class="built_in">range</span>(<span class="number">1</span>,rankT)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[<span class="number">0</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> UL,Tnew</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_QR0P</span>(<span class="params">T,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-T-L) -&gt; (0-Tnew-L)(0-UR-1) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.reshape(T,[np.prod(shapeT[:-<span class="number">1</span>]),shapeT[-<span class="number">1</span>]])</span><br><span class="line">	Tnew,UR = linalg.qr(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UR)))</span><br><span class="line">	Tnew = np.dot(Tnew,Sign)</span><br><span class="line">	UR = np.dot(Sign,UR)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		B = np.tensordot(Tnew,UR,(rankT-<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(T-B)/LA.norm(T))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>),<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[-<span class="number">1</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Tnew,UR</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_LQ0P</span>(<span class="params">T,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-T-L) -&gt; (0-UL-1)(0-Tnew-L) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.reshape(T,[shapeT[<span class="number">0</span>],np.prod(shapeT[<span class="number">1</span>:])])</span><br><span class="line">	UL,Tnew = linalg.rq(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UL)))</span><br><span class="line">	UL = np.dot(UL,Sign)</span><br><span class="line">	Tnew = np.dot(Sign,Tnew)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		B = np.tensordot(UL,Tnew,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(T-B)/LA.norm(T))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">1</span>,rankT),<span class="built_in">range</span>(<span class="number">1</span>,rankT)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[<span class="number">0</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> UL,Tnew</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	Test = &#123;&#125;</span><br><span class="line">	Test[<span class="string">&#x27;Group&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;NCon&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;SplitEig&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;SplitSvd&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;Mps_QRP&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;Group&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		A = np.random.rand(<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">		A = Group(A,[[<span class="number">0</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">1</span>]])</span><br><span class="line">		<span class="built_in">print</span>(A)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;NCon&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		T1 = np.random.rand(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,([<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>]))</span><br><span class="line">		A = np.transpose(A,[<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>])</span><br><span class="line">		B = NCon([T1,T2],[[<span class="number">1</span>,-<span class="number">2</span>,-<span class="number">4</span>,<span class="number">2</span>],[-<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,-<span class="number">3</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,(<span class="number">3</span>,<span class="number">2</span>))</span><br><span class="line">		A = np.transpose(A,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">5</span>])</span><br><span class="line">		B = NCon([T1,T2],[[-<span class="number">5</span>,-<span class="number">1</span>,-<span class="number">4</span>,<span class="number">1</span>],[-<span class="number">2</span>,-<span class="number">3</span>,<span class="number">1</span>,-<span class="number">6</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,([<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>]))</span><br><span class="line">		A = np.tensordot(A,T3,([<span class="number">0</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">3</span>]))</span><br><span class="line">		A = np.transpose(A,[<span class="number">3</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">		B = NCon([T1,T2,T3],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>],[-<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,-<span class="number">3</span>],[-<span class="number">4</span>,<span class="number">3</span>,-<span class="number">1</span>,<span class="number">4</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		</span><br><span class="line">		T1 = np.random.rand(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">4</span>,<span class="number">2</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.kron(T1,T2)</span><br><span class="line">		A = np.reshape(A,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">		B = NCon([T1,T2],[[-<span class="number">1</span>,-<span class="number">3</span>],[-<span class="number">2</span>,-<span class="number">4</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.kron(T1,T2)</span><br><span class="line">		A = np.kron(A,T3)</span><br><span class="line">		A = np.reshape(A,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>])</span><br><span class="line">		A = np.transpose(A,[<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">		B = NCon([T1,T2,T3],[[-<span class="number">2</span>,-<span class="number">6</span>],[-<span class="number">1</span>,-<span class="number">4</span>],[-<span class="number">5</span>,-<span class="number">3</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		</span><br><span class="line">		T = np.random.rand(<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.eye(<span class="number">3</span>)</span><br><span class="line">		A = np.tensordot(T,A,([<span class="number">0</span>,<span class="number">3</span>],[<span class="number">0</span>,<span class="number">1</span>]))</span><br><span class="line">		A = np.transpose(A,[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>])</span><br><span class="line">		B = NCon([T],[[<span class="number">1</span>,-<span class="number">2</span>,-<span class="number">3</span>,<span class="number">1</span>,-<span class="number">1</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.eye(<span class="number">3</span>*<span class="number">2</span>)</span><br><span class="line">		A = np.reshape(A,[<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>])</span><br><span class="line">		A = np.tensordot(T,A,([<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</span><br><span class="line">		B = NCon([T],[[<span class="number">1</span>,<span class="number">2</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		</span><br><span class="line">		T1 = np.random.rand(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.kron(A,T3)</span><br><span class="line">		A = np.reshape(A,[<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">		B = NCon([T1,T2,T3],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">3</span>],[-<span class="number">2</span>,-<span class="number">4</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		T1 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">		T4 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,T3,(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">		A = np.tensordot(A,T4,([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</span><br><span class="line">		B = NCon([T1,T2,T3,T4],[[<span class="number">3</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">6</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (Test[<span class="string">&#x27;SplitEig&#x27;</span>] == <span class="number">1</span>) | (Test[<span class="string">&#x27;SplitSvd&#x27;</span>] == <span class="number">1</span>):</span><br><span class="line">		T = np.zeros((<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">		T[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>] = -<span class="number">1</span></span><br><span class="line">		T[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>] = -<span class="number">1</span></span><br><span class="line">		T[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>] = -<span class="number">1</span></span><br><span class="line">		</span><br><span class="line">		G = np.zeros((<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">		G[<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">		G[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">		G[<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">		G[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T,G,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,G,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,G,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,np.conj(A),([<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>],[<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>]))</span><br><span class="line">		STA = Group(A,[[<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">4</span>],[<span class="number">2</span>,<span class="number">5</span>]])</span><br><span class="line">	</span><br><span class="line">		A = np.reshape(T,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>])</span><br><span class="line">		A = np.tensordot(A,np.conj(A),(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		STB = Group(A,[[<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">4</span>],[<span class="number">2</span>,<span class="number">5</span>]])</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(STA,STB,([<span class="number">0</span>],[<span class="number">0</span>]))</span><br><span class="line">		ST0 = np.transpose(A,[<span class="number">3</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;SplitEig&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		ST = Group(ST0,[[<span class="number">3</span>,<span class="number">0</span>],[<span class="number">2</span>,<span class="number">1</span>]])</span><br><span class="line">		STh = (ST+np.transpose(ST))/<span class="number">2</span></span><br><span class="line">		ST0h = np.reshape(STh,[<span class="number">9</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">9</span>])</span><br><span class="line">		Dfull = np.shape(ST)[<span class="number">0</span>]</span><br><span class="line">		<span class="built_in">print</span>(Dfull)</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;full eig&#x27;</span>)</span><br><span class="line">		V,S,Dc = SplitEig(STh,Dfull)</span><br><span class="line">		Sfull = S</span><br><span class="line">		<span class="built_in">print</span>(Sfull,<span class="built_in">len</span>(Sfull))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;partial eig&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> Dcut <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,Dfull+<span class="number">1</span>):</span><br><span class="line">			V,S,Dc = SplitEig(STh,Dcut)</span><br><span class="line">			<span class="built_in">print</span>(Dcut,Dc,LA.norm(<span class="built_in">abs</span>(S)-<span class="built_in">abs</span>(Sfull[:Dc])))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;full eigh&#x27;</span>)</span><br><span class="line">		V,S,Dc = SplitEigh(STh,Dfull,icheck=<span class="number">1</span>)</span><br><span class="line">		Sfull = S</span><br><span class="line">		<span class="built_in">print</span>(Sfull,<span class="built_in">len</span>(Sfull))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;partial eigh&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> Dcut <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,Dfull+<span class="number">1</span>):</span><br><span class="line">			V,S,Dc = SplitEigh(STh,Dcut,icheck=<span class="number">1</span>)</span><br><span class="line">			<span class="built_in">print</span>(Dcut,Dc,LA.norm(<span class="built_in">abs</span>(S)-<span class="built_in">abs</span>(Sfull[:Dc])))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;SplitSvd&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		ST = Group(ST0,[[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">		ST1 = Group(ST0,[[<span class="number">0</span>],[<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">		ST2 = Group(ST0,[[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">2</span>],[<span class="number">3</span>]])</span><br><span class="line">		Dfull = np.shape(ST)[<span class="number">0</span>]</span><br><span class="line">		<span class="built_in">print</span>(Dfull)</span><br><span class="line"></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;full svd&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> iweight <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">			U,S,V,Dc = SplitSvd_Lapack(ST,Dfull,iweight,icheck=<span class="number">1</span>)</span><br><span class="line">		Sfull = S</span><br><span class="line">		<span class="built_in">print</span>(Sfull,<span class="built_in">len</span>(Sfull))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;partial svd&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> Dcut <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,Dfull+<span class="number">1</span>):</span><br><span class="line">			<span class="keyword">for</span> iweight <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">				U,S,V,Dc = SplitSvd_Lapack(ST,Dcut,iweight,mode=<span class="string">&#x27;C&#x27;</span>,icheck=<span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(Dcut,iweight,Dc,LA.norm(S-Sfull[:Dc]))</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;Mps_QRP&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;no Z2, rank 3&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> D1,D2,D3 <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>)):</span><br><span class="line">			D = [D1,D2,D3]</span><br><span class="line">			T0 = np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>])</span><br><span class="line">			UL = np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>])</span><br><span class="line">			UR = np.random.rand(D[<span class="number">2</span>],D[<span class="number">2</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">2</span>],D[<span class="number">2</span>])</span><br><span class="line">			</span><br><span class="line">			<span class="built_in">print</span>(D1,D2,D3)</span><br><span class="line">			T,UR = Mps_QRP(UL,T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQP(T0,UR,icheck=<span class="number">1</span>)</span><br><span class="line">			T,UR = Mps_QR0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQ0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;no Z2, rank 4&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> D1,D2,D3,D4 <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>)):</span><br><span class="line">			D = [D1,D2,D3,D4]</span><br><span class="line">			T0 = np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>],D[<span class="number">3</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>],D[<span class="number">3</span>])</span><br><span class="line">			UL = np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>])</span><br><span class="line">			UR = np.random.rand(D[<span class="number">3</span>],D[<span class="number">3</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">3</span>],D[<span class="number">3</span>])</span><br><span class="line">			</span><br><span class="line">			<span class="built_in">print</span>(D1,D2,D3,D4)</span><br><span class="line">			T,UR = Mps_QRP(UL,T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQP(T0,UR,icheck=<span class="number">1</span>)</span><br><span class="line">			T,UR = Mps_QR0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQ0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/12/Semiconductor%20physics2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/12/Semiconductor%20physics2/" class="post-title-link" itemprop="url">Semiconductor Physics(section 2)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-11-12 21:20:00 / 修改时间：15:35:16" itemprop="dateCreated datePublished" datetime="2022-11-12T21:20:00+08:00">2022-11-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Semiconductor-Physics/" itemprop="url" rel="index"><span itemprop="name">Semiconductor Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="A-The-density-of-states"><a href="#A-The-density-of-states" class="headerlink" title="A. The density of states"></a>A. The density of states</h3>
      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hsu Quinn"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Hsu Quinn</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Xsdg217" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Xsdg217" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fawkes@mail.ustc.edu.cn" title="E-Mail → mailto:fawkes@mail.ustc.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6090876649" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6090876649" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/bing-tang-bo-luo-89" title="Zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;bing-tang-bo-luo-89" rel="noopener" target="_blank"><i class="fa fa-globe fa-fw"></i>Zhihu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://music.163.com/#/user/home?id=1383517537" title="Wangyiyun → https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1383517537" rel="noopener" target="_blank"><i class="fa fa-music fa-fw"></i>Wangyiyun</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/58820360" title="BiliBili → https:&#x2F;&#x2F;space.bilibili.com&#x2F;58820360" rel="noopener" target="_blank"><i class="fa fa-telegram fa-fw"></i>BiliBili</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hsu Quinn</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>
        




  <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-firestore.js"></script>
  <script>
    firebase.initializeApp({
      apiKey   : '',
      projectId: 'count0908-21d35'
    });

    function getCount(doc, increaseCount) {
      // IncreaseCount will be false when not in article page
      return doc.get().then(d => {
        var count = 0;
        if (!d.exists) { // Has no data, initialize count
          if (increaseCount) {
            doc.set({
              count: 1
            });
            count = 1;
          }
        } else { // Has data
          count = d.data().count;
          if (increaseCount) {
            // If first view this article
            doc.set({ // Increase count
              count: count + 1
            });
            count++;
          }
        }

        return count;
      });
    }

    function appendCountTo(el) {
      return count => {
        el.innerText = count;
      }
    }
  </script>
  <script>
    (function() {
      var db = firebase.firestore();
      var articles = db.collection('articles');

      if (CONFIG.page.isPost) { // Is article page
        var title = document.querySelector('.post-title').innerText.trim();
        var doc = articles.doc(title);
        var increaseCount = CONFIG.hostname === location.hostname;
        if (localStorage.getItem(title)) {
          increaseCount = false;
        } else {
          // Mark as visited
          localStorage.setItem(title, true);
        }
        getCount(doc, increaseCount).then(appendCountTo(document.querySelector('.firestore-visitors-count')));
      } else if (CONFIG.page.isHome) { // Is index page
        var promises = [...document.querySelectorAll('.post-title')].map(element => {
          var title = element.innerText.trim();
          var doc = articles.doc(title);
          return getCount(doc);
        });
        Promise.all(promises).then(counts => {
          var metas = document.querySelectorAll('.firestore-visitors-count');
          counts.forEach((val, idx) => {
            appendCountTo(metas[idx])(val);
          });
        });
      }
    })();
  </script>




      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  











<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
