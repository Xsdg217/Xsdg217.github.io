<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|Amita:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="BLOG">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="BLOG">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Hsu Quinn">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>BLOG</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-ER8FH828WC"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-ER8FH828WC');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d5cf64a751ac91d8a331bada0477e161";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">BLOG</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>å…¬ç›Š 404</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/24/Eh&TSH/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/24/Eh&TSH/" class="post-title-link" itemprop="url">A bit theory of nonadiabatic dynamics</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-11-24 17:33:30 / ä¿®æ”¹æ—¶é—´ï¼š17:34:44" itemprop="dateCreated datePublished" datetime="2022-11-24T17:33:30+08:00">2022-11-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Some-Notes/" itemprop="url" rel="index"><span itemprop="name">Some Notes</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Nonadiabatic-Dynamics"><a href="#Nonadiabatic-Dynamics" class="headerlink" title="Nonadiabatic Dynamics"></a>Nonadiabatic Dynamics</h2><h3 id="1-Ehrenfest-Dynamics"><a href="#1-Ehrenfest-Dynamics" class="headerlink" title="1. Ehrenfest Dynamics"></a><strong>1. Ehrenfest Dynamics</strong></h3><p>We use a single-configuration Ansatz for the total wavefunction:</p>
<script type="math/tex; mode=display">
\Psi(\boldsymbol{r}, \boldsymbol{R}, t)=\Phi(\boldsymbol{r}, t) \Omega(\boldsymbol{R}, t) \exp \left[\frac{i}{\hbar} \int_{t_0}^t d t^{\prime} E_{e l}\left(t^{\prime}\right)\right] .</script><p>The exponential part  is called the â€œphase termâ€:</p>
<script type="math/tex; mode=display">
\begin{gathered}
E_{e l}(t)=\iint d r d \boldsymbol{R} \Phi^*(\boldsymbol{r}, t) \Omega^*(\boldsymbol{R}, t) \hat{\mathcal{H}}_{e l}(\boldsymbol{r}, \boldsymbol{R}) 
\times \Phi(\boldsymbol{r}, t) \Omega(\boldsymbol{R}, t)
\end{gathered}</script><p>Insert the representation into TDSE,  left multiplication by $\Omega^*(R, t)$  and integrating over Rï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar  \frac{\partial \Phi(r, t)}{\partial t}=& -\frac{\hbar^2}{2} \sum_j \nabla_i^2 \Phi(r, t)\\
&+\left[\int d R \Omega^*(R, t) \hat{V}(r, R) \Omega(R, t)\right] \Phi(r, t) 
\end{aligned} \tag1</script><p>Similarly,</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar  \frac{\partial \Omega(\boldsymbol{R}, t)}{\partial t}&=-\frac{\hbar^2}{2} \sum_\gamma M_\gamma^{-1} \nabla_\gamma^2 \Omega(\boldsymbol{R}, t) \\
& +\left[\int d r \Phi^*(r, t) \hat{\mathcal{H}}_{e /}(r, R) \Phi(r, t)\right] \Omega(\boldsymbol{R}, t) .
\end{aligned} \tag 2</script><p> forms the so-called mean-field time-dependent self-consistent field (TDSCF) method.</p>
<h4 id="1-1-The-Time-Dependent-Nuclear-Equation"><a href="#1-1-The-Time-Dependent-Nuclear-Equation" class="headerlink" title="1.1  The Time-Dependent Nuclear Equation"></a>1.1  The Time-Dependent Nuclear Equation</h4><p>The  polar representation:</p>
<script type="math/tex; mode=display">
\Omega(\boldsymbol{R}, t)=A(\boldsymbol{R}, t) \exp \left[\frac{i}{\hbar} S(\boldsymbol{R}, t)\right] \tag3</script><p>Insert (3) into (2):</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar & \frac{\partial A(\boldsymbol{R}, t)}{\partial t}-A(\boldsymbol{R}, t) \frac{\partial S(\boldsymbol{R}, t)}{\partial t}=\\
&-\frac{\hbar^2}{2} \sum_\gamma M_\gamma^{-1} \nabla_\gamma^2 A(\boldsymbol{R}, t) 
-i \hbar \sum_\gamma M_\gamma^{-1} \nabla_\gamma A(\boldsymbol{R}, t) \cdot \nabla_\gamma S(\boldsymbol{R}, t) \\
&-\frac{i \hbar}{2} \sum_\gamma M_\gamma^{-1} A(\boldsymbol{R}, t) \nabla_\gamma^2 S(\boldsymbol{R}, t) 
+\frac{1}{2} \sum_\gamma M_\gamma^{-1} A(\boldsymbol{R}, t)\left(\nabla_\gamma S(\boldsymbol{R}, t)\right)^2 \\
&+\left[\int_\gamma \Phi^*(\boldsymbol{r}, t) \hat{\mathcal{H}}_{e /}(\boldsymbol{r}, \boldsymbol{R}) \Phi(\boldsymbol{r}, t)\right] A(\boldsymbol{R}, t) .
\end{aligned}</script><p>Taking the classical limit:</p>
<script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial S(R, t)}{\partial t}=&-\frac{1}{2} \sum_\gamma M_\gamma^{-1}\left(\nabla_\gamma S(R, t)\right)^2 \\
&-\left[\int d r \Phi^*(r, t) \hat{\mathcal{H}}_{e l}(r, R) \Phi(r, t)\right] 
\end{aligned}\tag 4</script><p>Like the â€œHamiltonâ€“Jacobiâ€ (HJ) equation, </p>
<script type="math/tex; mode=display">
\mathbf{P}\left(t_0\right)=\left.\nabla_{\mathbf{R}} S(\mathbf{R})\right|_{\mathbf{R}\left(t_0\right)}</script><p>We obtain the Newton-like equation for the nuclear trajectories corresponding to the HJ Equation (4):</p>
<script type="math/tex; mode=display">
\frac{d \boldsymbol{P}_\gamma(t)}{d t}=-\nabla_\gamma\left[\int d r \Phi^*(\boldsymbol{r}, t) \hat{\mathcal{H}}_{e l}(\boldsymbol{r}, \boldsymbol{R}(t)) \Phi(\boldsymbol{r}, t)\right]</script><p>or </p>
<script type="math/tex; mode=display">
M_\gamma \ddot{R}_\gamma(t)=-\nabla_\gamma\left\langle\hat{\mathcal{H}}_{e l}(\boldsymbol{r}, \boldsymbol{R}(t))\right\rangle \tag 5</script><h4 id="1-2-The-Time-Dependent-Electronic-Equation"><a href="#1-2-The-Time-Dependent-Electronic-Equation" class="headerlink" title="1.2   The Time-Dependent Electronic Equation"></a>1.2   The Time-Dependent Electronic Equation</h4><p>We take the classical limit of the nuclear degrees of freedom:</p>
<script type="math/tex; mode=display">
|\Omega(\boldsymbol{R}, t)|^2=\prod_\gamma \delta\left(\boldsymbol{R}_\gamma-\boldsymbol{R}_\gamma(t)\right)</script><script type="math/tex; mode=display">
i \hbar \frac{\partial \Phi(r ; R(t), t)}{\partial t}=\hat{\mathcal{H}}_{e l}(r, R(t)) \Phi(r ; R(t), t)</script><h3 id="2-BO-MD-and-Its-Nonadiabatic-Extensions"><a href="#2-BO-MD-and-Its-Nonadiabatic-Extensions" class="headerlink" title="2. BO-MD and Its Nonadiabatic Extensions"></a><strong>2. BO-MD and Its Nonadiabatic Extensions</strong></h3><script type="math/tex; mode=display">
\Psi(\boldsymbol{r}, \boldsymbol{R}, t)=\sum_i^{\infty} \Omega_i(\boldsymbol{R}, t) \Phi_i(\boldsymbol{r} ; \boldsymbol{R})\tag 6</script><script type="math/tex; mode=display">
\hat{\mathcal{H}}_{e l}(r, R) \Phi_i(r ; R)=E_i^{e l}(R) \Phi_i(r ; R)</script><p>Similarly,</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar \frac{\partial}{\partial t} \Omega_j(R, t)=& {\left[-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2+E_j^{e l}(R)\right] \Omega_j(R, t) } \\
&+\sum_j^{\infty} \mathcal{F}_{j i} \Omega_i(R, t) .
\end{aligned}\tag 7</script><script type="math/tex; mode=display">
\begin{aligned}
&\mathcal{F}_{j i}(\boldsymbol{R})=\int d \boldsymbol{r} \Phi_j^*(\boldsymbol{r}: \boldsymbol{R})\left[-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2\right] \Phi_i(\boldsymbol{r};\boldsymbol{R}) \\
&\quad+\sum_\gamma \frac{1}{M_\gamma}\left\{\int d r \Phi_j^*(\boldsymbol{r} ; \boldsymbol{R})\left[-i \hbar \nabla_\gamma\right] \Phi_i(\boldsymbol{r} ; \boldsymbol{R})\right\}\times\left[-i \hbar \nabla_\gamma\right] 
\end{aligned}\tag 8</script><h4 id="2-1-The-Adiabatic-BOA"><a href="#2-1-The-Adiabatic-BOA" class="headerlink" title="2.1 The Adiabatic BOA"></a>2.1 The Adiabatic BOA</h4><p>Only remain diagonal terms ï¼ˆdiagonal correctionï¼‰:</p>
<script type="math/tex; mode=display">
\mathcal{F}_{j j}(\boldsymbol{R})=\int d \boldsymbol{r} \Phi_j^*(\boldsymbol{r} ; \boldsymbol{R})\left[-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2\right] \Phi_j(\boldsymbol{r} ; \boldsymbol{R})\tag 9</script><p>As in 1.1,let all Fji(R) = 0,insert (10) into (7):</p>
<script type="math/tex; mode=display">
\Omega_j(\boldsymbol{R}, t)=A_j(\boldsymbol{R}, t) \exp \left[\frac{i}{\hbar} S_j(\boldsymbol{R}, t)\right] .\tag {10}</script><script type="math/tex; mode=display">
\frac{\partial S_j(R, t)}{\partial t}=-\frac{1}{2} \sum M_\gamma^{-1}\left(\nabla_\gamma S_j(R, t)\right)^2-E_j^{e l}(\boldsymbol{R}) \tag{11}</script><p>Using the relation </p>
<script type="math/tex; mode=display">
\left.\nabla_\gamma S_j\right|_{\mathbf{R}(t)}=\mathbf{P}_j^\gamma(t)</script><p>obtain a Newton-like equation of motion for the â€œclassicalâ€ nuclei evolving in electronic state j :</p>
<script type="math/tex; mode=display">
M_\gamma \boldsymbol{R}_j^\gamma(t)=-\nabla_\gamma E_j^{e l}(\boldsymbol{R}(t))</script><p>In summary, the BO-MD equations:</p>
<script type="math/tex; mode=display">
\begin{aligned}
&\hat{\mathcal{H}}_{e l}(r, R(t)) \Phi_j(r ; \boldsymbol{R}(t))=E_j^{e l}(\boldsymbol{R}(t)) \Phi_j(r ; R(t))\\
&\begin{aligned}
M_\gamma \ddot{R}_j^\gamma(t) &=-\nabla_\gamma E_j^{e l}(R(t)) \\
&=-\nabla_\gamma\underset{\min \Phi_j}{ }\left\langle\Phi_j\left|\hat{\mathcal{H}}_{el}(\boldsymbol{r}, \boldsymbol{R}(t))\right| \Phi_j\right\rangle,
\end{aligned}
\end{aligned}</script><p>Due to the assumption that  Fji =0, BO-MD always evolves on a single electronic PES( ground state).</p>
<h4 id="2-2-Trajectory-Based-Nonadiabatic-Dynamics"><a href="#2-2-Trajectory-Based-Nonadiabatic-Dynamics" class="headerlink" title="2.2. Trajectory-Based Nonadiabatic Dynamics"></a>2.2. Trajectory-Based Nonadiabatic Dynamics</h4><p>Rewrite (7) into :</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar \frac{\partial \Omega_j(R, t)}{\partial t}=&-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \nabla_\gamma^2 \Omega_j(R, t) \\
&+E_j^{e l}(R) \Omega_j(R, t) \\
&+\sum_{\gamma i} \frac{\hbar^2}{2 M_\gamma} D_{j i}^\gamma(R) \Omega_i(R, t) \\
&-\sum_{\gamma, i \neq j} \frac{\hbar^2}{M_\gamma} d_{j i}^\gamma(R) \cdot \nabla_\gamma \Omega_i(R, t)
\end{aligned}\tag {12}</script><p>where</p>
<script type="math/tex; mode=display">
d_{j i}^\gamma(R)=\int d r \Phi_j^*(r ; R) \nabla_\gamma \Phi_i(r ; R)</script><script type="math/tex; mode=display">
D_{j i}^\gamma(R)=-\int d r \Phi_j^*(r ; R) \nabla_\gamma^2 \Phi_i(r ; R)</script><h4 id="2-3-The-Nonadiabatic-Bohmian-Dynamics-NABDY-Equations"><a href="#2-3-The-Nonadiabatic-Bohmian-Dynamics-NABDY-Equations" class="headerlink" title="2.3 The Nonadiabatic Bohmian Dynamics (NABDY) Equations"></a>2.3 The Nonadiabatic Bohmian Dynamics (NABDY) Equations</h4><p>The polar representation (10) in Eq(12):</p>
<script type="math/tex; mode=display">
\begin{aligned}
-& \frac{\partial S_j(\boldsymbol{R}, t)}{\partial t}=\sum_\gamma \frac{1}{2 M_\gamma}\left(\nabla_\gamma S_j(\boldsymbol{R}, t)\right)^2+E_j^{e \prime}(\boldsymbol{R}) \\
&-\sum_\gamma \frac{\hbar^2}{2 M_\gamma} \frac{\nabla_\gamma^2 A_j(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \\
&+\sum_{\gamma i} \frac{\hbar^2}{2 M_\gamma} D_{j i}^\gamma(\boldsymbol{R}) \frac{A_i(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \Re\left[e^{i \phi_{i j}(R, t)}\right] \\
&-\sum_{\gamma, i \neq j} \frac{\hbar^2}{M_\gamma} \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \frac{\nabla_\gamma A_i(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \Re\left[e^{i \phi_{i j}(\boldsymbol{R}, t)}\right] \\
&+\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} \frac{A_j(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \nabla_\gamma S_i(\boldsymbol{R}, t) \\
& \times \Im\left[e^{i \phi_{i j}(\boldsymbol{R}, t)}\right]
\end{aligned}\tag{13}</script><p>and </p>
<script type="math/tex; mode=display">
\begin{aligned}
&\hbar \frac{\partial A_j(R, t)}{\partial t}=-\sum_\gamma \frac{\hbar}{M_\gamma} \nabla_\gamma A_j(R, t) \cdot \nabla_\gamma S_j(R, t) \\
&-\sum_\gamma \frac{\hbar}{2 M_\gamma} A_j(R, t) \nabla_\gamma^2 S_j(R, t) \\
&+\sum_{\gamma i} \frac{\hbar^2}{2 M_\gamma} D_{j i}^\gamma(R) A_i(R, t) \Im\left[e^{i \phi_{i j}(R, t)}\right] \\
&-\sum_{\gamma, i \neq j} \frac{\hbar^2}{M_\gamma} d_{j i}^\gamma(R) \cdot \nabla_\gamma A_i(R, t) \Im\left[e^{i \phi_{i j}(R, t)}\right] \\
&-\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} A_i(R, t) d_{j i}^\gamma(R) \cdot \nabla_\gamma S_i(R, t) \\
&\times \Re\left[e^{i \phi_{i j}(R, t)}\right]  \\
&
\end{aligned}\tag{14}</script><p>where </p>
<script type="math/tex; mode=display">
\phi_{ij}(\mathbf{R},t)= \frac{1}{\hbar}\left(S_i(\mathbf{R}, t)-S_j(\mathbf{R}, t)\right)</script><p>(13)(14) correspond to the exact S.Eq. for a nuclear-wave-func. evolving in the potential of the different elec-surfaces.            invlove fo-,so-, coupling elements from other PESs.</p>
<p>In (13), 1,2-terms: classical H-J eq for action S;      3-term: all quantum effects in a single elec-state and introduce nonlocality;    4,5,6-terms: non-adiabatic quantum potential, describle interstate contributions.     Use HJ definition </p>
<script type="math/tex; mode=display">
\left.\nabla_\beta S_j(\mathbf{R}, t)\right|_{\mathbf{R}(t)}=\mathbf{P}_j^\beta(t)</script><p>have </p>
<script type="math/tex; mode=display">
\begin{aligned}
M_\beta \frac{d^2 \boldsymbol{R}_\beta(t)}{\left(d t^j\right)^2}=&-\nabla_\beta\left[E_j^{e l}(\boldsymbol{R}(t))+\mathcal{Q}_j(\boldsymbol{R}(t), t)\right.\\
&\left.+\sum_i \mathcal{D}_{j i}(\boldsymbol{R}(t), t)\right]
\end{aligned}\tag{15}</script><h4 id="2-4-The-TSH-Dynamics"><a href="#2-4-The-TSH-Dynamics" class="headerlink" title="2.4 The TSH Dynamics"></a>2.4 The TSH Dynamics</h4><p>An approximation to the â€œin principleâ€ exact NABDY formulation of the nuclear equations of motion.</p>
<p>From (13),(14):</p>
<script type="math/tex; mode=display">
\begin{aligned}
-& \frac{\partial S_j(\boldsymbol{R}, t)}{\partial t}=\sum_\gamma \frac{1}{2 M_\gamma}\left(\nabla_\gamma S_j(\boldsymbol{R}, t)\right)^2+E_j^{e l}(\boldsymbol{R}) \\
&+\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} \frac{A_i(\boldsymbol{R}, t)}{A_j(\boldsymbol{R}, t)} \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \nabla_\gamma S_i(\boldsymbol{R}, t) \\
& \times \Im\left[e^{i \phi_{i j}(R, t)}\right]
\end{aligned}\tag{16}</script><script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial A_j(\boldsymbol{R}, t)}{\partial t}=&-\sum_\gamma \frac{1}{M_\gamma} \nabla_\gamma A_j(\boldsymbol{R}, t) \cdot \nabla_\gamma S_j(\boldsymbol{R}, t) \\
&-\sum_\gamma \frac{1}{2 M_\gamma} A_j(\boldsymbol{R}, t) \nabla_\gamma^2 S_j(\boldsymbol{R}, t) \\
&-\sum_{\gamma, i \neq j} \frac{1}{M_\gamma} A_i(\boldsymbol{R}, t) \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}) \cdot \nabla_\gamma S_i(\boldsymbol{R}, t) \\
& \times \Re\left[e^{i \phi_{i j}(R, t)}\right] .
\end{aligned}\tag{17}</script><p>Consider this â€œclassicallyâ€:the different trajectories (with different initial conditions) are assumed to be independent from each other. ï¼ˆITAï¼‰</p>
<script type="math/tex; mode=display">
\left(A_j^{C L}(R(t), t)\right)^2=\frac{N_j(R(t), d V, t)}{N_t} \frac{1}{d V}</script><p>In TSH, the EOM of nuclear trajectories given by (16) , which independent with dï¼š</p>
<script type="math/tex; mode=display">
\frac{d \boldsymbol{P}_j^\beta(t)}{d t^j}=-\nabla_\beta E_j^{e l}(\boldsymbol{R}(t))\tag{18}</script><p>If NACs are negligible, the trajectories evolve along the adiabatic PES.</p>
<p>If a region of strong coupling is encountered:</p>
<script type="math/tex; mode=display">
\begin{aligned}
-& \frac{\partial S_j^{Q M}(\boldsymbol{R}(t), t)}{\partial t}=E_j^{e l}(\boldsymbol{R}(t)) +\sum_{\gamma, i \neq j} \frac{\hbar}{M_\gamma} \frac{A_i^{Q M}(\boldsymbol{R}(t), t)}{A_j^{Q M}(\boldsymbol{R}(t), t)} \times \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}(t)) \cdot \dot{R}_\gamma(t) \Im\left[e^{i \phi_{i j}^{Q M}(R(t), t)}\right]
\end{aligned}</script><script type="math/tex; mode=display">
\begin{aligned}
\frac{\partial A_j^{Q M}(R(t), t)}{\partial t}=-\sum_{\gamma, i \neq j} \frac{1}{M_\gamma} A_i^{Q M}(R(t), t)\times \boldsymbol{d}_{j i}^\gamma(\boldsymbol{R}(t)) \cdot \dot{R}_\gamma(t) \Re\left[e^{i \phi_{i j}^{Q M}(R(t), t)}\right]
\end{aligned}</script><p>i.e.</p>
<script type="math/tex; mode=display">
\begin{aligned}
i \hbar & \frac{\partial C_j(\boldsymbol{R}(t), t)}{\partial t}=C_j(\boldsymbol{R}(t), t) E_j^{\mathrm{el}}(\boldsymbol{R}(t)) -i \hbar \sum_i\left(\boldsymbol{d}_{j i}(\boldsymbol{R}(t)) \cdot \boldsymbol{R}(t) C_i(\boldsymbol{R}(t), t)\right)
\end{aligned}\tag{19}</script><p>with </p>
<script type="math/tex; mode=display">
C_j(\mathbf{R}(t), t)=A_j^{\mathrm{QM}}(\mathbf{R}(t), t) \exp \left[\frac{i}{\hbar} S_j^{\mathrm{QM}}(\mathbf{R}(t), t)\right]</script><p>In TSH , after enough sampling, internal consistency criterion:</p>
<script type="math/tex; mode=display">
\left(A_j^{C L}(R(t), t)\right)^2=\left(A_j^{Q M}(R(t), t)\right)^2</script><p>Tully gives:</p>
<script type="math/tex; mode=display">
\begin{aligned}
&p_{i \leftarrow j}^{[\alpha]}(t, t+\Delta t)= \\
&-2 \int_t^{t+\Delta t} d \tau \frac{\Re\left[C_i^{[\alpha]}(\tau) C_j^{[\alpha] *}(\tau) \boldsymbol{R}(\tau) \cdot \boldsymbol{d}_{i j}(\boldsymbol{R}(\tau))\right]}{C_j^{[\alpha]}(\tau) C_j^{[\alpha] *}(\tau)}
\end{aligned}\tag{20}</script><p>Referenceï¼š</p>
<p>D. Marx, J. Hutter, Ab Initio Molecular Dynamics: Basic Theory and Advanced Methods, Cambridge University Press, Cambridge, 20</p>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/22/mc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/22/mc/" class="post-title-link" itemprop="url">Monte Carlo in 2D Ising Model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-11-22 14:44:30" itemprop="dateCreated datePublished" datetime="2022-11-22T14:44:30+08:00">2022-11-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-11-24 17:50:37" itemprop="dateModified" datetime="2022-11-24T17:50:37+08:00">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework </font>

<ul>
<li>consider the 2D classical Ising model on a LÃ—L square lattice with periodic boundary conditions in both directions</li>
</ul>
<script type="math/tex; mode=display">\mathscr{H}=-J \sum_{\langle i, j\rangle} \sigma_i \sigma_j+H \sum_i \sigma_i</script><ul>
<li><p>write a code for the Metropolis algorithm</p>
</li>
<li><p>plot the average energy, average magnetization, specific heat, and magnetic susceptibility as functions of temperature T</p>
</li>
<li><p>explore the scaling behavior near the critical point $T_c=\frac{2 \mathrm{~J}}{\ln (1+\sqrt{2})} \simeq 2.269 \mathrm{~J}$, compare with exact results</p>
</li>
<li><font size = 4.5> A brief summary of theory and algorithm </font>
</li>
<li><p>Monte Carlo simulation</p>
<p>  (1) initialization: choose an initial configuration for the spins</p>
<p>  (2) trial move: we propose a move by randomly choosing a spin and flip it</p>
<p>  (3) acceptation: for a flip ğœ old to ğœ trival , evaluate the number $\Delta E=2 \sigma_j\left(J \sum \sigma_{\text {near }}-H\right)$, then we generate a uniform random number r âˆˆ (0,1), if r &lt; ğ›¼, accept the move, ğœ new = ğœ old</p>
<p>  (4) iteration: then we use ğœ new as the new starting point and go back to (2)</p>
<p>  we proceed with the process for at least 10^5 - 10^6 Monte Carlo steps</p>
</li>
<li><p>2D Ising Model:</p>
<p>  ç³»ç»Ÿå“ˆå¯†é¡¿é‡ï¼š$\mathscr{H}=-J \sum_{\langle i, j\rangle} \sigma_i \sigma_j+H \sum_i \sigma_i$</p>
<p>  é€šå¸¸å¿½ç•¥å¤–åœºä½œç”¨ï¼Œ$H = 0$, ç³»ç»Ÿèƒ½é‡ $<E> =-J \sum_{N} \sum_{\langle i, j\rangle} \sigma_i \sigma_j$</p>
<p>  å¹³å‡èƒ½é‡ï¼š$<e> = <E> / N$</p>
<p>  ç£åŒ–å¼ºåº¦ï¼š $<M> = \sum_{i} s_{i}$</p>
<p>  çƒ­å®¹ï¼š $C=\frac{1}{N T^2}\left(\left\langle E^2\right\rangle-\langle E\rangle^2\right)$</p>
<p>  ç£åŒ–ç‡ ï¼š$\chi=\frac{1}{N T}\left(\left\langle M^2\right\rangle-\langle M\rangle^2\right)=\frac{N}{T}\left(\left\langle m^2\right\rangle-\langle m\rangle^2\right)$</p>
</li>
</ul>
<ul>
<li><p>å…³äºè®¡ç®—å‚æ•°ï¼š</p>
<ul>
<li><p>çƒ­åŒ–æ­¥æ•° Relaxation = 500ï¼Œ è¿­ä»£æ­¥æ•° Iteration = 200000ï¼ˆåœ¨æœ¬åœ°è·‘å¤§çº¦13åˆ†é’Ÿï¼‰</p>
</li>
<li><p>æ¸©åº¦èŒƒå›´ï¼š1 ~ 3.5 Kï¼Œå–ç‚¹é—´éš”ä¸º 0.05 K</p>
</li>
<li><p>å¤§å°åˆ†åˆ«å– L = 10,20,30ï¼Œ å‘¨æœŸæ€§è¾¹ç•Œæ¡ä»¶</p>
</li>
<li><p>de_corr = 3 æ˜¯ä¸ºäº†å‡å°‘æ•°æ®å…³è”æ€§ï¼Œä¸¤æ¬¡æµ‹é‡ä¹‹é—´çš„ç­‰å¾…æ­¥æ•°</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">Tstart = <span class="number">0.85</span>                                           <span class="comment">#èµ·å§‹æ¸©åº¦</span></span><br><span class="line">Tend = <span class="number">3.5</span>                                              <span class="comment">#ç»ˆç‚¹æ¸©åº¦</span></span><br><span class="line">Tstep = <span class="number">0.05</span>                                            <span class="comment">#æ­¥é•¿</span></span><br><span class="line"></span><br><span class="line">J = <span class="number">1</span>                                                   <span class="comment">#Ising model å‚æ•°</span></span><br><span class="line">H = <span class="number">0</span></span><br><span class="line">Tc = <span class="number">2</span>*J / np.log(<span class="number">1</span>+np.sqrt(<span class="number">2</span>))                         <span class="comment"># Tc = 2.269J    </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_state</span>(<span class="params">L</span>):                                    <span class="comment">#è¿”å›ä¸€ä¸ª L*L çš„éšæœºspinæ„å‹</span></span><br><span class="line">    M = np.random.randint(<span class="number">0</span>, <span class="number">2</span>, (L, L)) * <span class="number">2</span> - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> M</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_choose</span>(<span class="params">L</span>):                                   <span class="comment">#åœ¨ L*L Lattice ä¸­éšæœºé€‰ä¸€ä¸ªç‚¹</span></span><br><span class="line">    x = np.random.randint(L)</span><br><span class="line">    y = np.random.randint(L)</span><br><span class="line">    <span class="keyword">return</span> x,y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nn</span>(<span class="params">x,y,L</span>):                                          <span class="comment"># è¿”å› (x,y) æœ€è¿‘é‚»çš„å››ä¸ªç‚¹</span></span><br><span class="line">    <span class="keyword">return</span> (((x-<span class="number">1</span>)%L,y) , (x,(y+<span class="number">1</span>)%L) , ((x+<span class="number">1</span>)%L,y) , (x,(y-<span class="number">1</span>)%L))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">single_point_E</span>(<span class="params">x,y,<span class="built_in">map</span>,s,N</span>):                        <span class="comment"># è¿”å› (x,y) ç‚¹ s è‡ªæ—‹æ„å‹çš„æœ€è¿‘é‚»èƒ½é‡</span></span><br><span class="line">    tmp = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> (xx,yy) <span class="keyword">in</span> nn(x,y,N):</span><br><span class="line">        tmp += <span class="built_in">map</span>[xx][yy]</span><br><span class="line">    <span class="keyword">return</span> s * (-J * tmp + H)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cal_total_E</span>(<span class="params"><span class="built_in">map</span>,N</span>):                                 <span class="comment"># è¿”å› map è‡ªæ—‹æ„å‹çš„æ€»èƒ½é‡</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">            <span class="built_in">sum</span> += single_point_E(i,j,<span class="built_in">map</span>,<span class="built_in">map</span>[i][j],N)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>/<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MC</span>(<span class="params">T,L,MainLoops,RelaxLoops,step,spin</span>):             <span class="comment"># Monte Carlo ä¸»å¾ªç¯</span></span><br><span class="line">    S = L * L</span><br><span class="line">    Q_M = []</span><br><span class="line">    Q_M2 = []</span><br><span class="line">    Q_E = []</span><br><span class="line">    Q_E2 = []</span><br><span class="line">    Etotal = cal_total_E(spin,L)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(MainLoops+RelaxLoops):               <span class="comment">#å¾ªç¯åŒ…æ‹¬ Relax å’Œ Sweep</span></span><br><span class="line"></span><br><span class="line">        x,y = random_choose(L)</span><br><span class="line">        s = spin[x][y]</span><br><span class="line">        curE = single_point_E(x,y,spin,s,L)</span><br><span class="line">        newE = single_point_E(x,y,spin,-s,L)</span><br><span class="line">        deltaE = newE - curE</span><br><span class="line">        alpha = np.exp(- deltaE / T)                    <span class="comment">#è®¡ç®— alpha</span></span><br><span class="line">        <span class="keyword">if</span> deltaE &lt;= <span class="number">0</span>:                                 <span class="comment"># Metropolis ç®—æ³•</span></span><br><span class="line">            spin[x][y] = -spin[x][y]</span><br><span class="line">            Etotal = Etotal + deltaE</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> np.random.random() &lt; alpha:</span><br><span class="line">                spin[x][y] = -spin[x][y]</span><br><span class="line">                Etotal = Etotal + deltaE</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (i &gt; RelaxLoops <span class="keyword">and</span> (i-RelaxLoops)%step == <span class="number">0</span>):       <span class="comment">#å¦‚æœæ˜¯ sweep éƒ¨åˆ†ï¼Œä¸”å‡å°‘æ•°æ®å…³è”æ€§</span></span><br><span class="line">        <span class="comment">#if (i &gt; RelaxLoops):</span></span><br><span class="line">            M = np.<span class="built_in">abs</span>(np.<span class="built_in">sum</span>(spin))</span><br><span class="line">            m = M / S</span><br><span class="line">            m2 = m * m</span><br><span class="line">            Q_M.append(m)</span><br><span class="line">            Q_M2.append(m2)</span><br><span class="line"></span><br><span class="line">            e = Etotal / S</span><br><span class="line">            e2 = e * e</span><br><span class="line">            Q_E.append(e)</span><br><span class="line">            Q_E2.append(e2)</span><br><span class="line"></span><br><span class="line">    M_avg = np.mean(Q_M)</span><br><span class="line">    E_avg = np.mean(Q_E)</span><br><span class="line">    C = (np.mean(Q_E2) - np.mean(Q_E) ** <span class="number">2</span>) / (T ** <span class="number">2</span>)</span><br><span class="line">    X = (np.mean(Q_M2) - np.mean(Q_M) ** <span class="number">2</span>) / T</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> spin,E_avg,M_avg,C * S,X * S                         <span class="comment">#è¿”å› è‡ªé€‰æ„å‹ï¼Œå¹³å‡èƒ½ï¼Œå¹³å‡ç£åŒ–å¼ºåº¦ï¼Œçƒ­å®¹ï¼Œç£åŒ–ç‡</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_results</span>(<span class="params">A</span>):                                            <span class="comment"># ç”»å››ä¸ªç‰©ç†é‡çš„å›¾</span></span><br><span class="line">    plt.figure(figsize = (<span class="number">16</span>,<span class="number">10</span>))</span><br><span class="line">    p1 = plt.subplot(<span class="number">221</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)  </span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;E&gt;&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">1</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">1</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">1</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    p1 = plt.subplot(<span class="number">222</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;M&gt;&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">2</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">2</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">2</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    p1 = plt.subplot(<span class="number">223</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">3</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">3</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">3</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    p1 = plt.subplot(<span class="number">224</span>)</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;T&#x27;</span>)</span><br><span class="line">    plt.ylabel(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">0</span>][<span class="number">0</span>],A[<span class="number">0</span>][<span class="number">4</span>], color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">1</span>][<span class="number">0</span>],A[<span class="number">1</span>][<span class="number">4</span>], color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    p1.scatter(A[<span class="number">2</span>][<span class="number">0</span>],A[<span class="number">2</span>][<span class="number">4</span>], color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.show()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="type">List</span> = [<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>]</span><br><span class="line">    Iteration = <span class="number">200000</span></span><br><span class="line">    <span class="comment">#Iteration = 600000</span></span><br><span class="line">    Relaxation = <span class="number">500</span></span><br><span class="line">    de_corr = <span class="number">3</span></span><br><span class="line">    Ans = []</span><br><span class="line">    <span class="keyword">for</span> L <span class="keyword">in</span> <span class="type">List</span>:</span><br><span class="line">        TList = []</span><br><span class="line">        MList = []</span><br><span class="line">        EList = []</span><br><span class="line">        CList = []</span><br><span class="line">        XList = []</span><br><span class="line">        spin = random_state(L)</span><br><span class="line">        <span class="keyword">for</span> T <span class="keyword">in</span> np.arange(Tstart,Tend,Tstep):</span><br><span class="line">            TList.append(T)</span><br><span class="line">            spin,E,M,C,X = MC(T,L,Iteration,Relaxation,de_corr,spin)</span><br><span class="line">            EList.append(E)</span><br><span class="line">            MList.append(M)</span><br><span class="line">            CList.append(C)</span><br><span class="line">            XList.append(X)</span><br><span class="line">        Ans.append((TList[<span class="number">3</span>:],EList[<span class="number">3</span>:],MList[<span class="number">3</span>:],CList[<span class="number">3</span>:],XList[<span class="number">3</span>:]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;compelete : &quot;</span>+<span class="built_in">str</span>(<span class="built_in">round</span>(L/<span class="number">10</span>))+<span class="string">&quot;/3&quot;</span>)</span><br><span class="line">    draw_results(Ans)  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>compelete : 1/3
compelete : 2/3
compelete : 3/3
</code></pre><ul>
<li><p>å…³äºä¸´ç•ŒæŒ‡æ•°ï¼šè€ƒè™‘ $M\sim|T-T_c|^{\beta}$ å’Œ $\chi \sim |T-T_c|^{-\gamma}$, æˆ‘ä»¬çŸ¥é“ Excat solution æ˜¯ </p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/22/DcelYIoZ4BvPQw8.png style="zoom:70%" />   
  </div>


</li>
</ul>
<pre><code>å–å¯¹æ•°åæ ‡ï¼Œåˆ†åˆ«ç»˜å›¾å¦‚ä¸‹ï¼š
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">draw_exponent_M</span>(<span class="params">A,<span class="type">List</span></span>):                                      <span class="comment"># ç”»ä¸´ç•ŒæŒ‡æ•° : M~|T-Tc|^beta</span></span><br><span class="line">    </span><br><span class="line">    plt.figure(figsize = (<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;|T-Tc|*L&#x27;</span>)  </span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;M&gt;*L^1/8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> M <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">2</span>]:</span><br><span class="line">        Y.append(M * np.power(L,<span class="number">1</span>/<span class="number">8</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>, color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> M <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">2</span>]:</span><br><span class="line">        Y.append(M * np.power(L,<span class="number">1</span>/<span class="number">8</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> M <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">2</span>]:</span><br><span class="line">        Y.append(M * np.power(L,<span class="number">1</span>/<span class="number">8</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    plt.show()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw_exponent_chi</span>(<span class="params">A,<span class="type">List</span></span>):                                      <span class="comment"># ç”»ä¸´ç•ŒæŒ‡æ•° X ~ |T-Tc|^(-gamma)</span></span><br><span class="line">    </span><br><span class="line">    plt.figure(figsize = (<span class="number">8</span>,<span class="number">5</span>))</span><br><span class="line">    plt.xlabel(<span class="string">&#x27;|T-Tc|*L&#x27;</span>)  </span><br><span class="line">    plt.ylabel(<span class="string">&#x27;&lt;X&gt;*L^(-7/4)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> Chi <span class="keyword">in</span> A[<span class="number">0</span>][<span class="number">3</span>]:</span><br><span class="line">        Y.append(Chi * np.power(L,-<span class="number">7</span>/<span class="number">4</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>, color = <span class="string">&quot;r&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=10&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> Chi <span class="keyword">in</span> A[<span class="number">1</span>][<span class="number">3</span>]:</span><br><span class="line">        Y.append(Chi * np.power(L,-<span class="number">7</span>/<span class="number">4</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;b&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=20&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line"></span><br><span class="line">    X = []</span><br><span class="line">    Y = []</span><br><span class="line">    <span class="keyword">for</span> T <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">0</span>]:</span><br><span class="line">        X.append(np.<span class="built_in">abs</span>(T-Tc) * L)</span><br><span class="line">    <span class="keyword">for</span> Chi <span class="keyword">in</span> A[<span class="number">2</span>][<span class="number">3</span>]:</span><br><span class="line">        Y.append(Chi * np.power(L,-<span class="number">7</span>/<span class="number">4</span>))</span><br><span class="line">    plt.loglog(X,Y, <span class="string">&#x27;.&#x27;</span>,color = <span class="string">&quot;g&quot;</span>, marker =<span class="string">&quot;o&quot;</span>, label = <span class="string">&quot;L=30&quot;</span>,alpha=<span class="number">0.45</span>)</span><br><span class="line">    plt.legend()</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">draw_exponent_M(Ans,<span class="type">List</span>) </span><br><span class="line"></span><br><span class="line">draw_exponent_chi(Ans,<span class="type">List</span>) </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p>â€‹    </p>
<ul>
<li><p>å¹³å‡èƒ½ã€ç£åŒ–å¼ºåº¦ã€ç£åŒ–ç‡å’Œçƒ­å®¹å¯¹åº”çš„æ¯”è¾ƒå¥½ï¼Œå¯ä»¥ç¡®å®š Tc çš„èŒƒå›´ï¼Œä½†å—é™äºç®—æ³•çš„å¤æ‚åº¦ï¼Œè¦æƒ³æé«˜ç²¾åº¦åˆ™éœ€è¦æ›´é•¿çš„ Iterationï¼Œæ„å‘³ç€æ›´é•¿çš„è€—æ—¶ã€‚</p>
</li>
<li><p>è¿™é‡Œæˆ‘åœ¨æœ¬åœ°è¿è¡Œ Iteration = 600000(6*10^5)ç»“æœæˆªå›¾å¦‚ä¸‹(å¤§çº¦åŠå°æ—¶)ï¼š</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/24/at3PQCLDpwBOTZM.png style="zoom:60%" />   
  </div>

  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/24/dm5AFZ86Vj12JnW.png style="zoom:50%" />   
  </div>

  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/24/PSXUBoYHsJ5WdFx.png style="zoom:50%" />   
  </div>
</li>
<li><p>å’Œ 1/8 (-7/4) çš„ç²¾ç¡®è§£æ–œç‡ç¬¦åˆå¾—è¾ƒå¥½</p>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/22/HW_itebd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/22/HW_itebd/" class="post-title-link" itemprop="url">3-site iTEBD method</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-11-22 14:32:30 / ä¿®æ”¹æ—¶é—´ï¼š14:32:35" itemprop="dateCreated datePublished" datetime="2022-11-22T14:32:30+08:00">2022-11-22</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework</font>

<ul>
<li>consider the 1D spin model with open boundary condition</li>
</ul>
<script type="math/tex; mode=display">
H=-\sum_j\left(\sigma_{j-1}^z \sigma_j^y \sigma_{j+1}^z+\sigma_j^x\right)</script><ul>
<li><p>write a code for the 3-site iTEBD method</p>
<p>  choose $D_{s} =  6 $, calculate the ground state energy $E$ per site, and the magnetization per site $\left\langle\sigma_i^z\right\rangle$ and $\left\langle\sigma_i^x\right\rangle$</p>
<p>  show the data of entanglement entropy and entanglement spectrum</p>
</li>
</ul>
<font size=3.5> A brief summary of theory and algorithm </font>

<ul>
<li><p>å¯¹äº 3-site çš„ iTEBDï¼Œæœ‰ä¸‰ç§ T å’Œ Gï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼›ä¸åŒé¢œè‰²çš„æ–¹æ¡†è¡¨ç¤ºä¸åŒçš„TGçš„æ¼”åŒ–åˆå¹¶çš„è¿‡ç¨‹ï¼Œå¦‚æ­¤è¿­ä»£</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/22/9hA6bVFf14rXKks.png style="zoom:50%" />   
  </div>
</li>
<li><p>update çš„è¿‡ç¨‹åŒ…å«ä¸¤æ¬¡ SVD åˆ†è§£ï¼Œç¬¬äºŒæ¬¡æ³¨æ„è¦æŠŠ Gm1 ä½œä¸ºç¯å¢ƒä¹˜è¿›å»ï¼š</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/22/CO4zIKdUijMYmEP.png style="zoom:60%" />   
  </div>
</li>
<li><p>ä»£ç å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">3-site iTEBD method</span></span><br><span class="line"><span class="string">1D spin model with OBC</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> numpy.linalg <span class="keyword">as</span> LA</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LAs</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line"><span class="keyword">import</span> Sub180221 <span class="keyword">as</span> Sub</span><br><span class="line"><span class="keyword">import</span> math,copy,pickle</span><br><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> pl</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetHam_3sitespin</span>(<span class="params">Dp</span>):													<span class="comment">#ç”Ÿæˆå“ˆå¯†é¡¿é‡</span></span><br><span class="line">	S0,Sp,Sm,Sz,Sx,Sy = Sub.SpinOper(Dp)</span><br><span class="line">	sz = <span class="number">2</span>* Sz</span><br><span class="line">	sx = <span class="number">2</span>* Sx</span><br><span class="line">	sy = <span class="number">2</span>* Sy</span><br><span class="line">	Ham = - (np.kron(np.kron(sz,sy),sz)) - (np.kron(np.kron(S0,sx),S0))</span><br><span class="line">	Ham = np.reshape(Ham,[Dp,Dp,Dp,Dp,Dp,Dp])</span><br><span class="line">	<span class="keyword">return</span> Ham</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetExpHam</span>(<span class="params">Ham,Tau</span>):														<span class="comment">#ä¹˜æ¼”åŒ–çš„ exp</span></span><br><span class="line">	Dp = np.shape(Ham)[<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> LA.norm(Ham) &lt; <span class="number">1.0e-12</span>:</span><br><span class="line">		UH = np.reshape(np.eye(Dp**<span class="number">3</span>),[Dp,Dp,Dp,Dp,Dp,Dp])</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		A = np.reshape(Ham,[Dp**<span class="number">3</span>,Dp**<span class="number">3</span>])</span><br><span class="line">		V,S,Dc = Sub.SplitEigh(A,Dp**<span class="number">3</span>)</span><br><span class="line">		</span><br><span class="line">		W = np.diag(np.exp(-Tau*S))</span><br><span class="line">		A = np.dot(np.dot(V,W),np.transpose(np.conj(V)))</span><br><span class="line">		UH = np.reshape(A,[Dp,Dp,Dp,Dp,Dp,Dp])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> UH</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitTG</span>(<span class="params">Dp,Ds,kind</span>):														</span><br><span class="line">	T = [<span class="literal">None</span>]*<span class="number">3</span></span><br><span class="line">	G = [<span class="literal">None</span>]*<span class="number">3</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> kind == <span class="string">&#x27;rand&#x27;</span>:</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">			T[i] = np.random.rand(Ds,Dp,Ds)</span><br><span class="line">			G[i] = np.random.rand(Ds)</span><br><span class="line">	<span class="keyword">return</span> T,G</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ImportTG</span>(<span class="params">Ds,Label</span>):</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		File_TG = <span class="built_in">open</span>(<span class="string">&#x27;Tebd&#x27;</span>+Label+<span class="string">&#x27;.pklz&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">		TG = pickle.load(File_TG)</span><br><span class="line">		File_TG.close()</span><br><span class="line">		(T,G) = (TG[<span class="string">&#x27;T&#x27;</span>],TG[<span class="string">&#x27;G&#x27;</span>])</span><br><span class="line">	<span class="keyword">except</span> IOError:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;Missing&#x27;</span>) </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> T,G</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ExportTG</span>(<span class="params">Ds,T,G,Label</span>):</span><br><span class="line">	TG = &#123;<span class="string">&#x27;T&#x27;</span>:T,<span class="string">&#x27;G&#x27;</span>:G&#125;</span><br><span class="line">	File_TG = <span class="built_in">open</span>(<span class="string">&#x27;Tebd&#x27;</span>+Label+<span class="string">&#x27;.pklz&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">	pickle.dump(TG,File_TG)</span><br><span class="line">	File_TG.close()</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mySVD</span>(<span class="params">A,Dcut</span>):</span><br><span class="line">	U,S,V = LA.svd(A)</span><br><span class="line">	U = U[:,:Dcut]</span><br><span class="line">	S = S[:Dcut]</span><br><span class="line">	V = V[:Dcut,:]</span><br><span class="line">	<span class="keyword">return</span> U,S,V</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Evo_Bond</span>(<span class="params">Tl,Tm,Tr,Gll,Gl,Gr,Grr,Ds,UH</span>):									<span class="comment">#update è¿‡ç¨‹ï¼Œåšä¸¤æ¬¡ SVD</span></span><br><span class="line">	A = Sub.NCon([np.diag(Gll),Tl,np.diag(Gl),Tm,np.diag(Gr),Tr,np.diag(Grr),UH],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">7</span>,<span class="number">2</span>],[<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>],[<span class="number">4</span>,<span class="number">5</span>],[<span class="number">5</span>,<span class="number">9</span>,<span class="number">6</span>],[<span class="number">6</span>,-<span class="number">5</span>],[-<span class="number">2</span>,-<span class="number">3</span>,-<span class="number">4</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</span><br><span class="line">	DA = np.shape(A)</span><br><span class="line">	A = Sub.Group(A,[[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]])										<span class="comment">#é‡æ•´æˆä¸€ä¸ªçŸ©é˜µ</span></span><br><span class="line"></span><br><span class="line">	U1,Gm1,V1,Dc1 = Sub.SplitSvd_Lapack(A,Ds,<span class="number">0</span>,prec=<span class="number">1.0e-12</span>)</span><br><span class="line">	Gm1 /= np.sqrt(np.<span class="built_in">sum</span>(Gm1**<span class="number">2</span>))</span><br><span class="line">	U1 = np.reshape(U1,[DA[<span class="number">0</span>],DA[<span class="number">1</span>],Dc1])</span><br><span class="line">	Tl = np.tensordot(np.diag(<span class="number">1.0</span>/Gll),U1,(<span class="number">1</span>,<span class="number">0</span>))							<span class="comment">#å°† Gll è¿˜åŸå‡ºå»</span></span><br><span class="line">	V1 = np.tensordot(np.diag(Gm1),V1,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">	V1 = np.reshape(V1,[<span class="number">12</span>,<span class="number">12</span>])												<span class="comment">#é‡æ•´æˆä¸€ä¸ªçŸ©é˜µ		</span></span><br><span class="line"></span><br><span class="line">	U2,Gm2,V2,Dc2 = Sub.SplitSvd_Lapack(V1,Ds,<span class="number">0</span>,prec=<span class="number">1.0e-12</span>)</span><br><span class="line">	Gm2 /= np.sqrt(np.<span class="built_in">sum</span>(Gm2**<span class="number">2</span>))	</span><br><span class="line">	V2 = np.reshape(V2,[Dc2,DA[<span class="number">3</span>],DA[<span class="number">4</span>]])</span><br><span class="line">	Tr = np.tensordot(V2,np.diag(<span class="number">1.0</span>/Grr),(<span class="number">2</span>,<span class="number">0</span>))							<span class="comment">#å°† Grr è¿˜åŸå‡ºå»</span></span><br><span class="line">	Tm = np.reshape(U2,[DA[<span class="number">0</span>],DA[<span class="number">1</span>],Dc1])</span><br><span class="line">	Tm = np.tensordot(np.diag(<span class="number">1.0</span>/Gm1),Tm,(<span class="number">1</span>,<span class="number">0</span>))							<span class="comment">#å°† Gl è¿˜åŸå‡ºå»</span></span><br><span class="line">	<span class="keyword">return</span> Tl,Tm,Tr,Gm1,Gm2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Evo</span>(<span class="params">Ds,Ham,Tau,Iter,Prec,Label</span>):										<span class="comment">#ä¸»å¾ªç¯</span></span><br><span class="line">	Dp = np.shape(Ham)[<span class="number">0</span>]</span><br><span class="line">	T,G = InitTG(Dp,Ds,<span class="string">&#x27;rand&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	File_Log = <span class="built_in">open</span>(<span class="string">&#x27;Log&#x27;</span>+Label+<span class="string">&#x27;.dat&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	r0 = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> idt <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Tau)):</span><br><span class="line">		dt = Tau[idt]</span><br><span class="line">		UH = GetExpHam(Ham,dt)</span><br><span class="line">		</span><br><span class="line">		G0 = np.ones(<span class="number">3</span>)</span><br><span class="line">		<span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(Iter):</span><br><span class="line">			<span class="keyword">for</span> ib <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">				T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)] =\</span><br><span class="line">				Evo_Bond(T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],G[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],Ds,UH)</span><br><span class="line">			Err = <span class="number">0.0</span></span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">				Err += <span class="built_in">abs</span>(G[i][<span class="number">0</span>]-G0[i])</span><br><span class="line">			<span class="keyword">if</span> np.mod(r,<span class="number">100</span>) == <span class="number">1</span>:</span><br><span class="line">				<span class="comment">#print(r+r0,Err)</span></span><br><span class="line">				File_Log.write(<span class="string">&#x27;%d \t %0.15f \n&#x27;</span> % <span class="built_in">tuple</span>((r+r0,Err)))</span><br><span class="line">				File_Log.flush()</span><br><span class="line">			<span class="keyword">if</span> Err &lt; Prec[idt]:</span><br><span class="line">				r0 += r</span><br><span class="line">				<span class="built_in">print</span>(dt,r+r0,Err)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">				G0[i] = G[i][<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	File_Log.close()</span><br><span class="line">	ExportTG(Ds,T,G,Label)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cal_Bond</span>(<span class="params">Op,Tl,Tm,Tr,Gll,Gl,Gr,Grr</span>):									<span class="comment">#è®¡ç®— &lt;psi|OP|psi&gt;				</span></span><br><span class="line">	A = Sub.NCon([np.diag(Gll),Tl,np.diag(Gl),Tm,np.diag(Gr),Tr,np.diag(Grr)],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">2</span>,<span class="number">2</span>],[<span class="number">2</span>,<span class="number">3</span>],[<span class="number">3</span>,-<span class="number">3</span>,<span class="number">4</span>],[<span class="number">4</span>,<span class="number">5</span>],[<span class="number">5</span>,-<span class="number">4</span>,<span class="number">6</span>],[<span class="number">6</span>,-<span class="number">5</span>]])</span><br><span class="line">	Val = Sub.NCon([A,Op,np.conj(A)],[[<span class="number">7</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">8</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">7</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">8</span>]])</span><br><span class="line">	<span class="keyword">return</span> np.real(Val)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cal_Site</span>(<span class="params">Op,T,Gl,Gr</span>):													<span class="comment"># è®¡ç®—å•ä¸ª site çš„ &lt;site|OP|site&gt;</span></span><br><span class="line">	A = Sub.NCon([np.diag(Gl),T,np.diag(Gr)],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">2</span>,<span class="number">2</span>],[<span class="number">2</span>,-<span class="number">3</span>]])</span><br><span class="line">	Val = Sub.NCon([A,Op,np.conj(A)],[[<span class="number">3</span>,<span class="number">1</span>,<span class="number">4</span>],[<span class="number">2</span>,<span class="number">1</span>],[<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>]])</span><br><span class="line">	<span class="keyword">return</span> np.real(Val)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cal</span>(<span class="params">Ds,Ham,Label</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;***************************************************************************************&quot;</span>)</span><br><span class="line">	T,G = ImportTG(Ds,Label)</span><br><span class="line">	</span><br><span class="line">	D = np.shape(Ham)[<span class="number">0</span>]</span><br><span class="line">	H00 = np.reshape(np.eye(D**<span class="number">3</span>,D**<span class="number">3</span>),[D,D,D,D,D,D])</span><br><span class="line">	S0,Sp,Sm,Sz,Sx,Sy = Sub.SpinOper(D)</span><br><span class="line">	sz = <span class="number">2</span>* Sz</span><br><span class="line">	sx = <span class="number">2</span>* Sx</span><br><span class="line"></span><br><span class="line">	Nom = np.zeros(<span class="number">3</span>)</span><br><span class="line">	Eng = np.zeros(<span class="number">3</span>)</span><br><span class="line">	Mz = np.zeros(<span class="number">3</span>)</span><br><span class="line">	Mx = np.zeros(<span class="number">3</span>)</span><br><span class="line">	EE = []</span><br><span class="line">	ES = []</span><br><span class="line">	avgES = []</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;ib &quot;</span>+<span class="string">&quot; Nom &quot;</span>+<span class="string">&quot; Eng &quot;</span>+<span class="string">&quot; Mag z &quot;</span>+<span class="string">&quot; Mag x &quot;</span>+<span class="string">&quot; entanglement entropy &quot;</span>+<span class="string">&quot; entanglement spectrum &quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> ib <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">		Nom[ib] = Cal_Bond(H00,T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],G[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)])</span><br><span class="line">		Eng[ib] = Cal_Bond(Ham,T[ib],T[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],T[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib],G[np.mod(ib+<span class="number">1</span>,<span class="number">3</span>)],G[np.mod(ib+<span class="number">2</span>,<span class="number">3</span>)])</span><br><span class="line">		Mz[ib] = Cal_Site(sz,T[ib],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib])</span><br><span class="line">		Mx[ib] = Cal_Site(sx,T[ib],G[np.mod(ib-<span class="number">1</span>,<span class="number">3</span>)],G[ib])</span><br><span class="line">		Eng[ib] /= Nom[ib]</span><br><span class="line">		Mz[ib] /= Nom[ib]</span><br><span class="line">		Mx[ib] /= Nom[ib]</span><br><span class="line"></span><br><span class="line">		ES.append(G[ib])</span><br><span class="line">		ln_EV = np.matrix(np.log2(ES[ib]))</span><br><span class="line">		EV = np.matrix(ES[ib])</span><br><span class="line">		EE.append(-np.dot(EV, ln_EV.H))</span><br><span class="line"></span><br><span class="line">		<span class="built_in">print</span>(ib,np.around(Nom[ib],<span class="number">6</span>),np.around(Eng[ib],<span class="number">6</span>),np.around(Mz[ib],<span class="number">7</span>),np.around(Mx[ib],<span class="number">7</span>),EE[ib],ES[ib])</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;***************************************************************************************&quot;</span>)</span><br><span class="line"></span><br><span class="line">	Eng = np.mean(Eng)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;ground E per site:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(Eng)</span><br><span class="line">	</span><br><span class="line">	Mz = np.mean(Mz)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;magnetization z per site:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(Mz)</span><br><span class="line">	Mx = np.mean(Mx)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;magnetization x per site:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(Mx)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;entanglement entropy and entanglement spectrum:&quot;</span>)</span><br><span class="line">	<span class="built_in">print</span>(np.mean(EE))</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">		avgES.append((ES[<span class="number">0</span>][i]+ES[<span class="number">1</span>][i]+ES[<span class="number">2</span>][i])/<span class="number">3</span>)</span><br><span class="line">	<span class="built_in">print</span>(avgES)</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Plot</span>(<span class="params">Ds</span>):</span><br><span class="line">	Label = <span class="string">&#x27;-D&#x27;</span>+<span class="built_in">str</span>(Ds)</span><br><span class="line">	Err = np.loadtxt(<span class="string">&#x27;Log&#x27;</span>+Label+<span class="string">&#x27;.dat&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	fig = pl.figure()</span><br><span class="line">	pl.plot(Err[:,<span class="number">0</span>],np.log(np.<span class="built_in">abs</span>(Err[:,<span class="number">1</span>]))/np.log(<span class="number">10</span>))</span><br><span class="line">	pl.xlabel(<span class="string">&#x27;Iteration&#x27;</span>)</span><br><span class="line">	pl.ylabel(<span class="string">&#x27;Error&#x27;</span>)</span><br><span class="line">	fig.savefig(<span class="string">&#x27;Err&#x27;</span>+Label+<span class="string">&#x27;.pdf&#x27;</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	Ds = <span class="number">6</span></span><br><span class="line">	Dp = <span class="number">2</span></span><br><span class="line">	</span><br><span class="line">	Tau = [<span class="number">0.1</span>,<span class="number">0.01</span>,<span class="number">0.001</span>]</span><br><span class="line">	Iter = <span class="number">100000</span></span><br><span class="line">	Prec = [<span class="number">1.0e-10</span>]*<span class="number">3</span></span><br><span class="line">	Label = <span class="string">&#x27;-D&#x27;</span>+<span class="built_in">str</span>(Ds)</span><br><span class="line">	</span><br><span class="line">	Ham = GetHam_3sitespin(Dp)</span><br><span class="line">	Evo(Ds,Ham,Tau,Iter,Prec,Label)</span><br><span class="line">	Plot(Ds)</span><br><span class="line">	Cal(Ds,Ham,Label)</span><br></pre></td></tr></table></figure>
<pre><code>0.1 5894 9.963463387663296e-11
0.01 29097 9.996781180632297e-11
0.001 102908 9.999789885029031e-11
***************************************************************************************
ib  Nom  Eng  Mag z  Mag x  entanglement entropy  entanglement spectrum 
0 1.0 -1.196414 -0.1612558 0.6107703 [[1.68910627]] [0.88586489 0.42204271 0.16637421 0.08864772 0.03659217 0.0156705 ]
1 1.0 -1.197 -0.1616391 0.6101772 [[1.68961957]] [0.88582456 0.42207902 0.16644626 0.08872146 0.03663422 0.01569149]
2 1.0 -1.197545 0.1614238 0.6104471 [[1.6896294]] [0.88582307 0.42208483 0.16643798 0.0887227  0.0366377  0.01569247]
***************************************************************************************
ground E per site:
-1.196986423260931
magnetization z per site:
-0.05382368800930137
magnetization x per site:
0.6104648847112727
entanglement entropy and entanglement spectrum:
1.6894517483722928
[0.8858375061701803, 0.42206885253163623, 0.1664194864064454, 0.08869729347868575, 0.03662135992053934, 0.01568481868848111]
</code></pre><div  align="center">    
<img src=https://s2.loli.net/2022/11/22/gIfsPoDp6CQYAmw.png style="zoom:50%" />   
</div>

<p>â€‹    </p>
<ul>
<li><p>å°ç»“ï¼š</p>
<ul>
<li><p>åŸºæ€èƒ½é‡çº¦ä¸º -1.197ï¼Œ å’Œä¸Šæ¬¡çš„ ED / MPS ç»“æœåŸºæœ¬ç›¸ç¬¦åˆï¼ˆè€ƒè™‘åˆ°iTEBDæ˜¯Næ— é™å¤§çš„OBCï¼‰ã€‚</p>
</li>
<li><p>sigmaz ç£åŒ–å¼ºåº¦çº¦ä¸º 0 ï¼Œsigmax ç£åŒ–å¼ºåº¦çº¦ä¸º 0.61</p>
</li>
<li><p>çº ç¼ ç†µ(log2)çº¦ä¸º 1.689ï¼Œçº ç¼ è°±æ•°æ®å¦‚ä¸‹ï¼š</p>
<p>  [0.8858375061701803, 0.42206885253163623, 0.1664194864064454, 0.08869729347868575, 0.03662135992053934, 0.01568481868848111]</p>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/13/HW_MPS1107/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/13/HW_MPS1107/" class="post-title-link" itemprop="url">2-site variational MPS method in 1D spin model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-11-13 15:44:30 / ä¿®æ”¹æ—¶é—´ï¼š15:57:08" itemprop="dateCreated datePublished" datetime="2022-11-13T15:44:30+08:00">2022-11-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework </font>

<ul>
<li>read and understand the sample code 1-site variational MPS method</li>
<li>consider the 1D spin model with open boundary condition</li>
</ul>
<script type="math/tex; mode=display">
H=-\sum_j\left(\sigma_{j-1}^z \sigma_j^y \sigma_{j+1}^z+\sigma_j^x\right)</script><ul>
<li><p>write a code for the 2-site variational MPS method</p>
<p>  choose $N = 10$ , $D_{s} = 4 , 6 $, calculate the ground state energy $E$ per site, and the magnetization per site $\left\langle\sigma_i^z\right\rangle$ and $\left\langle\sigma_i^x\right\rangle$</p>
<p>  compare with the results obtained from exact diagonalization</p>
</li>
<li><font size = 4> a brief summary of theory and algorithm </font>

<p>  sample code ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>write Hamiltonian as an MPO</p>
</li>
<li><p>tensor initialization</p>
</li>
<li><p>environment initialization</p>
</li>
<li><p>sweep back and forth to optimize each tensor</p>
<p>å¯¹äºç»™å®šçš„ 1 D spin modelï¼Œæ³¨æ„åˆ°å…¶åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šç›¸é‚»ä¸‰ä½“å’Œå•ä½“ã€‚ï¼ˆé™¤å»ç«¯ç‚¹å¤„ï¼‰æœ‰å¹³ç§»å¯¹ç§°æ€§ï¼ŒMPO å¦‚ä¸‹:</p>
<script type="math/tex; mode=display">
\left(\begin{array}{cccc}
I & -\sigma^{z} & 0 & -\sigma^{x} \\
0 & 0 & \sigma^{y} & 0 \\
0 & 0 & 0 & \sigma^{z} \\
0 & 0 & 0 & I
\end{array}\right)</script><p>ç«¯ç‚¹å¤„ï¼ˆsite0 å’Œ site9ï¼‰çš„ MPO ï¼š</p>
<script type="math/tex; mode=display">
\left(\begin{array}{cccc}
I & 0 & 0 & -\sigma^{x} \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & 0 \\
0 & 0 & 0 & I
\end{array}\right)</script><p>ä¸‹é¢çš„ code ä¸­è¿‘ä¼¼åœ°å¿½ç•¥ç«¯ç‚¹å¤„çš„ MPOï¼Œè¿™ä¸€ç‚¹ä¸åé¢çš„ Exact solution å¯¹æ¯”å¯ä»¥å‘ç°è¿™ç§è¿‘ä¼¼çš„ç²¾åº¦æ˜¯åˆç†çš„ã€‚ </p>
<p>å¼ é‡å’Œç¯å¢ƒçš„åˆå§‹åŒ–å’Œ 1-site çš„ç±»ä¼¼ï¼Œè¿™é‡Œä¸»è¦è®¨è®º 2-site çš„ sweep å¦‚ä½•å®ç°ã€‚</p>
<div  align="center">    
<img src=https://s2.loli.net/2022/11/13/F3gIuawYMWZERi9.png style="zoom:70%" />   
</div>



</li>
</ol>
</li>
</ul>
<p>optimize two sites : ä¸€æ¬¡å°†ä¸¤ä¸ªç›¸é‚»çš„ T ç›¸ä¹˜ï¼Œä½œ SVD åˆ†è§£ã€‚å¯¹äºå‘å³ sweep çš„è¿‡ç¨‹ï¼Œå°†åˆ†è§£å¾—åˆ°çš„ U ä½œä¸ºæ–°çš„ T[i] ï¼Œå¾—åˆ°çš„ S å’Œ V ç›¸ä¹˜ä½œä¸ºæ–°çš„ T[i+1] ï¼Œå¦‚æ­¤ç»§ç»­å¾ªç¯ï¼›å¯¹äºå‘å·¦çš„ sweep è¿‡ç¨‹åŒç†ã€‚ å…¶ä¸­è¦æ³¨æ„çš„æ˜¯åˆ†è§£çš„ Uï¼ŒSï¼ŒV éœ€è¦æ ¹æ®åŸæ¥çš„ T[i] å’Œ T[i+1] ä¹‹é—´è€¦åˆçš„ç»´åº¦ Dcut åšæˆªæ–­ã€‚</p>
<p>code ä¸­ NCon çš„ index å¯¹åº”å¦‚ä¸‹ï¼š</p>
<div  align="center">    
<img src=https://s2.loli.net/2022/11/13/YagrZSJl45khiX2.jpg style="zoom:30%" />   
</div>    


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> numpy.linalg <span class="keyword">as</span> LA</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LAs</span><br><span class="line"><span class="keyword">import</span> Sub180221 <span class="keyword">as</span> Sub</span><br><span class="line"><span class="keyword">import</span> math,copy</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Mi =</span></span><br><span class="line"><span class="string">s0	-sz	0	-sx</span></span><br><span class="line"><span class="string">0	0	sy	0</span></span><br><span class="line"><span class="string">0	0	0	sz</span></span><br><span class="line"><span class="string">0	0	0	s0</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GetMpo_Heisenberg_Obc</span>(<span class="params">Dp</span>):									<span class="comment">#ç”Ÿæˆ MPO</span></span><br><span class="line">	S0,Sp,Sm,Sz,Sx,Sy = Sub.SpinOper(Dp)</span><br><span class="line">	</span><br><span class="line">	Dmpo = <span class="number">4</span></span><br><span class="line">	Mpo = np.zeros((Dmpo,Dp,Dmpo,Dp),dtype = <span class="built_in">complex</span>)</span><br><span class="line">	</span><br><span class="line">	Mpo[<span class="number">0</span>,:,<span class="number">0</span>,:] = S0</span><br><span class="line">	Mpo[<span class="number">0</span>,:,<span class="number">1</span>,:] = -<span class="number">2</span> * Sz</span><br><span class="line">	Mpo[<span class="number">0</span>,:,<span class="number">3</span>,:] = -<span class="number">2</span> * Sx</span><br><span class="line">	Mpo[<span class="number">1</span>,:,<span class="number">2</span>,:] = <span class="number">2</span> * Sy</span><br><span class="line">	Mpo[<span class="number">2</span>,:,<span class="number">3</span>,:] = <span class="number">2</span> * Sz</span><br><span class="line">	Mpo[<span class="number">3</span>,:,<span class="number">3</span>,:] = S0</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Mpo</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitMps</span>(<span class="params">Ns,Dp,Ds</span>):											<span class="comment">#åˆå§‹åŒ– MPS</span></span><br><span class="line">	T = [<span class="literal">None</span>]*Ns</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns):</span><br><span class="line">		Dl = <span class="built_in">min</span>(Dp**i,Dp**(Ns-i),Ds)</span><br><span class="line">		Dr = <span class="built_in">min</span>(Dp**(i+<span class="number">1</span>),Dp**(Ns-<span class="number">1</span>-i),Ds)</span><br><span class="line">		T[i] = np.random.rand(Dl,Dp,Dr)</span><br><span class="line">	U = np.eye(np.shape(T[-<span class="number">1</span>])[-<span class="number">1</span>])</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">		U,T[i] = Sub.Mps_LQP(T[i],U)</span><br><span class="line">	<span class="keyword">return</span> T</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">InitH</span>(<span class="params">Mpo,T</span>):												<span class="comment">#åˆå§‹åŒ–ç¯å¢ƒ HL HR</span></span><br><span class="line">	Ns = <span class="built_in">len</span>(T)</span><br><span class="line">	Dmpo = np.shape(Mpo)[<span class="number">0</span>]</span><br><span class="line">	HL = [<span class="literal">None</span>]*Ns</span><br><span class="line">	HR = [<span class="literal">None</span>]*Ns</span><br><span class="line">	HL[<span class="number">0</span>] = np.zeros((<span class="number">1</span>,Dmpo,<span class="number">1</span>))</span><br><span class="line">	HL[<span class="number">0</span>][<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>] = <span class="number">1.0</span></span><br><span class="line">	HR[-<span class="number">1</span>] = np.zeros((<span class="number">1</span>,Dmpo,<span class="number">1</span>))</span><br><span class="line">	HR[-<span class="number">1</span>][<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>] = <span class="number">1.0</span></span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):</span><br><span class="line">		HR[i-<span class="number">1</span>] = Sub.NCon([HR[i],T[i],Mpo,np.conj(T[i])],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],[-<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>],[-<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[-<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">	<span class="keyword">return</span> HL,HR</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OptTSite</span>(<span class="params">Mpo,HL,HR,T,Method=<span class="number">0</span></span>):								<span class="comment">#2-siteçš„ OptTSiteï¼Œè¿™é‡Œçš„ T å…¶å®æ˜¯ç›¸é‚»ä¸¤ä¸ª site çš„ T çš„ç§¯</span></span><br><span class="line">	DT = np.shape(T)</span><br><span class="line">	<span class="keyword">if</span> Method == <span class="number">0</span>:</span><br><span class="line">		A = Sub.NCon([HL,Mpo,Mpo,HR],[[-<span class="number">1</span>,<span class="number">1</span>,-<span class="number">5</span>],[<span class="number">1</span>,-<span class="number">6</span>,<span class="number">2</span>,-<span class="number">2</span>],[<span class="number">2</span>,-<span class="number">7</span>,<span class="number">3</span>,-<span class="number">3</span>],[-<span class="number">8</span>,<span class="number">3</span>,-<span class="number">4</span>]])</span><br><span class="line">		A = Sub.Group(A,[[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>]])</span><br><span class="line">		Eig,V = LAs.eigsh(A,k=<span class="number">1</span>,which=<span class="string">&#x27;SA&#x27;</span>)</span><br><span class="line">		T = np.reshape(V,(DT[<span class="number">0</span>]*DT[<span class="number">1</span>],DT[<span class="number">2</span>]*DT[<span class="number">3</span>]))        		<span class="comment">#V reshape æˆå››é˜¶å¼ é‡ T</span></span><br><span class="line">	<span class="keyword">return</span> T,Eig</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OptT</span>(<span class="params">Mpo,HL,HR,T</span>):</span><br><span class="line">	Ns = <span class="built_in">len</span>(T)</span><br><span class="line">	Eng0 = np.zeros(Ns)</span><br><span class="line">	Eng1 = np.zeros(Ns)</span><br><span class="line">	<span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">		<span class="built_in">print</span>(r)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>):									<span class="comment"># å‘å³ sweep</span></span><br><span class="line">			temp,Eng1[i] = OptTSite(Mpo,HL[i],HR[i+<span class="number">1</span>],np.tensordot(T[i],T[i+<span class="number">1</span>],(<span class="number">2</span>,<span class="number">0</span>)),Method=<span class="number">0</span>)	<span class="comment">#T[i]*T[i+1]ä½œä¸ºæ–°çš„å¼ é‡ä¼ è¿‡å»</span></span><br><span class="line">			Dcut = np.shape(T[i])[<span class="number">2</span>]								<span class="comment"># Dcut æ˜¯æˆªæ–­ç»´æ•°</span></span><br><span class="line">			U,S,V = LA.svd(temp,full_matrices=<span class="number">0</span>)</span><br><span class="line">			U = U[:,<span class="number">0</span>:Dcut]</span><br><span class="line">			S = S[<span class="number">0</span>:Dcut]</span><br><span class="line">			V = V[<span class="number">0</span>:Dcut,:]</span><br><span class="line">			T[i] = np.reshape(U,np.shape(T[i]))					<span class="comment">#æ›´æ–° T[i],T[i+1],HL[i+1]</span></span><br><span class="line">			SV = np.dot(np.diag(S),V)</span><br><span class="line">			T[i+<span class="number">1</span>] = np.reshape(SV,np.shape(T[i+<span class="number">1</span>]))</span><br><span class="line">			HL[i+<span class="number">1</span>] = Sub.NCon([HL[i],np.conj(T[i]),Mpo,T[i]],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],[<span class="number">1</span>,<span class="number">2</span>,-<span class="number">1</span>],[<span class="number">3</span>,<span class="number">4</span>,-<span class="number">2</span>,<span class="number">2</span>],[<span class="number">5</span>,<span class="number">4</span>,-<span class="number">3</span>]])</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>,<span class="number">0</span>,-<span class="number">1</span>):								<span class="comment"># å‘å·¦ sweep</span></span><br><span class="line">			temp,Eng1[i] = OptTSite(Mpo,HL[i-<span class="number">1</span>],HR[i],np.tensordot(T[i-<span class="number">1</span>],T[i],(<span class="number">2</span>,<span class="number">0</span>)),Method=<span class="number">0</span>)	<span class="comment">#T[i-1]*T[i]ä½œä¸ºæ–°çš„å¼ é‡ä¼ è¿‡å»</span></span><br><span class="line">			Dcut = np.shape(T[i])[<span class="number">0</span>]								<span class="comment"># Dcut æ˜¯æˆªæ–­ç»´æ•°</span></span><br><span class="line">			U,S,V = LA.svd(temp,full_matrices=<span class="number">0</span>)</span><br><span class="line">			U = U[:,<span class="number">0</span>:Dcut]</span><br><span class="line">			S = S[<span class="number">0</span>:Dcut]</span><br><span class="line">			V = V[<span class="number">0</span>:Dcut,:]</span><br><span class="line">			T[i] = np.reshape(V,np.shape(T[i]))					<span class="comment">#æ›´æ–° T[i],T[i-1],HR[i-1]</span></span><br><span class="line">			US = np.dot(U,np.diag(S))</span><br><span class="line">			T[i-<span class="number">1</span>] = np.reshape(US,np.shape(T[i-<span class="number">1</span>]))</span><br><span class="line">			HR[i-<span class="number">1</span>] = Sub.NCon([HR[i],T[i],Mpo,np.conj(T[i])],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],[-<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>],[-<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[-<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]])</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(Eng1)</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">abs</span>(Eng1[<span class="number">1</span>]-Eng0[<span class="number">1</span>]) &lt; <span class="number">1.0e-7</span>:</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		Eng0 = copy.copy(Eng1)</span><br><span class="line">	<span class="built_in">print</span>(Eng1/<span class="built_in">float</span>(Ns))</span><br><span class="line">	<span class="keyword">return</span> T,Eng1/<span class="built_in">float</span>(Ns)</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	Ns = <span class="number">10</span></span><br><span class="line">	Dp = <span class="number">2</span></span><br><span class="line">	Ds = [<span class="number">4</span>,<span class="number">6</span>]</span><br><span class="line">	Answer = []</span><br><span class="line"></span><br><span class="line">	Mpo = GetMpo_Heisenberg_Obc(Dp)</span><br><span class="line">	<span class="keyword">for</span> ds <span class="keyword">in</span> Ds:</span><br><span class="line">		T = InitMps(Ns,Dp,ds)</span><br><span class="line">		HL,HR = InitH(Mpo,T)</span><br><span class="line">		T,E= OptT(Mpo,HL,HR,T)</span><br><span class="line">		GS = T[<span class="number">0</span>]</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns-<span class="number">1</span>):</span><br><span class="line">			GS = np.tensordot(GS,T[i+<span class="number">1</span>],(i+<span class="number">2</span>,<span class="number">0</span>))</span><br><span class="line">		GS = np.reshape(GS,(<span class="number">1024</span>,<span class="number">1</span>))</span><br><span class="line">		Answer.append((ds,E,GS))</span><br></pre></td></tr></table></figure>
<pre><code>0
[ -9.94119199 -11.48599436 -11.48599436 -11.48641231 -11.48638648
 -11.48628296 -11.4859645  -11.48480444 -11.4844155  -11.4844155 ]
1
[-11.48599436 -11.48597508 -11.48597508 -11.48639425 -11.48660135
 -11.48666644 -11.48660205 -11.48639534 -11.48597623 -11.48597623]
2
[-11.48597508 -11.48597502 -11.48597502 -11.4863942  -11.48660113
 -11.48666585 -11.48660113 -11.4863942  -11.48597503 -11.48597503]
[-1.14859751 -1.1485975  -1.1485975  -1.14863942 -1.14866011 -1.14866659
 -1.14866011 -1.14863942 -1.1485975  -1.1485975 ]
0
[-10.09613213 -11.48870684 -11.48870684 -11.48878776 -11.4888277
 -11.48872879 -11.48838718 -11.48821485 -11.48813509 -11.48813509]
1
[-11.48870684 -11.48870695 -11.48870695 -11.48878788 -11.48886592
 -11.48888725 -11.48886592 -11.48878788 -11.48870695 -11.48870695]
2
[-11.48870695 -11.48870695 -11.48870695 -11.48878788 -11.48886592
 -11.48888725 -11.48886592 -11.48878788 -11.48870695 -11.48870695]
[-1.14887069 -1.14887069 -1.14887069 -1.14887879 -1.14888659 -1.14888873
 -1.14888659 -1.14887879 -1.14887069 -1.14887069]
</code></pre><ul>
<li><p>è¿™é‡Œçš„åˆ—è¡¨ Answer = [(ds,E,GS)] åˆ†åˆ«å‚¨å­˜çš„æˆªæ–­ Dsï¼ŒåŸºæ€èƒ½é‡ per site Eï¼Œä»¥åŠ groud state GSã€‚ </p>
</li>
<li><p>ä¸‹é¢è®¡ç®— $D_{s} = 4 , 6 $ æƒ…å†µä¸‹çš„ ï¼š 1. ground state energy $E$ per siteï¼› 2. magnetization per site $\left\langle\sigma_i^z\right\rangle$ and $\left\langle\sigma_i^x\right\rangle$</p>
</li>
<li><p>å…ˆå®šä¹‰è®¡ç®—ç£åŒ–å¼ºåº¦çš„ mag_x å’Œ mag_z å‡½æ•°ï¼š</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">FlipBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> i^(<span class="number">1</span>&lt;&lt;n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReadBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (i&amp;(<span class="number">1</span>&lt;&lt;n))&gt;&gt;n</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mag_z</span>(<span class="params">W</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;z:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns):</span><br><span class="line">        SzW = np.zeros(<span class="number">1024</span>,dtype = <span class="built_in">complex</span>)</span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        n = <span class="number">1</span>&lt;&lt;Ns</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            sign = <span class="number">1</span> <span class="keyword">if</span> ReadBit(state, i) == <span class="number">1</span> <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">            SzW[state] = sign * W[state]</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            res = res + np.conj(W)[state] * SzW[state]</span><br><span class="line">        <span class="built_in">print</span>(i,np.real(res))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mag_x</span>(<span class="params">W</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;x:&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Ns):</span><br><span class="line">        SxW = np.zeros(<span class="number">1024</span>,dtype = <span class="built_in">complex</span>)</span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        n = <span class="number">1</span>&lt;&lt;Ns</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            SxW[FlipBit(state,i)] =  W[state]</span><br><span class="line">        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            res = res + np.conj(W)[state] * SxW[state]</span><br><span class="line">        <span class="built_in">print</span>(i,np.real(res))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>å¯¹äº Ds = 4ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ds=&quot;</span>+<span class="built_in">str</span>(Answer[<span class="number">0</span>][<span class="number">0</span>])+<span class="string">&quot;:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ground state energy E per site:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(Answer[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:&quot;</span>)</span><br><span class="line">mag_z(Answer[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">mag_x(Answer[<span class="number">0</span>][<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<pre><code>Ds=4:
ground state energy E per site:
[-1.14859751 -1.1485975  -1.1485975  -1.14863942 -1.14866011 -1.14866659
 -1.14866011 -1.14863942 -1.1485975  -1.1485975 ]
magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:
z:
0 [7.21557529e-09]
1 [-9.58418942e-09]
2 [-5.03324422e-09]
3 [2.40059455e-09]
4 [-1.82414969e-09]
5 [-2.32618917e-09]
6 [1.5960039e-09]
7 [-2.92614971e-09]
8 [-2.37970759e-09]
9 [1.22052863e-09]
x:
0 [0.9173015]
1 [0.84768239]
2 [0.78414904]
3 [0.7604599]
4 [0.75185056]
5 [0.75202071]
6 [0.76080662]
7 [0.78431687]
8 [0.84831043]
9 [0.91792175]
</code></pre><ul>
<li>å¯¹äº Ds = 6:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Ds=&quot;</span>+<span class="built_in">str</span>(Answer[<span class="number">1</span>][<span class="number">0</span>])+<span class="string">&quot;:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;ground state energy E per site:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(Answer[<span class="number">1</span>][<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:&quot;</span>)</span><br><span class="line">mag_z(Answer[<span class="number">1</span>][<span class="number">2</span>])</span><br><span class="line">mag_x(Answer[<span class="number">1</span>][<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<pre><code>Ds=6:
ground state energy E per site:
[-1.14887069 -1.14887069 -1.14887069 -1.14887879 -1.14888659 -1.14888873
 -1.14888659 -1.14887879 -1.14887069 -1.14887069]
magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:
z:
0 [-1.43079909e-10]
1 [1.24069037e-08]
2 [-6.39897362e-09]
3 [-8.64023536e-10]
4 [9.2880419e-09]
5 [-3.83658105e-09]
6 [-9.85073963e-10]
7 [8.11689286e-09]
8 [-2.77860332e-09]
9 [-2.90920866e-10]
x:
0 [0.91675276]
1 [0.84696303]
2 [0.78332349]
3 [0.76008148]
4 [0.75169612]
5 [0.75168807]
6 [0.76005655]
7 [0.78330731]
8 [0.84695633]
9 [0.91675164]
</code></pre><ul>
<li><p>å¯è§ z æ–¹å‘ magnetization çº¦ä¸ºé›¶ï¼Œ x æ–¹å‘ä¸Šæœ‰æ­£çš„ magnetizationï¼Œåœ¨ä¸¤è¾¹çš„è¾¹ç•Œå¤„ç•¥å¤§äºä¸­é—´ã€‚</p>
</li>
<li><p>ä½œä¸ºå¯¹æ¯”ï¼Œè¯¥é—®é¢˜çš„ç²¾ç¡®è§£å¦‚ä¸‹ï¼š</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Exact diagonalization Solution</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LA</span><br><span class="line"></span><br><span class="line">N = <span class="number">10</span></span><br><span class="line">n = <span class="number">1</span>&lt;&lt;N</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FlipBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> i^(<span class="number">1</span>&lt;&lt;n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReadBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (i&amp;(<span class="number">1</span>&lt;&lt;n))&gt;&gt;n</span><br><span class="line"></span><br><span class="line">H = np.zeros([n,n], dtype = <span class="built_in">complex</span>)</span><br><span class="line"><span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        res = FlipBit(state, j)</span><br><span class="line">        H[state][res] += -<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,N-<span class="number">1</span>):</span><br><span class="line">        flag = ReadBit(state, j+<span class="number">1</span>) + ReadBit(state, j) + ReadBit(state, j-<span class="number">1</span>)</span><br><span class="line">        sign = <span class="number">1</span> <span class="keyword">if</span> flag % <span class="number">2</span> == <span class="number">1</span> <span class="keyword">else</span> -<span class="number">1</span></span><br><span class="line">        res = FlipBit(state, j)</span><br><span class="line">        H[state][res] += -<span class="number">1.0j</span> * sign</span><br><span class="line">E,eigenV = LA.eigsh(H,<span class="number">1</span>,which = <span class="string">&#x27;SA&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;exact ground state energy E per site:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(E[<span class="number">0</span>]/N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:&quot;</span>)</span><br><span class="line">mag_z(eigenV)</span><br><span class="line">mag_x(eigenV)</span><br></pre></td></tr></table></figure>
<pre><code>exact ground state energy E per site:
-1.1489442065958528
magnetization per site &lt;sigma^z&gt; and &lt;sigma^x&gt;:
z:
0 [-4.02022166e-16]
1 [-1.9246757e-15]
2 [2.60815675e-15]
3 [-3.47812057e-16]
4 [-2.47631776e-15]
5 [3.13724741e-15]
6 [-3.0444397e-16]
7 [-2.10855639e-15]
8 [2.42948023e-15]
9 [-3.0444397e-16]
x:
0 [0.91622482]
1 [0.84621457]
2 [0.78255915]
3 [0.75946665]
4 [0.75122694]
5 [0.75122694]
6 [0.75946665]
7 [0.78255915]
8 [0.84621457]
9 [0.91622482]
</code></pre><ul>
<li><p>æœ€åæŠŠç»“æœæ”¾åœ¨è¿™é‡Œæ–¹ä¾¿å¯¹æ¯”ï¼š</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/13/DFUErtflWHhb3Lv.png style="zoom:60%" />  
  <img src=https://s2.loli.net/2022/11/13/BIuGqLTzptO3yr6.png style="zoom:60%" /> 
  <img src=https://s2.loli.net/2022/11/13/JKEgYBLitGrQ2eS.png style="zoom:65%" />  
  </div>



</li>
</ul>
<ul>
<li><p>æ³¨ï¼šSub180221.py:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Copyright:</span></span><br><span class="line"><span class="string">Shuo Yang, shuoyang@tsinghua.edu.cn</span></span><br><span class="line"><span class="string">Nov 1, 2021, Tsinghua, Beijing, China</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> numpy.linalg <span class="keyword">as</span> LA</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LAs</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> linalg</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Group</span>(<span class="params">A,shapeA</span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; transpose + reshape &quot;&quot;&quot;</span></span><br><span class="line">	dimA = np.asarray(np.shape(A))</span><br><span class="line">	rankA = <span class="built_in">len</span>(shapeA)</span><br><span class="line">	</span><br><span class="line">	shapeB = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,rankA):</span><br><span class="line">		shapeB += [np.prod(dimA[shapeA[i]])]</span><br><span class="line">	</span><br><span class="line">	orderB = <span class="built_in">sum</span>(shapeA,[])</span><br><span class="line">	A = np.reshape(np.transpose(A,orderB),shapeB)</span><br><span class="line">	<span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">NCon</span>(<span class="params">Tensor,Index</span>):</span><br><span class="line">	ConList = <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">max</span>(<span class="built_in">sum</span>(Index,[]))+<span class="number">1</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="built_in">len</span>(ConList) &gt; <span class="number">0</span>:</span><br><span class="line">	</span><br><span class="line">		Icon = []</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(Index)):</span><br><span class="line">			<span class="keyword">if</span> ConList[<span class="number">0</span>] <span class="keyword">in</span> Index[i]:</span><br><span class="line">				Icon.append(i)</span><br><span class="line">				<span class="keyword">if</span> <span class="built_in">len</span>(Icon) == <span class="number">2</span>:</span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> <span class="built_in">len</span>(Icon) == <span class="number">1</span>:</span><br><span class="line">			IndCommon = <span class="built_in">list</span>(<span class="built_in">set</span>([x <span class="keyword">for</span> x <span class="keyword">in</span> Index[Icon[<span class="number">0</span>]] <span class="keyword">if</span> Index[Icon[<span class="number">0</span>]].count(x)&gt;<span class="number">1</span>]))</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span> icom <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IndCommon)):</span><br><span class="line">				Pos = <span class="built_in">sorted</span>([i <span class="keyword">for</span> i,x <span class="keyword">in</span> <span class="built_in">enumerate</span>(Index[Icon[<span class="number">0</span>]]) <span class="keyword">if</span> x==IndCommon[icom]])</span><br><span class="line">				Tensor[Icon[<span class="number">0</span>]] = np.trace(Tensor[Icon[<span class="number">0</span>]],axis1=Pos[<span class="number">0</span>],axis2=Pos[<span class="number">1</span>])</span><br><span class="line">				Index[Icon[<span class="number">0</span>]].pop(Pos[<span class="number">1</span>])</span><br><span class="line">				Index[Icon[<span class="number">0</span>]].pop(Pos[<span class="number">0</span>])</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			IndCommon = <span class="built_in">list</span>(<span class="built_in">set</span>(Index[Icon[<span class="number">0</span>]]) &amp; <span class="built_in">set</span>(Index[Icon[<span class="number">1</span>]]))		</span><br><span class="line">			Pos = [[],[]]</span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">				<span class="keyword">for</span> ind <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IndCommon)):</span><br><span class="line">					Pos[i].append(Index[Icon[i]].index(IndCommon[ind]))</span><br><span class="line">			A = np.tensordot(Tensor[Icon[<span class="number">0</span>]],Tensor[Icon[<span class="number">1</span>]],(Pos[<span class="number">0</span>],Pos[<span class="number">1</span>]))</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">				<span class="keyword">for</span> ind <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(IndCommon)):</span><br><span class="line">					Index[Icon[i]].remove(IndCommon[ind])</span><br><span class="line">			Index[Icon[<span class="number">0</span>]] = Index[Icon[<span class="number">0</span>]]+Index[Icon[<span class="number">1</span>]]</span><br><span class="line">			Index.pop(Icon[<span class="number">1</span>])</span><br><span class="line">			Tensor[Icon[<span class="number">0</span>]] = A</span><br><span class="line">			Tensor.pop(Icon[<span class="number">1</span>])</span><br><span class="line">		</span><br><span class="line">		ConList = <span class="built_in">list</span>(<span class="built_in">set</span>(ConList)^<span class="built_in">set</span>(IndCommon))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="built_in">len</span>(Index) &gt; <span class="number">1</span>:</span><br><span class="line">		</span><br><span class="line">		Tensor[<span class="number">0</span>] = np.multiply.outer(Tensor[<span class="number">0</span>],Tensor[<span class="number">1</span>])</span><br><span class="line">		Tensor.pop(<span class="number">1</span>)</span><br><span class="line">		Index[<span class="number">0</span>] = Index[<span class="number">0</span>]+Index[<span class="number">1</span>]</span><br><span class="line">		Index.pop(<span class="number">1</span>)</span><br><span class="line">	</span><br><span class="line">	Index = Index[<span class="number">0</span>]</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(Index) &gt; <span class="number">0</span>:</span><br><span class="line">		Order = <span class="built_in">sorted</span>(<span class="built_in">range</span>(<span class="built_in">len</span>(Index)),key=<span class="keyword">lambda</span> k:Index[k])[::-<span class="number">1</span>]	</span><br><span class="line">		Tensor = np.transpose(Tensor[<span class="number">0</span>],Order)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		Tensor = Tensor[<span class="number">0</span>]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Tensor</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SpinOper</span>(<span class="params">ss</span>):</span><br><span class="line">	spin = (ss-<span class="number">1</span>)/<span class="number">2.0</span></span><br><span class="line">	dz = np.zeros(ss)</span><br><span class="line">	mp = np.zeros(ss-<span class="number">1</span>)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ss):</span><br><span class="line">		dz[i] = spin-i</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ss-<span class="number">1</span>):</span><br><span class="line">		mp[i] = np.sqrt((<span class="number">2</span>*spin-i)*(i+<span class="number">1</span>))</span><br><span class="line">	</span><br><span class="line">	S0 = np.eye(ss)</span><br><span class="line">	Sp = np.diag(mp,<span class="number">1</span>)</span><br><span class="line">	Sm = np.diag(mp,-<span class="number">1</span>)</span><br><span class="line">	Sx = <span class="number">0.5</span>*(Sp+Sm)</span><br><span class="line">	Sy = -<span class="number">0.5j</span>*(Sp-Sm)</span><br><span class="line">	Sz = np.diag(dz)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> S0,Sp,Sm,Sz,Sx,Sy</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OutputT</span>(<span class="params">T,prec=<span class="number">1.0e-10</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; output nonzero elements &quot;&quot;&quot;</span></span><br><span class="line">	pos = np.nonzero(np.<span class="built_in">abs</span>(T)&gt;prec)</span><br><span class="line">	val = T[pos]</span><br><span class="line">	pos = np.transpose(pos)</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(val)):</span><br><span class="line">		<span class="built_in">print</span>(pos[i],val[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OutputTFile</span>(<span class="params">file,T,prec=<span class="number">1.0e-10</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; output nonzero elements to file &quot;&quot;&quot;</span></span><br><span class="line">	pos = np.nonzero(np.<span class="built_in">abs</span>(T)&gt;prec)</span><br><span class="line">	val = T[pos]</span><br><span class="line">	pos = np.transpose(pos)</span><br><span class="line">	val = np.reshape(val,[<span class="built_in">len</span>(val),<span class="number">1</span>])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> LA.norm(np.imag(T)) &gt; prec:</span><br><span class="line">		out = np.concatenate((pos+<span class="number">1</span>,np.real(val),np.imag(val)),axis=<span class="number">1</span>)</span><br><span class="line">		np.savetxt(file,out,fmt = <span class="string">&#x27;%d\t&#x27;</span>*np.shape(pos)[<span class="number">1</span>] + <span class="string">&#x27;%0.6f \t %0.6f&#x27;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		out = np.concatenate((pos,np.real(val)),axis=<span class="number">1</span>)</span><br><span class="line">		np.savetxt(file,out,fmt = <span class="string">&#x27;%d\t&#x27;</span>*np.shape(pos)[<span class="number">1</span>] + <span class="string">&#x27;%0.6f&#x27;</span>)</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SplitEig</span>(<span class="params">A,Dcut,prec=<span class="number">1.0e-12</span>,safe=<span class="number">3</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; Eig, Lapack + Arpack &quot;&quot;&quot;</span></span><br><span class="line">	D = np.<span class="built_in">min</span>(np.shape(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Dcut &gt;= D-<span class="number">1</span>:</span><br><span class="line">		S,V = LA.eig(A)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		k_ask = <span class="built_in">min</span>(Dcut+safe,D-<span class="number">2</span>)</span><br><span class="line">		S,V = LAs.eigs(A,k=k_ask)</span><br><span class="line">	</span><br><span class="line">	idx = np.isfinite(S)</span><br><span class="line">	<span class="keyword">if</span> idx.<span class="built_in">any</span>() != <span class="literal">False</span>:</span><br><span class="line">		S = S[idx]</span><br><span class="line">		V = V[:,idx]</span><br><span class="line">	order = np.argsort(<span class="built_in">abs</span>(S))[::-<span class="number">1</span>]</span><br><span class="line">	S = S[order]</span><br><span class="line">	V = V[:,order]</span><br><span class="line">	</span><br><span class="line">	S = S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&gt;prec]</span><br><span class="line">	Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">	S = S[:Dc]</span><br><span class="line">	V = V[:,:Dc]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> V,S,Dc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SplitEigh</span>(<span class="params">A,Dcut,mode=<span class="string">&#x27;P&#x27;</span>,prec=<span class="number">1.0e-12</span>,safe=<span class="number">3</span>,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; Eig, Hermitian, Lapack + Arpack &quot;&quot;&quot;</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot; P = perserve, C = cut &quot;&quot;&quot;</span></span><br><span class="line">	D = np.<span class="built_in">min</span>(np.shape(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Dcut &gt;= D-<span class="number">1</span>:</span><br><span class="line">		S,V = LA.eigh(A)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		k_ask = <span class="built_in">min</span>(Dcut+safe,D-<span class="number">2</span>)</span><br><span class="line">		S,V = LAs.eigsh(A,k=k_ask)</span><br><span class="line">	</span><br><span class="line">	idx = np.isfinite(S)</span><br><span class="line">	<span class="keyword">if</span> idx.<span class="built_in">any</span>() != <span class="literal">False</span>:</span><br><span class="line">		S = S[idx]</span><br><span class="line">		V = V[:,idx]</span><br><span class="line">	order = np.argsort(<span class="built_in">abs</span>(S))[::-<span class="number">1</span>]</span><br><span class="line">	S = S[order]</span><br><span class="line">	V = V[:,order]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;P&#x27;</span>:</span><br><span class="line">		S = S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&gt;<span class="number">1.0e-15</span>]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		V = V[:,:Dc]</span><br><span class="line">		S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&lt;prec] = prec*np.sign(S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&lt;prec])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">		S = S[<span class="built_in">abs</span>(S/S[<span class="number">0</span>])&gt;prec]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		V = V[:,:Dc]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(np.dot(V,np.dot(np.diag(S),np.transpose(np.conj(V))))-A)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> V,S,Dc</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">SplitSvd_Lapack</span>(<span class="params">A,Dcut,iweight,mode=<span class="string">&#x27;P&#x27;</span>,prec=<span class="number">1.0e-12</span>,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; SVD, Lapack only &quot;&quot;&quot;</span></span><br><span class="line">	<span class="string">&quot;&quot;&quot; P = perserve, C = cut &quot;&quot;&quot;</span></span><br><span class="line">	</span><br><span class="line">	U,S,V = LA.svd(A,full_matrices=<span class="number">0</span>)</span><br><span class="line">	</span><br><span class="line">	S = np.<span class="built_in">abs</span>(S)</span><br><span class="line">	idx = np.isfinite(S)</span><br><span class="line">	<span class="keyword">if</span> idx.<span class="built_in">any</span>() != <span class="literal">False</span>:</span><br><span class="line">		S = S[idx]</span><br><span class="line">		U = U[:,idx]</span><br><span class="line">		V = V[idx,:]</span><br><span class="line">	order = np.argsort(S)[::-<span class="number">1</span>]</span><br><span class="line">	S = S[order]</span><br><span class="line">	U = U[:,order]</span><br><span class="line">	V = V[order,:]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;P&#x27;</span>:</span><br><span class="line">		S = S[S/S[<span class="number">0</span>]&gt;<span class="number">1.0e-15</span>]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		U = U[:,:Dc]</span><br><span class="line">		V = V[:Dc,:]</span><br><span class="line">		S[S/S[<span class="number">0</span>]&lt;prec] = prec</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">if</span> mode == <span class="string">&#x27;C&#x27;</span>:</span><br><span class="line">		S = S[S/S[<span class="number">0</span>]&gt;prec]</span><br><span class="line">		Dc = <span class="built_in">min</span>(<span class="built_in">len</span>(S),Dcut)</span><br><span class="line">		S = S[:Dc]</span><br><span class="line">		U = U[:,:Dc]</span><br><span class="line">		V = V[:Dc,:]</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> iweight == <span class="number">1</span>:</span><br><span class="line">		U = np.dot(U,np.diag(np.sqrt(S)))</span><br><span class="line">		V = np.dot(np.diag(np.sqrt(S)),V)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		<span class="keyword">if</span> iweight == <span class="number">0</span>:</span><br><span class="line">			<span class="built_in">print</span>(LA.norm(np.dot(U,np.dot(np.diag(S),V))-A)/LA.norm(A))</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="built_in">print</span>(LA.norm(np.dot(U,V)-A)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> U,S,V,Dc</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_QRP</span>(<span class="params">UL,T,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-UL-1)(0-T-L) -&gt; (0-Tnew-L)(0-UR-1) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.tensordot(UL,T,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">	A = np.reshape(A,[np.prod(shapeT[:-<span class="number">1</span>]),shapeT[-<span class="number">1</span>]])</span><br><span class="line">	Tnew,UR = linalg.qr(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UR)))</span><br><span class="line">	Tnew = np.dot(Tnew,Sign)</span><br><span class="line">	UR = np.dot(Sign,UR)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		A = np.reshape(A,shapeT)</span><br><span class="line">		B = np.tensordot(Tnew,UR,(rankT-<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>),<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[-<span class="number">1</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Tnew,UR</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_LQP</span>(<span class="params">T,UR,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-T-L)(0-UR-1) -&gt; (0-UL-1)(0-Tnew-L) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.tensordot(T,UR,(rankT-<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">	A = np.reshape(A,[shapeT[<span class="number">0</span>],np.prod(shapeT[<span class="number">1</span>:])])</span><br><span class="line">	UL,Tnew = linalg.rq(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UL)))</span><br><span class="line">	UL = np.dot(UL,Sign)</span><br><span class="line">	Tnew = np.dot(Sign,Tnew)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		A = np.reshape(A,shapeT)</span><br><span class="line">		B = np.tensordot(UL,Tnew,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">1</span>,rankT),<span class="built_in">range</span>(<span class="number">1</span>,rankT)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[<span class="number">0</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> UL,Tnew</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_QR0P</span>(<span class="params">T,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-T-L) -&gt; (0-Tnew-L)(0-UR-1) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.reshape(T,[np.prod(shapeT[:-<span class="number">1</span>]),shapeT[-<span class="number">1</span>]])</span><br><span class="line">	Tnew,UR = linalg.qr(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UR)))</span><br><span class="line">	Tnew = np.dot(Tnew,Sign)</span><br><span class="line">	UR = np.dot(Sign,UR)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		B = np.tensordot(Tnew,UR,(rankT-<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(T-B)/LA.norm(T))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>),<span class="built_in">range</span>(<span class="number">0</span>,rankT-<span class="number">1</span>)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[-<span class="number">1</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> Tnew,UR</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Mps_LQ0P</span>(<span class="params">T,icheck=<span class="number">0</span></span>):</span><br><span class="line">	<span class="string">&quot;&quot;&quot; (0-T-L) -&gt; (0-UL-1)(0-Tnew-L) &quot;&quot;&quot;</span></span><br><span class="line">	shapeT = np.asarray(np.shape(T))</span><br><span class="line">	rankT = <span class="built_in">len</span>(shapeT)</span><br><span class="line">	</span><br><span class="line">	A = np.reshape(T,[shapeT[<span class="number">0</span>],np.prod(shapeT[<span class="number">1</span>:])])</span><br><span class="line">	UL,Tnew = linalg.rq(A,mode = <span class="string">&#x27;economic&#x27;</span>)</span><br><span class="line">	Sign = np.diag(np.sign(np.diag(UL)))</span><br><span class="line">	UL = np.dot(UL,Sign)</span><br><span class="line">	Tnew = np.dot(Sign,Tnew)</span><br><span class="line">	Tnew = np.reshape(Tnew,shapeT)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> icheck == <span class="number">1</span>:</span><br><span class="line">		B = np.tensordot(UL,Tnew,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(T-B)/LA.norm(T))</span><br><span class="line">		A = np.tensordot(np.conj(Tnew),Tnew,(<span class="built_in">range</span>(<span class="number">1</span>,rankT),<span class="built_in">range</span>(<span class="number">1</span>,rankT)))</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-np.eye(shapeT[<span class="number">0</span>])))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> UL,Tnew</span><br><span class="line"><span class="comment">#----------------------------------------------------------------</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">	Test = &#123;&#125;</span><br><span class="line">	Test[<span class="string">&#x27;Group&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;NCon&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;SplitEig&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;SplitSvd&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	Test[<span class="string">&#x27;Mps_QRP&#x27;</span>] = <span class="number">0</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;Group&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		A = np.random.rand(<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">		A = Group(A,[[<span class="number">0</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">1</span>]])</span><br><span class="line">		<span class="built_in">print</span>(A)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;NCon&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		T1 = np.random.rand(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,([<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>]))</span><br><span class="line">		A = np.transpose(A,[<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>])</span><br><span class="line">		B = NCon([T1,T2],[[<span class="number">1</span>,-<span class="number">2</span>,-<span class="number">4</span>,<span class="number">2</span>],[-<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,-<span class="number">3</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,(<span class="number">3</span>,<span class="number">2</span>))</span><br><span class="line">		A = np.transpose(A,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">5</span>])</span><br><span class="line">		B = NCon([T1,T2],[[-<span class="number">5</span>,-<span class="number">1</span>,-<span class="number">4</span>,<span class="number">1</span>],[-<span class="number">2</span>,-<span class="number">3</span>,<span class="number">1</span>,-<span class="number">6</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,([<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">2</span>]))</span><br><span class="line">		A = np.tensordot(A,T3,([<span class="number">0</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">3</span>]))</span><br><span class="line">		A = np.transpose(A,[<span class="number">3</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">		B = NCon([T1,T2,T3],[[<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>],[-<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,-<span class="number">3</span>],[-<span class="number">4</span>,<span class="number">3</span>,-<span class="number">1</span>,<span class="number">4</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		</span><br><span class="line">		T1 = np.random.rand(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">4</span>,<span class="number">2</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.kron(T1,T2)</span><br><span class="line">		A = np.reshape(A,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">		B = NCon([T1,T2],[[-<span class="number">1</span>,-<span class="number">3</span>],[-<span class="number">2</span>,-<span class="number">4</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.kron(T1,T2)</span><br><span class="line">		A = np.kron(A,T3)</span><br><span class="line">		A = np.reshape(A,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>])</span><br><span class="line">		A = np.transpose(A,[<span class="number">1</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">		B = NCon([T1,T2,T3],[[-<span class="number">2</span>,-<span class="number">6</span>],[-<span class="number">1</span>,-<span class="number">4</span>],[-<span class="number">5</span>,-<span class="number">3</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		</span><br><span class="line">		T = np.random.rand(<span class="number">3</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.eye(<span class="number">3</span>)</span><br><span class="line">		A = np.tensordot(T,A,([<span class="number">0</span>,<span class="number">3</span>],[<span class="number">0</span>,<span class="number">1</span>]))</span><br><span class="line">		A = np.transpose(A,[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>])</span><br><span class="line">		B = NCon([T],[[<span class="number">1</span>,-<span class="number">2</span>,-<span class="number">3</span>,<span class="number">1</span>,-<span class="number">1</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		A = np.eye(<span class="number">3</span>*<span class="number">2</span>)</span><br><span class="line">		A = np.reshape(A,[<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>])</span><br><span class="line">		A = np.tensordot(T,A,([<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</span><br><span class="line">		B = NCon([T],[[<span class="number">1</span>,<span class="number">2</span>,-<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">		</span><br><span class="line">		T1 = np.random.rand(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.kron(A,T3)</span><br><span class="line">		A = np.reshape(A,[<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>])</span><br><span class="line">		B = NCon([T1,T2,T3],[[-<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,-<span class="number">3</span>],[-<span class="number">2</span>,-<span class="number">4</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">		T1 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">		T2 = np.random.rand(<span class="number">3</span>,<span class="number">1</span>,<span class="number">3</span>)</span><br><span class="line">		T3 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">		T4 = np.random.rand(<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T1,T2,(<span class="number">1</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,T3,(<span class="number">1</span>,<span class="number">2</span>))</span><br><span class="line">		A = np.tensordot(A,T4,([<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]))</span><br><span class="line">		B = NCon([T1,T2,T3,T4],[[<span class="number">3</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">6</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">		<span class="built_in">print</span>(LA.norm(A-B)/LA.norm(A))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (Test[<span class="string">&#x27;SplitEig&#x27;</span>] == <span class="number">1</span>) | (Test[<span class="string">&#x27;SplitSvd&#x27;</span>] == <span class="number">1</span>):</span><br><span class="line">		T = np.zeros((<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">		T[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">		T[<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>] = -<span class="number">1</span></span><br><span class="line">		T[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>] = -<span class="number">1</span></span><br><span class="line">		T[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>] = -<span class="number">1</span></span><br><span class="line">		</span><br><span class="line">		G = np.zeros((<span class="number">3</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">		G[<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">		G[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">		G[<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">		G[<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(T,G,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,G,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,G,(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		A = np.tensordot(A,np.conj(A),([<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>],[<span class="number">0</span>,<span class="number">2</span>,<span class="number">4</span>]))</span><br><span class="line">		STA = Group(A,[[<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">4</span>],[<span class="number">2</span>,<span class="number">5</span>]])</span><br><span class="line">	</span><br><span class="line">		A = np.reshape(T,[<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>,<span class="number">3</span>])</span><br><span class="line">		A = np.tensordot(A,np.conj(A),(<span class="number">0</span>,<span class="number">0</span>))</span><br><span class="line">		STB = Group(A,[[<span class="number">0</span>,<span class="number">3</span>],[<span class="number">1</span>,<span class="number">4</span>],[<span class="number">2</span>,<span class="number">5</span>]])</span><br><span class="line">	</span><br><span class="line">		A = np.tensordot(STA,STB,([<span class="number">0</span>],[<span class="number">0</span>]))</span><br><span class="line">		ST0 = np.transpose(A,[<span class="number">3</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;SplitEig&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		ST = Group(ST0,[[<span class="number">3</span>,<span class="number">0</span>],[<span class="number">2</span>,<span class="number">1</span>]])</span><br><span class="line">		STh = (ST+np.transpose(ST))/<span class="number">2</span></span><br><span class="line">		ST0h = np.reshape(STh,[<span class="number">9</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">9</span>])</span><br><span class="line">		Dfull = np.shape(ST)[<span class="number">0</span>]</span><br><span class="line">		<span class="built_in">print</span>(Dfull)</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;full eig&#x27;</span>)</span><br><span class="line">		V,S,Dc = SplitEig(STh,Dfull)</span><br><span class="line">		Sfull = S</span><br><span class="line">		<span class="built_in">print</span>(Sfull,<span class="built_in">len</span>(Sfull))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;partial eig&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> Dcut <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,Dfull+<span class="number">1</span>):</span><br><span class="line">			V,S,Dc = SplitEig(STh,Dcut)</span><br><span class="line">			<span class="built_in">print</span>(Dcut,Dc,LA.norm(<span class="built_in">abs</span>(S)-<span class="built_in">abs</span>(Sfull[:Dc])))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;full eigh&#x27;</span>)</span><br><span class="line">		V,S,Dc = SplitEigh(STh,Dfull,icheck=<span class="number">1</span>)</span><br><span class="line">		Sfull = S</span><br><span class="line">		<span class="built_in">print</span>(Sfull,<span class="built_in">len</span>(Sfull))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;partial eigh&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> Dcut <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,Dfull+<span class="number">1</span>):</span><br><span class="line">			V,S,Dc = SplitEigh(STh,Dcut,icheck=<span class="number">1</span>)</span><br><span class="line">			<span class="built_in">print</span>(Dcut,Dc,LA.norm(<span class="built_in">abs</span>(S)-<span class="built_in">abs</span>(Sfull[:Dc])))</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;SplitSvd&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		ST = Group(ST0,[[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">		ST1 = Group(ST0,[[<span class="number">0</span>],[<span class="number">1</span>],[<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">		ST2 = Group(ST0,[[<span class="number">0</span>,<span class="number">1</span>],[<span class="number">2</span>],[<span class="number">3</span>]])</span><br><span class="line">		Dfull = np.shape(ST)[<span class="number">0</span>]</span><br><span class="line">		<span class="built_in">print</span>(Dfull)</span><br><span class="line"></span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;full svd&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> iweight <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">			U,S,V,Dc = SplitSvd_Lapack(ST,Dfull,iweight,icheck=<span class="number">1</span>)</span><br><span class="line">		Sfull = S</span><br><span class="line">		<span class="built_in">print</span>(Sfull,<span class="built_in">len</span>(Sfull))</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;partial svd&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> Dcut <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,Dfull+<span class="number">1</span>):</span><br><span class="line">			<span class="keyword">for</span> iweight <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">				U,S,V,Dc = SplitSvd_Lapack(ST,Dcut,iweight,mode=<span class="string">&#x27;C&#x27;</span>,icheck=<span class="number">1</span>)</span><br><span class="line">				<span class="built_in">print</span>(Dcut,iweight,Dc,LA.norm(S-Sfull[:Dc]))</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">if</span> Test[<span class="string">&#x27;Mps_QRP&#x27;</span>] == <span class="number">1</span>:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;no Z2, rank 3&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> D1,D2,D3 <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>)):</span><br><span class="line">			D = [D1,D2,D3]</span><br><span class="line">			T0 = np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>])</span><br><span class="line">			UL = np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>])</span><br><span class="line">			UR = np.random.rand(D[<span class="number">2</span>],D[<span class="number">2</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">2</span>],D[<span class="number">2</span>])</span><br><span class="line">			</span><br><span class="line">			<span class="built_in">print</span>(D1,D2,D3)</span><br><span class="line">			T,UR = Mps_QRP(UL,T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQP(T0,UR,icheck=<span class="number">1</span>)</span><br><span class="line">			T,UR = Mps_QR0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQ0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&#x27;no Z2, rank 4&#x27;</span>)</span><br><span class="line">		<span class="keyword">for</span> D1,D2,D3,D4 <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>),<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">5</span>)):</span><br><span class="line">			D = [D1,D2,D3,D4]</span><br><span class="line">			T0 = np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>],D[<span class="number">3</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">1</span>],D[<span class="number">2</span>],D[<span class="number">3</span>])</span><br><span class="line">			UL = np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">0</span>],D[<span class="number">0</span>])</span><br><span class="line">			UR = np.random.rand(D[<span class="number">3</span>],D[<span class="number">3</span>]) + <span class="number">1j</span>*np.random.rand(D[<span class="number">3</span>],D[<span class="number">3</span>])</span><br><span class="line">			</span><br><span class="line">			<span class="built_in">print</span>(D1,D2,D3,D4)</span><br><span class="line">			T,UR = Mps_QRP(UL,T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQP(T0,UR,icheck=<span class="number">1</span>)</span><br><span class="line">			T,UR = Mps_QR0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">			UL,T = Mps_LQ0P(T0,icheck=<span class="number">1</span>)</span><br><span class="line">	</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/12/Semiconductor%20physics2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/12/Semiconductor%20physics2/" class="post-title-link" itemprop="url">Semiconductor Physics(section 2)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-11-12 21:20:00 / ä¿®æ”¹æ—¶é—´ï¼š15:35:16" itemprop="dateCreated datePublished" datetime="2022-11-12T21:20:00+08:00">2022-11-12</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Semiconductor-Physics/" itemprop="url" rel="index"><span itemprop="name">Semiconductor Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="A-The-density-of-states"><a href="#A-The-density-of-states" class="headerlink" title="A. The density of states"></a>A. The density of states</h3>
      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/11/06/HW_MPO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/11/06/HW_MPO/" class="post-title-link" itemprop="url">Matrix Product Operators (MPOs) in compass model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-11-06 01:02:30 / ä¿®æ”¹æ—¶é—´ï¼š01:14:57" itemprop="dateCreated datePublished" datetime="2022-11-06T01:02:30+08:00">2022-11-06</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework </font>

<ul>
<li><p>write down the MPO for the compass model on a square lattice</p>
<p>  $H=-J_x \sum_{\langle i, j\rangle_H} \sigma_i^x \sigma_j^x-J_y \sum_{\langle i, j\rangle_V} \sigma_i^y \sigma_j^y+h_z \sum_i \sigma_i^z$</p>
<p>  $\langle i, j\rangle_H \in(0,3),(3,6),(1,4),(4,7),(2,5),(5,8)$</p>
<p>  $\langle i, j\rangle_V \in(0,1),(1,2),(2,0),(3,4),(4,5),(5,3),(6,7),(7,8),(8,6)$</p>
<p>  $J_x=0.3, J_y=1.4, h_z=0.5, \sigma^x$ and $\sigma^y$ are Pauli matrices</p>
  <div  align="left">    
  <img src=https://s2.loli.net/2022/11/06/MaEcbXDkrLWsGYC.png style="zoom:90%" />  
  </div>
</li>
<li><p>(1) show the finite automata figure like thisï¼š</p>
<p>  <a href="https://sm.ms/image/6zLvtHqX4pJ2UNI" target="_blank"><img src="https://s2.loli.net/2022/11/06/6zLvtHqX4pJ2UNI.png" ></a></p>
</li>
<li><p>(2) write a code to generate these MPO, contract MPO tensors to obtain the Hamiltonian. </p>
<p>  show the lowest 20 eigenvalues, compare Hamiltonian and eigenvalues with exact diagonalization</p>
</li>
</ul>
<font size =4> A brief summary of theory and algorithm </font>

<ul>
<li><p>æ ¹æ®å‚è€ƒæ–‡çŒ®$ ^{[1]}$ï¼Œå¯¹äºä¸€èˆ¬çš„å“ˆå¯†é¡¿é‡ï¼Œå…¶ Finite automata for MPO æ„é€ è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>(1) é¦–å…ˆåœ¨ç¬¬1è¡Œè®¾ç½®ä¸€ä¸ªå‡ºå‘ç‚¹0ï¼Œä¸€ä¸ªä¸ Hamiltonian åŒé˜¶çš„å•ä½é˜µIdentityæ˜¯å¿…è¦çš„ï¼Œå…ˆæ¥å¤„ç†siteé—´çš„é—®é¢˜ï¼Œå…ˆè§‚å¯ŸHamiltonianä¸­æ±‚å’Œä¸‹æ ‡içš„ä¸åŒç®—ç¬¦æœ‰å¤šå°‘ï¼Œå‡è®¾æœ‰Nä¸ªï¼Œåˆ™åˆ†åˆ«ä»0å‘å°„Nä¸ªä¸åŒçš„ç®­å¤´çº¿ï¼Œç„¶åå°†å„è‡ªçš„ç®—ç¬¦ABCæ ‡è®°åœ¨ç®­å¤´çº¿ä¸Šï¼Œå¦‚æœè¿™ä¸ªæ±‚å’Œé¡¹æœ‰é1çš„å¸¸ç³»æ•°ï¼Œåˆ™åªåŠ åœ¨è¿™ä¸€æ­¥æ‰€å†™çš„ç®—ç¬¦å‰ï¼Œå°†ç®­å¤´çš„ç»ˆç‚¹æŒ‰åºç¼–å·;</p>
</li>
<li><p>(2) ä»ç¬¬2è¡Œçš„æœ€å·¦ä¾§å¼€å§‹ï¼Œè§‚å¯Ÿè·Ÿåœ¨æ±‚å’Œä¸‹æ ‡iä¹‹åçš„ä¸‹æ ‡i+Nçš„ä¸åŒç®—ç¬¦ï¼ŒåŒæ ·æ–¹æ³•åœ°ä»æ¯ä¸ªç‚¹å‘å°„ç­‰åŒäºä¸åŒç®—ç¬¦æ•°ç›®çš„ç®­å¤´çº¿ï¼Œç®­å¤´çº¿æ ¹æ®Nåˆ†ä¸ºNæ®µï¼Œä»…åœ¨æœ€åä¸€æ®µç®­å¤´çº¿ä¸Šæ ‡è®°ä¸‹æ ‡i+Nå¯¹åº”çš„ç®—ç¬¦ï¼Œå…¶å®ƒæ®µæ ‡è®° Identity ï¼Œåˆ™è¿™ä¸€æ”¯å¯¹åº”iå’Œi+Nçš„æ±‚å’Œé¡¹ã€‚å¯¹ç®­å¤´çº¿ä¸­é—´çš„ç«¯ç‚¹è¿›è¡Œç¼–å·ï¼Œæ³¨æ„å¸¦æœ‰é Identity ç®—ç¬¦ç®­å¤´çº¿çš„ç»ˆç‚¹ä¸å‚ä¸ç¼–å·ã€‚ç¼–å·æŒ‰è¡Œä»å·¦åˆ°å³ä»ä¸Šåˆ°ä¸‹ä¾æ¬¡å¢å¤§;</p>
</li>
<li><p>(3) é‡å¤æ­¥éª¤2ç›´åˆ°æ‰€æœ‰ site é—´çš„æ±‚å’Œé¡¹éƒ½å†™å®Œï¼ŒæŠŠæ‰€æœ‰å¸¦æœ‰é Identity ç®—ç¬¦çš„æœªå‚ä¸ç¼–å·çš„ç®­å¤´çº¿æœ«ç«¯éƒ½æŒ‡å‘ä¸€ä¸ªå…±åŒç»ˆç‚¹ï¼Œå¦‚æœä¸­é—´ä¸€å…±å†™äº† K-1 ä¸ªç‚¹ï¼Œé‚£ä¹ˆç»ˆç‚¹æŒ‰åŒæ ·çš„è§„åˆ™ç¼–å·ä¸ºKã€‚on-site ä½œç”¨é¡¹ç›´æ¥å†™åœ¨å‡ºå‘ç‚¹0ç›´æ¥æŒ‡å‘ç»ˆç‚¹Kçš„è¿çº¿ä¸Šå³å¯;</p>
<p><a href="https://sm.ms/image/z1mhMtesy4UDvqr" target="_blank"><img src="https://s2.loli.net/2022/11/06/z1mhMtesy4UDvqr.jpg" ></a></p>
</li>
<li><p>(4) ç”Ÿæˆä¸€ä¸ª (K+1)Ã—(K+1)  çš„çŸ©é˜µæ¡†æ¶ï¼Œè¡Œåºå·å’Œåˆ—åºå·å‡ä¸º 0~Kï¼Œç„¶åæŒ‰ç…§ è¡Œâ†’åˆ—ï¼ˆæˆ–è€… åˆ—â†’è¡Œï¼Œè¿™æ ·å¾—åˆ°çš„ç»“æœæ˜¯å‰è€…çš„è½¬ç½®ï¼Œæ˜¯ç­‰ä»·çš„ï¼‰åº”ç”¨ä¸Šå›¾å¡«æ»¡æ•´ä¸ªçŸ©é˜µï¼Œå°±å¾—åˆ°äº†MPOã€‚æ¯”å¦‚0â†’1ç®­å¤´çº¿ä¸Šæ˜¯Aï¼Œåˆ™åœ¨çŸ©é˜µçš„0è¡Œ1åˆ—å¡«Aã€‚æ³¨æ„è¿™é‡Œå¾—åˆ°çš„çŸ©é˜µæ˜¯ $W^{[i]}$ ï¼Œå®ƒçš„ç¬¬0è¡Œæ˜¯ $W^{[1]}$ ï¼Œç¬¬Kåˆ—æ˜¯ $W^{[N]}$ ï¼ˆå¦‚æœæ˜¯åˆ—â†’è¡Œï¼Œåˆ™ç¬¬Kè¡Œæ˜¯ $W^{[1]}$ ï¼Œç¬¬0åˆ—æ˜¯ $W^{[N]}$ ï¼‰ã€‚</p>
</li>
</ul>
</li>
</ul>
<font size =4> An original attempt: problems encountered and solutions </font>

<ul>
<li><p>æœ€åˆçš„æƒ³æ³•ï¼šæ ¹æ®è¯¾ä»¶å’Œä¸Šè¿°å‚è€ƒæ–‡çŒ®ï¼Œå†™å‡º MPOï¼Œç„¶åç±»ä¼¼ä¸‹æ–‡ä¸­çš„ <em>MPO generate Hamiltonian OP</em> ç”Ÿæˆå“ˆå¯†é¡¿é‡æ¥ check</p>
</li>
<li><p>é‡åˆ°çš„é—®é¢˜ï¼šå‘ç°å¯¹äº onsite é¡¹ï¼ˆSzï¼‰å’Œ H æ–¹å‘é¡¹ï¼ˆSxï¼‰ï¼Œå“ˆå¯†é¡¿é‡æ˜¯å¯¹çš„ï¼›ä½†æ˜¯ V æ–¹å‘é¡¹ï¼ˆSyï¼‰çš„å“ˆå¯†é¡¿é‡ä¸æ­£ç¡®ã€‚å…·ä½“å¦‚ä¸‹ï¼ˆå…ˆå¿½ç•¥ onsite çš„ trival é¡¹ï¼‰ï¼š</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/06/nowRJUjTvdcDgua.png style="zoom:90%" />   
  </div>
</li>
<li><p>å¯ä»¥æ³¨æ„åˆ°ï¼ŒSx ç›¸å…³é¡¹æ˜¯æ­£ç¡®çš„ï¼ŒSy ç›¸å…³é¡¹ä¸æ­£ç¡®ï¼šä¼¼ä¹å¤šæè¿°äº†ä¸€äº› interactionã€‚</p>
</li>
<li><p>è¿™æ˜¯å› ä¸ºï¼Œæœ€å¼€å§‹æˆ‘æ„é€  MPO æ—¶é»˜è®¤ 9 ä¸ªçŸ©é˜µéƒ½æ˜¯ä¸€æ ·çš„ï¼Œæˆ–è€…è¯´ç›¸äº’ä½œç”¨æ˜¯æœ‰å¹³ç§»å¯¹ç§°çš„ã€‚ä½†æ˜¯æ³¨æ„åˆ°</p>
<p>  $\langle i, j\rangle_H \in(0,3),(3,6),(1,4),(4,7),(2,5),(5,8)$</p>
<p>  $\langle i, j\rangle_V \in(0,1),(1,2),(2,0),(3,4),(4,5),(5,3),(6,7),(7,8),(8,6)$</p>
<p>  è¿™é‡Œå¯ä»¥åšä¸ªåˆ†ç±»ï¼Œåˆ†ä¸ºâ€œè¿‘é‚»â€ç›¸äº’ä½œç”¨ï¼Œâ€œæ¬¡è¿‘é‚»â€ç›¸äº’ä½œç”¨ï¼Œâ€œæ¬¡æ¬¡è¿‘é‚»â€ç›¸äº’ä½œç”¨ï¼ˆå¼•å·è¡¨ç¤ºä¸æ˜¯ç‰©ç†æ„ä¹‰ä¸Šçš„è¿‘é‚»ï¼Œè€Œæ˜¯æ ‡å·æ„ä¹‰ä¸Šçš„ï¼‰ï¼š</p>
<p>  $\underline{(0,1)}\ \underline{(1,2)}\ (2,3)\ \underline{(3,4)}\ \underline{(4,5)}\ (5,6)\ â€¦$</p>
<p>  $\underline{(0,2)}\ (1,3)\ (2,4)\ \underline{(3,5)}\ (4,6)\ (5,7)\ â€¦$</p>
<p>  $\underline{(0,3)}\ \underline{(1,4)}\ \underline{(2,5)}\ \underline{(3,6)}\ \underline{(4,7)}\ \underline{(5,8)}\ $</p>
<p>  ä¸‹åˆ’çº¿è¡¨ç¤º compass model ä¸­å­˜åœ¨çš„ç›¸äº’ä½œç”¨ã€‚å¯ä»¥è§å¾—ï¼ŒSx ç›¸å…³é¡¹æ˜¯â€œæ¬¡æ¬¡è¿‘é‚»â€ç›¸äº’ä½œç”¨ï¼Œå¹³ç§»å¯¹ç§°å®Œå¤‡ï¼›Sy ç›¸å…³é¡¹â€œè¿‘é‚»â€ç›¸äº’ä½œç”¨ï¼Œâ€œæ¬¡è¿‘é‚»â€ç›¸äº’ä½œç”¨å¹¶ä¸æ˜¯å®Œå¤‡çš„ã€‚å¦‚æœâ€œæ„é€  MPO æ—¶é»˜è®¤ 9 ä¸ªçŸ©é˜µéƒ½æ˜¯ä¸€æ ·â€ï¼Œæ˜¾ç„¶æ²¡æ³•ååº”è¿™ç§ site é—´çš„ä¸åŒæ€§ï¼Œæˆ–è€…è¯´ MPO æ„é€ æ—¶æ²¡è€ƒè™‘ H,V æ˜¾ç„¶ä¸åˆç†ã€‚</p>
</li>
<li><p>è§£å†³æ–¹æ³•ï¼š</p>
<p>  æ˜¾ç„¶åœ°æœ‰ä¸¤ç§æ€è·¯è§£å†³ï¼š</p>
<ol>
<li><p>è€ƒè™‘è¿™ç§ site é—´çš„ä¸ç­‰ä»·æ€§ï¼Œå…ˆç”» finite automata figureï¼Œ å¯¹åº”åœ°å†™å‡ºä¸åŒ site é—´çš„ MPOï¼ˆæœ€åç”¨ä¸‹æ–‡ä¸­çš„ <em>MPO generate Hamiltonian OP</em> æ¥çœ‹ç”Ÿæˆçš„å“ˆå¯†é¡¿é‡æ˜¯å¦æ­£ç¡®ï¼‰ï¼›</p>
</li>
<li><p>é’ˆå¯¹ compass modelï¼Œ æ³¨æ„åˆ° Sx ç›¸å…³çš„ N ä¸ª MPO æ˜¯ç›¸ç­‰çš„ï¼Œè¿™æ˜¯å› ä¸ºâ€œæ¬¡æ¬¡è¿‘é‚»â€ç›¸äº’ä½œç”¨æ˜¯å®Œå¤‡çš„ï¼›é‚£ä¹ˆï¼Œå¦‚æœæˆ‘é‡æ–°å®šä¹‰ä¸‹æ ‡ï¼Œå³åŸæ¥çš„ â€œ036147258â€ å®šä¹‰ä¸º â€œ012345678â€ï¼Œå¯ä»¥å‘ç°è¿™æ—¶å€™ Sy ç›¸å…³çš„ $<i,j>_{V}$ å®Œå¤‡ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥å†™æˆ N ä¸ªç›¸ç­‰çš„ MPOã€‚åŸæœ‰çš„å“ˆå¯†é¡¿é‡ H å¯ä»¥åˆ†æˆ H_{x} å’Œ H_{y}, åˆ†åˆ«æ‹†æˆ N ä¸ªç›¸åŒçš„ MPO_{x} æˆ–è€… MPO_{y} ç›¸ä¹˜ã€‚</p>
<p>è€ƒè™‘åˆ°åç»­çš„ç®€å• MPS ç®—æ³•ï¼Œæœ¬æ–‡åç»­æ²¿ç”¨ç¬¬ä¸€ä¸ªæ€è·¯ï¼Œå³ç”Ÿæˆ N ä¸ªä¸åŒçš„ MPOã€‚</p>
</li>
</ol>
</li>
</ul>
<font size =4> Question 1 </font>

<ul>
<li><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯è§ $D = 6$</p>
  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/06/D9RkN7M8Y4oPayK.png style="zoom:60%" />   
  </div>

  <div  align="center">    
  <img src=https://s2.loli.net/2022/11/06/PpdcK78Wsi65mtu.png style="zoom:60%" />   
  </div>
</li>
<li><p>æ ¹æ®ä¸Šé¢çš„ automata figure å¾—åˆ° MPOsï¼š</p>
</li>
</ul>
<script type="math/tex; mode=display">
\left(\begin{array}{llll}
I & -J_{x}\sigma^{x} & -J_{y}\sigma^{y} & h_{z}\sigma^{z}
\end{array}\right)\left(\begin{array}{ccccc}
I & -J_{x}\sigma^{x} & 0 & -J_{y}\sigma^{y} & h_{z}\sigma^{z} \\
0 & 0 & I & 0 & 0 \\
0 & 0 & 0 & I & \sigma^{y} \\
0 & 0 & 0 & 0 & I
\end{array}\right)\left(\begin{array}{ccccc}
I & -J_{x}\sigma^{x} & 0 & 0 & h_{z}\sigma^{z} \\
0 & 0 & I & 0 & 0 \\
0 & 0 & 0 & I & 0 \\
0 & 0 & 0 & 0 & \sigma^{y} \\
0 & 0 & 0 & 0 & I
\end{array}\right)</script><script type="math/tex; mode=display">
\left(\begin{array}{cccccc}
I & -J_{x}\sigma^{x} & 0 & 0 &  -J_{y}\sigma^{y} & h_{z}\sigma^{z} \\
0 & 0 & I & 0 & 0 & 0\\
0 & 0 & 0 & I & 0 & 0\\
0 & 0 & 0 & 0 & 0 & \sigma^{x}\\
0 & 0 & 0 & 0 &  0 & I
\end{array}\right)\left(\begin{array}{cccccc}
I & -J_{x}\sigma^{x} & 0 & 0 &  -J_{y}\sigma^{y} & h_{z}\sigma^{z} \\
0 & 0 & I & 0 & 0 & 0\\
0 & 0 & 0 & I & 0 & 0\\
0 & 0 & 0 & 0 & 0 & \sigma^{x}\\
0 & 0 & 0 & 0 & I & \sigma^{y}\\
0 & 0 & 0 & 0 &  0 & I
\end{array}\right)\left(\begin{array}{ccccc}
I & -J_{x}\sigma^{x} & 0 & 0 & h_{z}\sigma^{z} \\
0 & 0 & I & 0 & 0 \\
0 & 0 & 0 & I & 0 \\
0 & 0 & 0 & 0 & \sigma^{x} \\
0 & 0 & 0 & 0 & \sigma^{y} \\
0 & 0 & 0 & 0 & I
\end{array}\right)</script><script type="math/tex; mode=display">
\left(\begin{array}{ccccc}
I & 0 & 0 & -J_{y}\sigma^{y} & h_{z}\sigma^{z} \\
0 & I & 0 & 0 & 0\\
0 & 0 & I & 0 & 0\\
0 & 0 & 0 & 0 & \sigma^{x}\\
0 & 0 & 0 & 0 & I
\end{array}\right)\left(\begin{array}{cccc}
I & 0 &  -J_{y}\sigma^{y} & h_{z}\sigma^{z} \\
0 & I & 0 & 0 \\
0 & 0 & 0 & \sigma^{x}\\
0 & 0 & I & \sigma^{y}\\
0 & 0 & 0 & I
\end{array}\right)\left(\begin{array}{c}
h_{z}\sigma^{z} \\
\sigma^{x} \\
\sigma^{y} \\
I
\end{array}\right)</script><font size =4> Question 2 </font>

<ul>
<li><p><em>MPO generate Hamiltonian OP</em> ç¨‹åºå¦‚ä¸‹ï¼Œåˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼š1.Operator Expression ; 2.Matrix and eigenvalues</p>
</li>
<li><p>Operator Expression ä»£ç éƒ¨åˆ†å®ç°çš„æ˜¯å°†ä¸Šè¿°çš„ MPO ç›¸ä¹˜ï¼Œå¾—åˆ°å“ˆå¯†é¡¿é‡çš„ç®—ç¬¦å½¢å¼è¡¨è¾¾ï¼ŒéªŒè¯ MPO æ­£ç¡®æ€§</p>
</li>
<li><p>Matrix and eigenvalues ä»£ç éƒ¨åˆ†æ˜¯å°†å“ˆå¯†é¡¿é‡çŸ©é˜µå†™å‡ºæ¥ï¼Œå¹¶æ±‚20ä¸ªæœ¬å¾å€¼</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MPO generate Hamiltonian OP -- Operator Expression </span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">N = <span class="number">9</span></span><br><span class="line">D = <span class="number">6</span></span><br><span class="line">row = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line">col = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OPdot</span>(<span class="params">La,Lb</span>):                                   <span class="comment">#ç®—ç¬¦ä½œä¸ºå­—ç¬¦ä¸²å­˜å‚¨èµ·æ¥ï¼Œä¹˜ç§¯å¯¹åº”å­—ç¬¦ä¸²åŠ æ³•</span></span><br><span class="line">    Lc = []</span><br><span class="line">    <span class="keyword">for</span> str1 <span class="keyword">in</span> La:</span><br><span class="line">        <span class="keyword">for</span> str2 <span class="keyword">in</span> Lb:</span><br><span class="line">            Lc.append(str1+str2)</span><br><span class="line">    <span class="keyword">return</span> Lc</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mply</span>(<span class="params">A,B</span>):                                      <span class="comment">#mply(A,B) è¿”å› çŸ©é˜µ C = A*B</span></span><br><span class="line">    II = <span class="built_in">len</span>(A)                                      </span><br><span class="line">    JJ = <span class="built_in">len</span>(B[<span class="number">0</span>])</span><br><span class="line">    KK = <span class="built_in">len</span>(B)</span><br><span class="line">    C = [[[] <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(JJ)] <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(II)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(II):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(JJ):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(KK):</span><br><span class="line">                <span class="keyword">if</span>(A[i][k] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span> <span class="keyword">and</span> B[k][j] <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>):</span><br><span class="line">                    C[i][j] += OPdot(A[i][k],B[k][j])</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">MPO = []                                               <span class="comment">#MPSå­˜å‚¨è¿™9ä¸ªçŸ©é˜µï¼Œæ ¹æ®Q1çš„è‡ªåŠ¨æœºå›¾ç¤ºæ¥èµ‹å€¼</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    M = [[<span class="literal">None</span> <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(col[i])] <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(row[i])]</span><br><span class="line">    MPO.append(M)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    MPO[i][<span class="number">0</span>][<span class="number">1</span>] = [<span class="string">&quot;-JxSx &quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    MPO[i][<span class="number">0</span>][col[i]-<span class="number">1</span>] = [<span class="string">&quot;hzSz &quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>]:</span><br><span class="line">    MPO[i][<span class="number">0</span>][col[i]-<span class="number">2</span>] = [<span class="string">&quot;-JySy &quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>]:</span><br><span class="line">    MPO[i][row[i]-<span class="number">2</span>][col[i]-<span class="number">1</span>] = [<span class="string">&quot;Sy &quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">3</span>,<span class="number">6</span>]:</span><br><span class="line">    MPO[i][row[i]-<span class="number">2</span>][col[i]-<span class="number">1</span>] = [<span class="string">&quot;Sx &quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>]:</span><br><span class="line">    MPO[i][row[i]-<span class="number">3</span>][col[i]-<span class="number">1</span>] = [<span class="string">&quot;Sx &quot;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    MPO[i][<span class="number">0</span>][<span class="number">0</span>] = [<span class="string">&quot;I &quot;</span>]</span><br><span class="line">    MPO[i+<span class="number">1</span>][row[i+<span class="number">1</span>]-<span class="number">1</span>][col[i+<span class="number">1</span>]-<span class="number">1</span>] = [<span class="string">&quot;I &quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">1</span> <span class="keyword">and</span> i &lt;= <span class="number">5</span>:</span><br><span class="line">        MPO[i][<span class="number">1</span>][<span class="number">2</span>] = MPO[i][<span class="number">2</span>][<span class="number">3</span>] = [<span class="string">&quot;I &quot;</span>]</span><br><span class="line">MPO[<span class="number">4</span>][<span class="number">4</span>][<span class="number">4</span>] = MPO[<span class="number">6</span>][<span class="number">1</span>][<span class="number">1</span>] = MPO[<span class="number">6</span>][<span class="number">2</span>][<span class="number">2</span>] = MPO[<span class="number">7</span>][<span class="number">1</span>][<span class="number">1</span>] = MPO[<span class="number">7</span>][<span class="number">3</span>][<span class="number">2</span>] = [<span class="string">&quot;I &quot;</span>]</span><br><span class="line"></span><br><span class="line">ANS = MPO[<span class="number">0</span>]                                                    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N-<span class="number">1</span>):                                                <span class="comment">#å°† MPO ä¹˜èµ·æ¥</span></span><br><span class="line">    ANS = mply(ANS,MPO[i+<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> ANS[<span class="number">0</span>][<span class="number">0</span>]:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code>I I I I I I I I hzSz 
I I I I I -JxSx I I Sx 
I I I I I I I -JySy Sy 
I I I I I I -JySy I Sy 
I I I I I I I hzSz I 
I I I I -JxSx I I Sx I 
I I I I I I -JySy Sy I 
I I I I I I hzSz I I 
I I I -JxSx I I Sx I I 
I I I I I hzSz I I I 
I I -JxSx I I Sx I I I 
I I I I -JySy Sy I I I 
I I I -JySy I Sy I I I 
I I I I hzSz I I I I 
I -JxSx I I Sx I I I I 
I I I -JySy Sy I I I I 
I I I hzSz I I I I I 
-JxSx I I Sx I I I I I 
I I hzSz I I I I I I 
I -JySy Sy I I I I I I 
-JySy I Sy I I I I I I 
I hzSz I I I I I I I 
-JySy Sy I I I I I I I 
hzSz I I I I I I I I 
</code></pre><ul>
<li><p>å…±æœ‰ 24 é¡¹ï¼Œåˆ†åˆ«å¯¹åº” x, y, z é¡¹æ•°ä¸º 6 + 9 + 9 = 24</p>
</li>
<li><p>å’Œ compass model Hamiltonian æ¯”è¾ƒç›¸ä¸€è‡´ï¼Œè¯´æ˜ MPOs åˆç†</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># MPO generate Hamiltonian OP -- Matrix and eigenvalues</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LA</span><br><span class="line">N = <span class="number">9</span></span><br><span class="line">D = <span class="number">6</span></span><br><span class="line">row = [<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>]</span><br><span class="line">col = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">Jx = <span class="number">0.3</span></span><br><span class="line">Jy = <span class="number">1.4</span></span><br><span class="line">hz = <span class="number">0.5</span></span><br><span class="line">Sx = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">0</span>]]</span><br><span class="line">Sy = [[<span class="number">0</span>, -<span class="number">1.0j</span>], [<span class="number">1.0j</span>, <span class="number">0</span>]]</span><br><span class="line">Sz = [[<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, -<span class="number">1</span>]]</span><br><span class="line">O = [[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>]]</span><br><span class="line">I = [[<span class="number">1</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">1</span>]]</span><br><span class="line">_JxSx = [[<span class="number">0</span>, -Jx], [-Jx, <span class="number">0</span>]]</span><br><span class="line">_JySy = [[<span class="number">0</span>, -<span class="number">1.0j</span> * -Jy], [<span class="number">1.0j</span> * -Jy, <span class="number">0</span>]]</span><br><span class="line">hzSz = [[hz, <span class="number">0</span>], [<span class="number">0</span>, -hz]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">OPdot</span>(<span class="params">La,Lb</span>):                                   <span class="comment">#åšç›´ç§¯æ“ä½œ</span></span><br><span class="line">    <span class="keyword">return</span> np.kron(La,Lb)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mply</span>(<span class="params">A,B</span>):                                      <span class="comment">#mply(A,B) è¿”å› çŸ©é˜µ C = A*B</span></span><br><span class="line">    II = <span class="built_in">len</span>(A)                                      </span><br><span class="line">    JJ = <span class="built_in">len</span>(B[<span class="number">0</span>])</span><br><span class="line">    KK = <span class="built_in">len</span>(B)</span><br><span class="line">    C = [[<span class="literal">None</span> <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(JJ)] <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(II)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(II):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(JJ):</span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(KK):</span><br><span class="line">                <span class="keyword">if</span> (C[i][j] <span class="keyword">is</span> <span class="literal">None</span>):               <span class="comment"># åˆ¤æ–­ None æ˜¯ä¸ºäº†æ–¹ä¾¿æ•°æ®ç±»å‹ä¸å‡ºé—®é¢˜</span></span><br><span class="line">                    C[i][j] = OPdot(A[i][k],B[k][j])</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    C[i][j] = C[i][j] + OPdot(A[i][k],B[k][j])</span><br><span class="line">    <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">MPO = []                                               <span class="comment">#MPSå­˜å‚¨è¿™9ä¸ªçŸ©é˜µï¼Œæ ¹æ® Q1 çš„è‡ªåŠ¨æœºå›¾ç¤ºæ¥èµ‹å€¼</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    M = [[<span class="literal">None</span> <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(col[i])] <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(row[i])]</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> <span class="built_in">range</span>(row[i]):</span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(col[i]):</span><br><span class="line">            M[r][c] = O</span><br><span class="line">    MPO.append(M)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    MPO[i][<span class="number">0</span>][<span class="number">1</span>] = _JxSx</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">    MPO[i][<span class="number">0</span>][col[i]-<span class="number">1</span>] = hzSz</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">7</span>]:</span><br><span class="line">    MPO[i][<span class="number">0</span>][col[i]-<span class="number">2</span>] = _JySy</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>]:</span><br><span class="line">    MPO[i][row[i]-<span class="number">2</span>][col[i]-<span class="number">1</span>] = Sy</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">3</span>,<span class="number">6</span>]:</span><br><span class="line">    MPO[i][row[i]-<span class="number">2</span>][col[i]-<span class="number">1</span>] = Sx</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="number">4</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">8</span>]:</span><br><span class="line">    MPO[i][row[i]-<span class="number">3</span>][col[i]-<span class="number">1</span>] = Sx</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    MPO[i][<span class="number">0</span>][<span class="number">0</span>] = I</span><br><span class="line">    MPO[i+<span class="number">1</span>][row[i+<span class="number">1</span>]-<span class="number">1</span>][col[i+<span class="number">1</span>]-<span class="number">1</span>] = I</span><br><span class="line">    <span class="keyword">if</span> i &gt;= <span class="number">1</span> <span class="keyword">and</span> i &lt;= <span class="number">5</span>:</span><br><span class="line">        MPO[i][<span class="number">1</span>][<span class="number">2</span>] = MPO[i][<span class="number">2</span>][<span class="number">3</span>] = I</span><br><span class="line">MPO[<span class="number">4</span>][<span class="number">4</span>][<span class="number">4</span>] = MPO[<span class="number">6</span>][<span class="number">1</span>][<span class="number">1</span>] = MPO[<span class="number">6</span>][<span class="number">2</span>][<span class="number">2</span>] = MPO[<span class="number">7</span>][<span class="number">1</span>][<span class="number">1</span>] = MPO[<span class="number">7</span>][<span class="number">3</span>][<span class="number">2</span>] = I</span><br><span class="line"></span><br><span class="line">ANS = MPO[<span class="number">0</span>]                                                </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N-<span class="number">1</span>):                                                <span class="comment">#å°† MPO ä¹˜èµ·æ¥</span></span><br><span class="line">    ANS = mply(ANS,MPO[i+<span class="number">1</span>])</span><br><span class="line">ANS = np.real(ANS)</span><br><span class="line"><span class="built_in">print</span>(ANS[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">E,W = LA.eigsh(ANS[<span class="number">0</span>][<span class="number">0</span>],<span class="number">20</span>,which = <span class="string">&#x27;SA&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(E)</span><br></pre></td></tr></table></figure>
<pre><code>[[ 4.5  0.   0.  ...  0.   0.   0. ]
 [ 0.   3.5 -1.4 ...  0.   0.   0. ]
 [ 0.  -1.4  3.5 ...  0.   0.   0. ]
 ...
 [ 0.   0.   0.  ... -3.5 -1.4  0. ]
 [ 0.   0.   0.  ... -1.4 -3.5  0. ]
 [ 0.   0.   0.  ...  0.   0.  -4.5]]
[-13.12646931 -13.07866474 -13.07575853 -13.06893675 -13.03230613
 -13.02946844 -13.02304559 -12.9880016   -8.68300191  -8.56677243
  -8.56586155  -8.37964052  -8.37964052  -8.26479657  -8.23663151
  -8.23248641  -8.2288993   -8.21755532  -8.21755532  -8.21213607]
</code></pre><ul>
<li>ä½œä¸ºå¯¹æ¯”ï¼Œç²¾ç¡®å¯¹è§’åŒ–å¦‚ä¸‹ï¼š</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> scipy.sparse.linalg <span class="keyword">as</span> LA</span><br><span class="line"></span><br><span class="line">Jx = <span class="number">0.3</span></span><br><span class="line">Jy = <span class="number">1.4</span></span><br><span class="line">hz = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line">N = <span class="number">9</span></span><br><span class="line">n = <span class="number">1</span>&lt;&lt;N</span><br><span class="line"></span><br><span class="line">H_Near = [(<span class="number">0</span>,<span class="number">3</span>),(<span class="number">3</span>,<span class="number">6</span>),(<span class="number">1</span>,<span class="number">4</span>),(<span class="number">4</span>,<span class="number">7</span>),(<span class="number">2</span>,<span class="number">5</span>),(<span class="number">5</span>,<span class="number">8</span>)]</span><br><span class="line">V_Near = [(<span class="number">0</span>,<span class="number">1</span>),(<span class="number">1</span>,<span class="number">2</span>),(<span class="number">2</span>,<span class="number">0</span>),(<span class="number">3</span>,<span class="number">4</span>),(<span class="number">4</span>,<span class="number">5</span>),(<span class="number">5</span>,<span class="number">3</span>),(<span class="number">6</span>,<span class="number">7</span>),(<span class="number">7</span>,<span class="number">8</span>),(<span class="number">8</span>,<span class="number">6</span>)]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">FlipBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> i^(<span class="number">1</span>&lt;&lt;n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ReadBit</span>(<span class="params">i,n</span>):</span><br><span class="line">    <span class="keyword">return</span> (i&amp;(<span class="number">1</span>&lt;&lt;n))&gt;&gt;n</span><br><span class="line"></span><br><span class="line">H = np.zeros([n,n])</span><br><span class="line"><span class="keyword">for</span> state <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">for</span> (i,j) <span class="keyword">in</span> H_Near:</span><br><span class="line">        res = FlipBit( FlipBit(state,j) ,i)</span><br><span class="line">        H[state][res] = - Jx</span><br><span class="line">    <span class="keyword">for</span> (i,j) <span class="keyword">in</span> V_Near:</span><br><span class="line">        res = FlipBit( FlipBit(state,j) ,i)</span><br><span class="line">        flag = ReadBit(state, i) ^ ReadBit(state, j) </span><br><span class="line">        H[state][res] = - Jy <span class="keyword">if</span> flag == <span class="number">1</span> <span class="keyword">else</span> Jy</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">        flag = ReadBit(state, i)</span><br><span class="line">        H[state][state] +=  hz <span class="keyword">if</span> flag == <span class="number">1</span> <span class="keyword">else</span> -hz</span><br><span class="line"><span class="built_in">print</span>(H)</span><br><span class="line">E,W = LA.eigsh(H,<span class="number">20</span>,which = <span class="string">&#x27;SA&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(E)</span><br></pre></td></tr></table></figure>
<pre><code>[[-4.5  0.   0.  ...  0.   0.   0. ]
 [ 0.  -3.5 -1.4 ...  0.   0.   0. ]
 [ 0.  -1.4 -3.5 ...  0.   0.   0. ]
 ...
 [ 0.   0.   0.  ...  3.5 -1.4  0. ]
 [ 0.   0.   0.  ... -1.4  3.5  0. ]
 [ 0.   0.   0.  ...  0.   0.   4.5]]
[-13.12646931 -13.07866474 -13.07575853 -13.06893675 -13.03230613
 -13.02946844 -13.02304559 -12.9880016   -8.68300191  -8.56677243
  -8.56586155  -8.37964052  -8.37964052  -8.26479657  -8.23663151
  -8.23248641  -8.2288993   -8.21755532  -8.21755532  -8.21213607]
</code></pre><ul>
<li>æ¯”è¾ƒå‘ç°ï¼ŒMPO ç›¸ä¹˜å¾—åˆ°çš„å“ˆå¯†é¡¿é‡çŸ©é˜µå’Œå‰ 20 ä¸ªç‰¹å¾å€¼ï¼Œä¸ ED å¾—åˆ°çš„ç»“æœä¸€è‡´ã€‚</li>
</ul>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/30/Semiconductor%20physics1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/30/Semiconductor%20physics1/" class="post-title-link" itemprop="url">Semiconductor Physics(section 1)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-10-30 21:50:00 / ä¿®æ”¹æ—¶é—´ï¼š21:52:55" itemprop="dateCreated datePublished" datetime="2022-10-30T21:50:00+08:00">2022-10-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Semiconductor-Physics/" itemprop="url" rel="index"><span itemprop="name">Semiconductor Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="A-Quantum-mechanics"><a href="#A-Quantum-mechanics" class="headerlink" title="A. Quantum mechanics"></a>A. Quantum mechanics</h3><p>Suppose you have learnt Quantum Mechanics, here is just a brief review.<br>Some assumptions:</p>
<ol>
<li>Energy quantization:<br> Different from traditional physics, weâ€™re only allowed to exchange energy in individual packets, called photons, and the energy of this packet is just â€˜hâ€™ times the frequency â€˜fâ€™, i.e.:<script type="math/tex; mode=display">E = h\times f</script></li>
<li>Uncertainty principle:<br> The position of a moving particle and its momentum cannot be determined simultaneously, i.e.:<script type="math/tex; mode=display">\Delta x \Delta p \geq \frac{\hbar}{2}</script> another version with energy:<script type="math/tex; mode=display">\Delta E\Delta t \geq {\hbar}</script></li>
<li>Particles are waves:<script type="math/tex; mode=display">\lambda = \dfrac{h}{p}</script>Electrons must be described by $\Psi$, probability density $\propto |\Psi|^2$</li>
</ol>
<p>Based on these three assumptions, how do we â€œdoâ€ QM? Answer is Schroedinger Equation(S.Eq):</p>
<script type="math/tex; mode=display">H\phi = -\dfrac{\hbar}{2m}\nabla^2\phi+V\phi=E\phi</script><h3 id="B-Wave-number-â€˜kâ€™"><a href="#B-Wave-number-â€˜kâ€™" class="headerlink" title="B. Wave number â€˜kâ€™"></a>B. Wave number â€˜kâ€™</h3><p>The usual solution of S.Eq is :</p>
<script type="math/tex; mode=display">\phi = A\sin kx +B\cos kx</script><p>â€‹    where $k = \sqrt{\dfrac{2mE}{\hbar^2}}$</p>
<p>â€‹    So whatâ€™s the meaning of k? We know that k usually is the wave number in sine wave. </p>
<p>â€‹    Like $T = 2 \pi /w$ï¼Œ k represents the spatial frequency or how fast something changes in space.</p>
<p>â€‹    In QM, k is related to momentum:</p>
<script type="math/tex; mode=display">p = \hbar k</script><p>â€‹    for $E =p^2/2m$, we have:</p>
<script type="math/tex; mode=display">k = p/ \hbar = \sqrt{\dfrac{2mE}{\hbar^2}}</script><p>â€‹    S.Eq gives the relationship between wave number k and energy E. i.e. E(k)    </p>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/30/HW_DMRG/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/30/HW_DMRG/" class="post-title-link" itemprop="url">Tranditional DMRG on transverse-field Ising model</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-10-30 17:00:08 / ä¿®æ”¹æ—¶é—´ï¼š20:24:52" itemprop="dateCreated datePublished" datetime="2022-10-30T17:00:08+08:00">2022-10-30</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Computational-Quantum-Physics/" itemprop="url" rel="index"><span itemprop="name">Computational Quantum Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <font size = 5> Homework </font>

<ul>
<li><p>consider the transverse-field Ising model on a N-site chain</p>
<p>  please take the following parameters for homework:</p>
<p>  N = 30, J = 1, g $\in$ [0.7, 1.0, 1.7]</p>
<p>  keeping a maximum of m states in the new basis, m $\in$ [10, 20, 30]</p>
</li>
</ul>
<script type="math/tex; mode=display">
\begin{gathered}
H=-J \sum_{i=1}^{N-1}\left(g \sigma_i^x+\sigma_i^z \sigma_{i+1}^z\right) \quad J, g \geq 0 \\
\sigma^x=\left(\begin{array}{ll}
0 & 1 \\
1 & 0
\end{array}\right), \sigma^z=\left(\begin{array}{cc}
1 & 0 \\
0 & -1
\end{array}\right)
\end{gathered}</script><ul>
<li><p>based on the traditional finite size DMRG method, e.g.,</p>
<p>  <a target="_blank" rel="noopener" href="https://github.com/simple-dmrg/simple-dmrg">https://github.com/simple-dmrg/simple-dmrg</a> (finite system algorithm)</p>
<p>  plot the entanglement entropy S(L) as a function of L, $S(L)=-\operatorname{Tr}\left[\rho_L \ln \rho_L\right]$</p>
<p>  explicitly show the data of ground state energy and entanglement entropy</p>
<p>  \begin{equation}<br>  \text { (1) } m=30, g \in[0.7,1.0,1.7] \text {, (2) } g=1.0, m \in[10,20,30]<br>  \end{equation}</p>
</li>
</ul>
<ul>
<li><p>ç®€è¦æ€è·¯åˆ†æï¼š</p>
<p>  å¯¹ github ä¸Šçš„ finite system algorithm éƒ¨åˆ†è¿›è¡Œæ”¹å†™ã€‚å…¶ä¸­ä¸»è¦æ€è·¯å¦‚ä¸‹ï¼š</p>
<ol>
<li><p>æ ¹æ®å“ˆå¯†é¡¿é‡å½¢å¼å®šä¹‰å•ä½“å’Œä¸¤ä½“çš„ Hï¼Œå®šä¹‰ block æ•°æ®ç±»å‹ä½œä¸ºä¼ é€’ï¼›</p>
</li>
<li><p>enlarge_block å‡½æ•°å®ç°å‘å½“å‰çš„ block æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹çš„â€œæ‰©å±•â€ï¼Œä¸»è¦è€ƒè™‘ä¸‰éƒ¨åˆ†å˜åŒ–ï¼šcurrent block å†…çš„ä¸¤ä½“å“ˆå¯†é¡¿é‡ï¼Œ æ–°èŠ‚ç‚¹å†…çš„å•ä½“å“ˆå¯†é¡¿é‡ï¼Œä»¥åŠäºŒè€…è¿æ¥å¤„çš„ä¸¤ä½“å“ˆå¯†é¡¿é‡ï¼›</p>
</li>
<li><p>å•æ­¥DMRGï¼Œæ‰§è¡Œä¸€ä¸ªDMRGæ­¥éª¤ï¼Œä½¿ç”¨â€™ sys â€˜ä½œä¸ºç³»ç»Ÿï¼Œâ€™ env â€˜ä½œä¸ºç¯å¢ƒï¼Œæˆªå– m ä¸ªåŸºçŸ¢ï¼›</p>
</li>
<li><p>Traditional finite DMRG algorithmï¼Œ å…ˆåš infinte çš„ DMRG çš„ enlargeï¼Œ å°†ç»“æœå­˜åˆ° block_disk ä¸­æ–¹ä¾¿åé¢è°ƒç”¨ã€‚ç„¶ååš full size çš„ finite DMRGï¼Œå³ sweep back and forth ç›´åˆ°æ”¶æ•›</p>
</li>
</ol>
</li>
<li><p>å¯¹æºä»£ç çš„ä¿®æ”¹ä¸»è¦åŒ…æ‹¬å‡ ä¸ªéƒ¨åˆ†ï¼š</p>
<ol>
<li><p>å“ˆå¯†é¡¿é‡å•ä½“å’Œä¸¤ä½“ä½œç”¨ï¼Œä»¥åŠåé¢è°ƒç”¨æ¥å£çš„ä¿®æ”¹ï¼›</p>
</li>
<li><p>å¯†åº¦çŸ©é˜µ rho ä½œä¸ºç»“æœ returnï¼Œ å¹¶è®¡ç®—çº ç¼ ç†µã€‚æˆ‘ä»¬çŸ¥é“çŸ©é˜µçš„è¿¹ç­‰äºå…¶ç‰¹å¾å€¼çš„å’Œï¼Œæ®æ­¤æ¥è®¡ç®— S(L)ï¼›</p>
</li>
<li><p>æ”¶æ•›åˆ¤æ®ã€‚åŸä»£ç å¯¹äºæ¯ä¸€ä¸ª m ï¼Œåšäº†ä¸€ä¸ªå‘¨æœŸçš„ sweepï¼Œè¿™é‡Œå°†æ”¶æ•›åˆ¤æ®æ”¹æˆ E/L çš„æ”¶æ•›æƒ…å†µï¼ˆå°½ç®¡ç»è¿‡æµ‹è¯•ï¼ŒåŸä»£ç ä¹Ÿæ”¶æ•›ï¼‰ï¼›</p>
</li>
<li><p>å…¶ä»–ï¼ˆä¾‹å¦‚L,m_warmupå‚æ•°ä¿®æ”¹ç­‰ trivial çš„åœ°æ–¹ï¼‰ã€‚</p>
</li>
</ol>
</li>
<li><p>ä¸€ç‚¹è¯´æ˜ï¼šEE[] å­˜å‚¨çº ç¼ ç†µç›¸å…³æ•°æ®ï¼ŒEL[] å­˜å‚¨åŸºæ€èƒ½é‡ç›¸å…³æ•°æ®</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Simple DMRG tutorial.  This code integrates the following concepts:</span></span><br><span class="line"><span class="comment">#  - Infinite system algorithm</span></span><br><span class="line"><span class="comment">#  - Finite system algorithm</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Copyright 2013 James R. Garrison and Ryan V. Mishmash.</span></span><br><span class="line"><span class="comment"># Open source under the MIT license.  Source code at</span></span><br><span class="line"><span class="comment"># &lt;https://github.com/simple-dmrg/simple-dmrg/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This code will run under any version of Python &gt;= 2.6.  The following line</span></span><br><span class="line"><span class="comment"># provides consistency between python2 and python3.</span></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function, division  <span class="comment"># requires Python &gt;= 2.6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># numpy and scipy imports</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> scipy.sparse <span class="keyword">import</span> kron, identity</span><br><span class="line"><span class="keyword">from</span> scipy.sparse.linalg <span class="keyword">import</span> eigsh  <span class="comment"># Lanczos routine from ARPACK</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># We will use python&#x27;s &quot;namedtuple&quot; to represent the Block and EnlargedBlock</span></span><br><span class="line"><span class="comment"># objects</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"></span><br><span class="line">Block = namedtuple(<span class="string">&quot;Block&quot;</span>, [<span class="string">&quot;length&quot;</span>, <span class="string">&quot;basis_size&quot;</span>, <span class="string">&quot;operator_dict&quot;</span>])</span><br><span class="line">EnlargedBlock = namedtuple(<span class="string">&quot;EnlargedBlock&quot;</span>, [<span class="string">&quot;length&quot;</span>, <span class="string">&quot;basis_size&quot;</span>, <span class="string">&quot;operator_dict&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_block</span>(<span class="params">block</span>):</span><br><span class="line">    <span class="keyword">for</span> op <span class="keyword">in</span> block.operator_dict.values():</span><br><span class="line">        <span class="keyword">if</span> op.shape[<span class="number">0</span>] != block.basis_size <span class="keyword">or</span> op.shape[<span class="number">1</span>] != block.basis_size:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This function should test the same exact things, so there is no need to</span></span><br><span class="line"><span class="comment"># repeat its definition.</span></span><br><span class="line">is_valid_enlarged_block = is_valid_block</span><br><span class="line"></span><br><span class="line"><span class="comment"># Model-specific code for the TF Ising Model</span></span><br><span class="line">model_d = <span class="number">2</span>  <span class="comment"># single-site basis size</span></span><br><span class="line"></span><br><span class="line">Sz1 = np.array([[<span class="number">1.0</span>, <span class="number">0</span>], [<span class="number">0</span>, -<span class="number">1.0</span>]], dtype=<span class="string">&#x27;d&#x27;</span>)  <span class="comment"># single-site S^z</span></span><br><span class="line">Sx1 = np.array([[<span class="number">0</span>, <span class="number">1.0</span>], [<span class="number">1.0</span>, <span class="number">0</span>]], dtype=<span class="string">&#x27;d&#x27;</span>)  <span class="comment"># single-site S^x</span></span><br><span class="line">EE = []</span><br><span class="line">EL = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vn_eig_entropy</span>(<span class="params">rho</span>):</span><br><span class="line">    <span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">    <span class="keyword">from</span> scipy <span class="keyword">import</span> linalg <span class="keyword">as</span> la</span><br><span class="line">    <span class="keyword">import</span> math <span class="keyword">as</span> m</span><br><span class="line">    EV = la.eigvals(rho)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Drop zero eigenvalues so that log2 is defined</span></span><br><span class="line">    my_list = [x <span class="keyword">for</span> x <span class="keyword">in</span> EV.tolist() <span class="keyword">if</span> x]</span><br><span class="line">    EV = np.array(my_list)</span><br><span class="line"></span><br><span class="line">    ln_EV = np.matrix(np.log(EV))</span><br><span class="line">    EV = np.matrix(EV)</span><br><span class="line">    S = -np.dot(EV, ln_EV.H)</span><br><span class="line">    <span class="keyword">return</span>(S)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">H1</span>(<span class="params">Sx1, g</span>):    <span class="comment"># single-site part of H</span></span><br><span class="line">    J = <span class="number">1.</span></span><br><span class="line">    <span class="keyword">return</span> - J * g * Sx1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">H2</span>(<span class="params">Sz1, Sz2</span>):  <span class="comment"># two-site part of H</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;Given the operators S^z and S^+ on two sites in different Hilbert spaces</span></span><br><span class="line"><span class="string">    (e.g. two blocks), returns a Kronecker product representing the</span></span><br><span class="line"><span class="string">    corresponding two-site term in the Hamiltonian that joins the two sites.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    J = <span class="number">1.</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        - J * kron(Sz1, Sz2)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enlarge_block</span>(<span class="params">block, g</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;This function enlarges the provided Block by a single site, returning an</span></span><br><span class="line"><span class="string">    EnlargedBlock.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    mblock = block.basis_size</span><br><span class="line">    o = block.operator_dict</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Create the new operators for the enlarged block.  Our basis becomes a</span></span><br><span class="line">    <span class="comment"># Kronecker product of the Block basis and the single-site basis.  <span class="doctag">NOTE:</span></span></span><br><span class="line">    <span class="comment"># `kron` uses the tensor product convention making blocks of the second</span></span><br><span class="line">    <span class="comment"># array scaled by the first.  As such, we adopt this convention for</span></span><br><span class="line">    <span class="comment"># Kronecker products throughout the code.</span></span><br><span class="line">    enlarged_operator_dict = &#123;</span><br><span class="line">        <span class="string">&quot;H&quot;</span>: kron(o[<span class="string">&quot;H&quot;</span>], identity(model_d)) + kron(identity(mblock), H1(Sx1, g)) + H2(o[<span class="string">&quot;conn_Sz&quot;</span>], Sz1),</span><br><span class="line">        <span class="string">&quot;conn_Sz&quot;</span>: kron(identity(mblock), Sz1),</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> EnlargedBlock(length=(block.length + <span class="number">1</span>),</span><br><span class="line">                         basis_size=(block.basis_size * model_d),</span><br><span class="line">                         operator_dict=enlarged_operator_dict)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate_and_truncate</span>(<span class="params">operator, transformation_matrix</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Transforms the operator to the new (possibly truncated) basis given by</span></span><br><span class="line"><span class="string">    `transformation_matrix`.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> transformation_matrix.conjugate().transpose().dot(operator.dot(transformation_matrix))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">single_dmrg_step</span>(<span class="params">sys, env, m, g</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Performs a single DMRG step using `sys` as the system and `env` as the</span></span><br><span class="line"><span class="string">    environment, keeping a maximum of `m` states in the new basis.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> is_valid_block(sys)</span><br><span class="line">    <span class="keyword">assert</span> is_valid_block(env)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Enlarge each block by a single site.</span></span><br><span class="line">    sys_enl = enlarge_block(sys, g)</span><br><span class="line">    <span class="keyword">if</span> sys <span class="keyword">is</span> env:  <span class="comment"># no need to recalculate a second time</span></span><br><span class="line">        env_enl = sys_enl</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        env_enl = enlarge_block(env, g)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> is_valid_enlarged_block(sys_enl)</span><br><span class="line">    <span class="keyword">assert</span> is_valid_enlarged_block(env_enl)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct the full superblock Hamiltonian.</span></span><br><span class="line">    m_sys_enl = sys_enl.basis_size</span><br><span class="line">    m_env_enl = env_enl.basis_size</span><br><span class="line">    sys_enl_op = sys_enl.operator_dict</span><br><span class="line">    env_enl_op = env_enl.operator_dict</span><br><span class="line">    superblock_hamiltonian = kron(sys_enl_op[<span class="string">&quot;H&quot;</span>], identity(m_env_enl)) + kron(identity(m_sys_enl), env_enl_op[<span class="string">&quot;H&quot;</span>]) + \</span><br><span class="line">                             H2(sys_enl_op[<span class="string">&quot;conn_Sz&quot;</span>], env_enl_op[<span class="string">&quot;conn_Sz&quot;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Call ARPACK to find the superblock ground state.  (&quot;SA&quot; means find the</span></span><br><span class="line">    <span class="comment"># &quot;smallest in amplitude&quot; eigenvalue.)</span></span><br><span class="line">    (energy,), psi0 = eigsh(superblock_hamiltonian, k=<span class="number">1</span>, which=<span class="string">&quot;SA&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Construct the reduced density matrix of the system by tracing out the</span></span><br><span class="line">    <span class="comment"># environment</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># We want to make the (sys, env) indices correspond to (row, column) of a</span></span><br><span class="line">    <span class="comment"># matrix, respectively.  Since the environment (column) index updates most</span></span><br><span class="line">    <span class="comment"># quickly in our Kronecker product structure, psi0 is thus row-major (&quot;C</span></span><br><span class="line">    <span class="comment"># style&quot;).</span></span><br><span class="line">    psi0 = psi0.reshape([sys_enl.basis_size, -<span class="number">1</span>], order=<span class="string">&quot;C&quot;</span>)</span><br><span class="line">    rho = np.dot(psi0, psi0.conjugate().transpose())</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Diagonalize the reduced density matrix and sort the eigenvectors by</span></span><br><span class="line">    <span class="comment"># eigenvalue.</span></span><br><span class="line">    evals, evecs = np.linalg.eigh(rho)</span><br><span class="line">    possible_eigenstates = []</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">eval</span>, evec <span class="keyword">in</span> <span class="built_in">zip</span>(evals, evecs.transpose()):</span><br><span class="line">        possible_eigenstates.append((<span class="built_in">eval</span>, evec))</span><br><span class="line">    possible_eigenstates.sort(reverse=<span class="literal">True</span>, key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])  <span class="comment"># largest eigenvalue first</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Build the transformation matrix from the `m` overall most significant</span></span><br><span class="line">    <span class="comment"># eigenvectors.</span></span><br><span class="line">    my_m = <span class="built_in">min</span>(<span class="built_in">len</span>(possible_eigenstates), m)</span><br><span class="line">    transformation_matrix = np.zeros((sys_enl.basis_size, my_m), dtype=<span class="string">&#x27;d&#x27;</span>, order=<span class="string">&#x27;F&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i, (<span class="built_in">eval</span>, evec) <span class="keyword">in</span> <span class="built_in">enumerate</span>(possible_eigenstates[:my_m]):</span><br><span class="line">        transformation_matrix[:, i] = evec</span><br><span class="line"></span><br><span class="line">    truncation_error = <span class="number">1</span> - <span class="built_in">sum</span>([x[<span class="number">0</span>] <span class="keyword">for</span> x <span class="keyword">in</span> possible_eigenstates[:my_m]])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;truncation error:&quot;</span>, truncation_error)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Rotate and truncate each operator.</span></span><br><span class="line">    new_operator_dict = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> name, op <span class="keyword">in</span> sys_enl.operator_dict.items():</span><br><span class="line">        new_operator_dict[name] = rotate_and_truncate(op, transformation_matrix)</span><br><span class="line"></span><br><span class="line">    newblock = Block(length=sys_enl.length,</span><br><span class="line">                     basis_size=my_m,</span><br><span class="line">                     operator_dict=new_operator_dict)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> newblock, energy, rho</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">graphic</span>(<span class="params">sys_block, env_block, sys_label=<span class="string">&quot;l&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;Returns a graphical representation of the DMRG step we are about to</span></span><br><span class="line"><span class="string">    perform, using &#x27;=&#x27; to represent the system sites, &#x27;-&#x27; to represent the</span></span><br><span class="line"><span class="string">    environment sites, and &#x27;**&#x27; to represent the two intermediate sites.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">assert</span> sys_label <span class="keyword">in</span> (<span class="string">&quot;l&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">    graphic = (<span class="string">&quot;=&quot;</span> * sys_block.length) + <span class="string">&quot;**&quot;</span> + (<span class="string">&quot;-&quot;</span> * env_block.length)</span><br><span class="line">    <span class="keyword">if</span> sys_label == <span class="string">&quot;r&quot;</span>:</span><br><span class="line">        <span class="comment"># The system should be on the right and the environment should be on</span></span><br><span class="line">        <span class="comment"># the left, so reverse the graphic.</span></span><br><span class="line">        graphic = graphic[::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> graphic</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">finite_system_algorithm</span>(<span class="params">L, m_warmup, m_sweep_list, g</span>):</span><br><span class="line">    <span class="keyword">assert</span> L % <span class="number">2</span> == <span class="number">0</span>  <span class="comment"># require that L is an even number</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># To keep things simple, this dictionary is not actually saved to disk, but</span></span><br><span class="line">    <span class="comment"># we use it to represent persistent storage.</span></span><br><span class="line">    block_disk = &#123;&#125;  <span class="comment"># &quot;disk&quot; storage for Block objects</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Use the infinite system algorithm to build up to desired size.  Each time</span></span><br><span class="line">    <span class="comment"># we construct a block, we save it for future reference as both a left</span></span><br><span class="line">    <span class="comment"># (&quot;l&quot;) and right (&quot;r&quot;) block, as the infinite system algorithm assumes the</span></span><br><span class="line">    <span class="comment"># environment is a mirror image of the system.</span></span><br><span class="line">    <span class="comment"># conn refers to the connection operator, that is, the operator on the edge of</span></span><br><span class="line">    <span class="comment"># the block, on the interior of the chain.  We need to be able to represent S^z</span></span><br><span class="line">    <span class="comment"># on that site in the current basis in order to grow the chain.</span></span><br><span class="line">    initial_block = Block(length=<span class="number">1</span>, basis_size=model_d, operator_dict=&#123;</span><br><span class="line">        <span class="string">&quot;H&quot;</span>: H1(Sx1, g),</span><br><span class="line">        <span class="string">&quot;conn_Sz&quot;</span>: Sz1,</span><br><span class="line">    &#125;)</span><br><span class="line">    block = initial_block</span><br><span class="line">    block_disk[<span class="string">&quot;l&quot;</span>, block.length] = block</span><br><span class="line">    block_disk[<span class="string">&quot;r&quot;</span>, block.length] = block</span><br><span class="line">    <span class="keyword">while</span> <span class="number">2</span> * block.length &lt; L:</span><br><span class="line">        <span class="comment"># Perform a single DMRG step and save the new Block to &quot;disk&quot;</span></span><br><span class="line">        <span class="comment">#print(graphic(block, block))</span></span><br><span class="line">        block, energy, rho = single_dmrg_step(block, block, m=m_warmup, g =g )</span><br><span class="line">        <span class="comment">#print(&quot;E/L =&quot;, energy / (block.length * 2))</span></span><br><span class="line">        block_disk[<span class="string">&quot;l&quot;</span>, block.length] = block</span><br><span class="line">        block_disk[<span class="string">&quot;r&quot;</span>, block.length] = block</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Now that the system is built up to its full size, we perform sweeps using</span></span><br><span class="line">    <span class="comment"># the finite system algorithm.  At first the left block will act as the</span></span><br><span class="line">    <span class="comment"># system, growing at the expense of the right block (the environment), but</span></span><br><span class="line">    <span class="comment"># once we come to the end of the chain these roles will be reversed.</span></span><br><span class="line">    sys_label, env_label = <span class="string">&quot;l&quot;</span>, <span class="string">&quot;r&quot;</span></span><br><span class="line">    sys_block = block; <span class="keyword">del</span> block  <span class="comment"># rename the variable</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> m_sweep_list:</span><br><span class="line">        pre_energy = <span class="number">1.</span></span><br><span class="line">        flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># Load the appropriate environment block from &quot;disk&quot;</span></span><br><span class="line">            env_block = block_disk[env_label, L - sys_block.length - <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Perform a single DMRG step.</span></span><br><span class="line">            <span class="built_in">print</span>(graphic(sys_block, env_block, sys_label))</span><br><span class="line">            <span class="comment">#è®°å½•ä¸€ä¸‹ä¹‹å‰çš„ E</span></span><br><span class="line">            </span><br><span class="line">            sys_block, energy, rho = single_dmrg_step(sys_block, env_block, m=m, g=g)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#print(&quot;E/L =&quot;, energy / L)</span></span><br><span class="line">            <span class="comment">#è®¡ç®—çº ç¼ ç†µ</span></span><br><span class="line">            S = np.real(vn_eig_entropy(rho)[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">            s = <span class="built_in">float</span>(S[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">            <span class="comment">#åŠ å…¥åˆ° EE,EL æ•°ç»„ä¸­</span></span><br><span class="line">            EE.append([s, sys_block.length, m, g])</span><br><span class="line">            EL.append([g, energy/L])</span><br><span class="line">            <span class="comment">#åè½¬</span></span><br><span class="line">            <span class="keyword">if</span> env_block.length == <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># We&#x27;ve come to the end of the chain, so we reverse course.</span></span><br><span class="line">                sys_block, env_block = env_block, sys_block</span><br><span class="line">                sys_label, env_label = env_label, sys_label</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Save the block from this step to disk.</span></span><br><span class="line">            block_disk[sys_label, sys_block.length] = sys_block</span><br><span class="line"></span><br><span class="line">            <span class="comment"># Check whether we just completed a full sweep.</span></span><br><span class="line">            <span class="comment">#if sys_label == &quot;l&quot; and 2 * sys_block.length == L:</span></span><br><span class="line">            <span class="comment">#    break  # escape from the &quot;while True&quot; loop</span></span><br><span class="line">            <span class="keyword">if</span> sys_label == <span class="string">&quot;l&quot;</span> <span class="keyword">and</span> <span class="number">2</span> * sys_block.length == L:</span><br><span class="line">                flag = <span class="number">1</span></span><br><span class="line">            <span class="comment">#print(pre_energy - energy)</span></span><br><span class="line">            <span class="keyword">if</span> np.<span class="built_in">abs</span>(energy/L - pre_energy/L) &lt; <span class="number">1e-16</span> <span class="keyword">and</span> flag == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            pre_energy = energy</span><br><span class="line">            <span class="comment">#å¾ªç¯æ¡ä»¶æ˜¯è‡³å°‘è·‘ä¸€ä¸ªå‘¨æœŸçš„sweepçš„åŸºç¡€ä¸Šï¼Œå‰åenergyå·®å¤§äº1e-16</span></span><br><span class="line">            </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><p>ç¬¬ä¸€é—®ï¼šm =30 ï¼Œg å– [0.7,1.0,1.7]</p>
</li>
<li><p>æ•°ç»„ EE å‚¨å­˜çš„æ˜¯ [s, sys_block.length, m, g ], åˆ†åˆ«å¯¹åº”ï¼šçº ç¼ ç†µï¼Œ ç³»ç»Ÿblocké•¿åº¦ï¼Œæˆªæ–­mï¼Œå‚æ•°gã€‚</p>
</li>
<li><p>ä¸‹é¢è¾“å‡ºçš„æ˜¯ g ä¸åŒå–å€¼ä¸‹çš„ data of ground state energy ä»¥åŠ entanglement entropyï¼ˆå›¾ä»å·¦å¾€å³æ˜¯gå–0.7ï¼Œ1.0ï¼Œ1.7ï¼‰</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">np.set_printoptions(precision=<span class="number">10</span>, suppress=<span class="literal">True</span>, threshold=<span class="number">10000</span>, linewidth=<span class="number">300</span>)</span><br><span class="line">plt.figure(figsize = (<span class="number">15</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">0.7</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;g=0.7&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">1.0</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;g=1.0&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;L&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">1.7</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;g=1.7&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br></pre></td></tr></table></figure>
<p>â€‹    </p>
<p><img src="https://s2.loli.net/2022/10/30/kH8NevQ16ugmiAa.png" alt="HW_DMRG_7_1.png"></p>
<ul>
<li><p>å¯è§åœ¨è¾¹ç•Œå¤„ï¼ˆLè¾ƒå°æˆ–è¾ƒå¤§å¤„ï¼‰çº ç¼ ç†µæ¯”è¾ƒå°ï¼Œåœ¨ä¸­é—´çº ç¼ ç†µæ¯”è¾ƒå¤§ã€‚è¿™æ˜¯ç¬¦åˆæˆ‘ä»¬çš„ç‰©ç†ç›´è§‰çš„ï¼šè¾¹ç•Œä¸Šç³»ç»Ÿ/ç¯å¢ƒ block ç»„æˆå°ï¼Œçº ç¼ çš„æ··ä¹±ç¨‹åº¦ï¼ˆç†µï¼‰ç›¸å¯¹å°ã€‚</p>
</li>
<li><p>æ­¤å¤–å¯è§ g çš„ä¸åŒå–å€¼ä¼šå½±å“çº ç¼ ç†µï¼Œå¯¹äº g è¿œç¦» 1 çš„å–å€¼ï¼Œå¯è§ä»–ä»¬ä¸­é—´æ¯”è¾ƒå¹³æ»‘ï¼Œå¯¹äº g  = 1 ï¼Œ æœ‰ç‚¹åƒä¸€ä¸ªæŠ›ç‰©çº¿ï¼Œ å¯èƒ½ä¸ g = 1 æ˜¯ TF Ising Model çš„ç›¸å˜ç‚¹æœ‰å…³ã€‚</p>
</li>
<li><p>ä¸ºäº†æ›´åŠ ç›´è§‚åœ°è¯´æ˜æ”¶æ•›æƒ…å†µï¼Œè¿™é‡Œç”»å‡ºäº† E/L éšç€ DMRG æ¬¡æ•°å¢é•¿çš„å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä»å·¦å¾€å³åˆ†åˆ«æ˜¯ g = 0.7ï¼Œ1.0ï¼Œ1.7ï¼Œæ¨ªåæ ‡æ˜¯ DMRG æ­¥æ•°ï¼Œ çºµåæ ‡æ˜¯ E/L å¤§å°ã€‚ç”¨çš„æ”¶æ•›æ¡ä»¶æ˜¯ï¼šè‡³å°‘ sweep ä¸€ä¸ªå‘¨æœŸçš„åŸºç¡€ä¸Šï¼Œç›´åˆ° E/L å·®å€¼å°äº 1e-16ã€‚ç”±ä¸‹å›¾å¯çŸ¥ï¼Œå…¶å®åŸä»£ç çš„å†™æ³•å°±å·²ç»æ”¶æ•›äº†ã€‚</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">EL1,EL2,EL3 =[], [], []</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> EL:</span><br><span class="line">    <span class="keyword">if</span> item[<span class="number">0</span>] == <span class="number">0.7</span>:</span><br><span class="line">        EL1.append(item[<span class="number">1</span>])  </span><br><span class="line">    <span class="keyword">elif</span> item[<span class="number">0</span>] == <span class="number">1.0</span>:</span><br><span class="line">        EL2.append(item[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">elif</span> item[<span class="number">0</span>] == <span class="number">1.7</span>:</span><br><span class="line">        EL3.append(item[<span class="number">1</span>]) </span><br><span class="line">plt.figure(figsize = (<span class="number">15</span>,<span class="number">4</span>))</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">plt.plot([x <span class="keyword">for</span> x <span class="keyword">in</span> EL1])</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">plt.plot([x <span class="keyword">for</span> x <span class="keyword">in</span> EL2])</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">plt.plot([x <span class="keyword">for</span> x <span class="keyword">in</span> EL3])</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2022/10/30/vc41Kxh9EQowka3.png" alt="HW_DMRG_9_1.png"></p>
<ul>
<li><p>ç¬¬äºŒé¢˜ï¼Œ g = 1.0 , m =[10,20,30]</p>
</li>
<li><p>å–ä¸åŒå¤§å°çš„æˆªæ–­ basisï¼Œä¸‹é¢è¾“å‡ºçš„æ˜¯ m ä¸åŒå–å€¼ä¸‹çš„ data of ground state energy ä»¥åŠ entanglement entropyï¼ˆå›¾ä»å·¦å¾€å³æ˜¯må–10ï¼Œ20ï¼Œ30ï¼‰ï¼š</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">np.set_printoptions(precision=<span class="number">10</span>, suppress=<span class="literal">True</span>, threshold=<span class="number">10000</span>, linewidth=<span class="number">300</span>)</span><br><span class="line">plt.figure(figsize = (<span class="number">15</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">10</span>, m_sweep_list=[<span class="number">10</span>], g = <span class="number">1.0</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">1</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;m=10&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">20</span>, m_sweep_list=[<span class="number">20</span>], g = <span class="number">1.0</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;m=20&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;L&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">1.0</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">3</span>,<span class="number">3</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;m=30&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2022/10/30/h247qrDxaJXo6AF.png" alt="HW_DMRG_11_1.png"></p>
<ul>
<li>ç”±ä¸Šå›¾å¯è§ï¼Œå¯¹äº m å– 10ï¼Œ20ï¼Œ30 è€Œè¨€ï¼Œçº ç¼ ç†µ S(L) å¹¶æ— æ˜æ˜¾å·®å¼‚ï¼›æ­¤å¤–å¯¹ä¸åŒçš„ m ï¼Œ E/L çš„å€¼ä¹Ÿéƒ½å¤§è‡´æ”¶æ•›åˆ° -1.2612699.</li>
</ul>
<p><font size = 5>Extension</font></p>
<ul>
<li>å‰é¢ä¸¤é¢˜è®¨è®ºäº†å‡ ä¸ªä¸åŒçš„ m/g å€¼ä¸‹çš„ S(L)ï¼Œå…¶ä¸­å‘ç°å¯¹ g = 0.7ï¼Œ g = 1.7 çš„ S(L) æœ‰ç›¸ä¼¼æ€§ï¼Œä¼°è®¡å…¶â€œå½¢çŠ¶â€åœ¨ g = 1 â€œå¯¹ç§°â€ï¼Œä¸‹é¢å†å¤šç®—å‡ ç»„ g [0.85,0.95,1.05,1.15]ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¯è§ $g \leq 1$ æ—¶å³°é€æ¸å˜å°–ï¼Œ $g \geq 1$æ—¶å³°é€æ¸å˜å¹³å¦ï¼Œå°è¯äº†å‰é¢çš„çŒœæµ‹ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">np.set_printoptions(precision=<span class="number">10</span>, suppress=<span class="literal">True</span>, threshold=<span class="number">10000</span>, linewidth=<span class="number">300</span>)</span><br><span class="line">plt.figure(figsize = (<span class="number">20</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">0.85</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">4</span>,<span class="number">1</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;g=0.85&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">0.95</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">4</span>,<span class="number">2</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;g=0.95&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;L&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">1.05</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;g=1.05&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br><span class="line"></span><br><span class="line">finite_system_algorithm(L=<span class="number">30</span>, m_warmup=<span class="number">30</span>, m_sweep_list=[<span class="number">30</span>], g = <span class="number">1.15</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">4</span>,<span class="number">4</span>)</span><br><span class="line">plt.scatter([EE[x][<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))], [EE[y][<span class="number">0</span>] <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(EE))])</span><br><span class="line">plt.title(<span class="string">&quot;g=1.15&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;L&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;S(L)&quot;</span>)</span><br><span class="line">EE.clear()</span><br></pre></td></tr></table></figure>
<p><img src="https://s2.loli.net/2022/10/30/erwOLEVKpoqTjGb.png" alt="HW_DMRG_14_1.png"></p>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/26/Semiconductor%20physics0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/26/Semiconductor%20physics0/" class="post-title-link" itemprop="url">Semiconductor Physics(section 0)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-10-26 11:03:17" itemprop="dateCreated datePublished" datetime="2022-10-26T11:03:17+08:00">2022-10-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-10-29 18:26:12" itemprop="dateModified" datetime="2022-10-29T18:26:12+08:00">2022-10-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Semiconductor-Physics/" itemprop="url" rel="index"><span itemprop="name">Semiconductor Physics</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><u><em>The original source is from YouTube up Jodan Edmunds</em></u></p>
<p>Firstly, we raise two central questions in semiconductor physics.</p>
<ol>
<li>How many charge carries do we have?</li>
<li>Where are they and how are they moving?</li>
</ol>
<p>Here is a little road map:</p>
<pre class="mermaid">graph TD;
    C([Conservation <br> laws])
    A["Quantum Mech <br> and Stat Mech"] --> DOS & E/k & B[ferimi Stat]
    DOS & E/k & B[ferimi Stat] --> D["How many? <br> &int; DOS FS dE"]</pre>



<pre class="mermaid">graph TD;
    A["Maxwell's Eq and <br> Prob Theory"] --> B[Carrier Drift] & C[Carrier Diffusion] & D["Generation && <br> Recombination"]
    B --> E[Ohm's Law]
    B & C & D --> F["Continuity Eq and <br> Ambipolar transport"]
    F --> G[P/N junctions] & P[diodes] & H[MOSFETs,BJTs] & Q[Optical Devices]</pre>




      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/25/PDF-upload-and-preview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Hsu Quinn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BLOG">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/25/PDF-upload-and-preview/" class="post-title-link" itemprop="url">PDF upload and preview</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-10-25 19:30:22" itemprop="dateCreated datePublished" datetime="2022-10-25T19:30:22+08:00">2022-10-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-10-26 14:19:30" itemprop="dateModified" datetime="2022-10-26T14:19:30+08:00">2022-10-26</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog-Setting/" itemprop="url" rel="index"><span itemprop="name">Blog Setting</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="é˜…è¯»æ¬¡æ•°">
              <span class="post-meta-item-icon">
                <i class="fa fa-users"></i>
              </span>
              <span class="post-meta-item-text">é˜…è¯»æ¬¡æ•°ï¼š</span>
              <span class="firestore-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Hexoåšå®¢ä¸Šä¼ æœ¬åœ°æ–‡ä»¶ä»¥åŠå®ç°PDFé¢„è§ˆ"><a href="#Hexoåšå®¢ä¸Šä¼ æœ¬åœ°æ–‡ä»¶ä»¥åŠå®ç°PDFé¢„è§ˆ" class="headerlink" title="Hexoåšå®¢ä¸Šä¼ æœ¬åœ°æ–‡ä»¶ä»¥åŠå®ç°PDFé¢„è§ˆ"></a>Hexoåšå®¢ä¸Šä¼ æœ¬åœ°æ–‡ä»¶ä»¥åŠå®ç°PDFé¢„è§ˆ</h2><h3 id="ä¸Šä¼ æœ¬åœ°æ–‡ä»¶"><a href="#ä¸Šä¼ æœ¬åœ°æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æœ¬åœ°æ–‡ä»¶"></a>ä¸Šä¼ æœ¬åœ°æ–‡ä»¶</h3><p>æŠŠæ–‡ä»¶æ”¾åœ¨<code>source</code>æ–‡ä»¶ä¸‹ï¼Œå†ä½¿ç”¨<code>hexo d</code>éƒ¨ç½²æ—¶ï¼Œæ–‡ä»¶ä¼šè‡ªåŠ¨è¢«ä¸Šä¼ åˆ°Githubä¸Šã€‚ä¸ºäº†ä¾¿äºæ–‡ä»¶ç®¡ç†å’Œç»„ç»‡ï¼Œå¯ä»¥åœ¨<code>source</code>æ–‡ä»¶ä¸‹æ–°å»º<code>file</code>æ–‡ä»¶å¤¹ç”¨äºåˆ†ç±»å­˜å‚¨æ–‡ä»¶ã€‚</p>
<p>ä½¿ç”¨<code>hexo d</code>éƒ¨ç½²åï¼Œæ–‡ä»¶çš„é“¾æ¥æ˜¯<code>åšå®¢åŸŸå/file/æ–‡ä»¶å</code>ã€‚</p>
<p>æœ‰ä¸¤ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>é“¾æ¥ä¸­éœ€è¦åŒ…å«æ–‡ä»¶åçš„åç¼€ï¼›</li>
<li>æ–‡ä»¶åæœ€å¥½ç”±æ•°å­—å’Œå­—æ¯ç»„æˆï¼Œä¸è¦åŒ…å«ä¸­æ–‡ã€ç©ºæ ¼æˆ–è¿™ç‰¹æ®Šå­—ç¬¦ã€‚è§£ææ—¶å€™å®¹æ˜“å‡ºé”™ã€‚</li>
</ol>
<h3 id="æ·»åŠ hexoåšå®¢bookå¯¼èˆªæ "><a href="#æ·»åŠ hexoåšå®¢bookå¯¼èˆªæ " class="headerlink" title="æ·»åŠ hexoåšå®¢bookå¯¼èˆªæ "></a>æ·»åŠ hexoåšå®¢bookå¯¼èˆªæ </h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo new page book</span><br></pre></td></tr></table></figure>
<p>åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶å¤¹ä¸‹æ·»åŠ :</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Book:</span><br><span class="line">	url: /book</span><br><span class="line">	icon: fas fa-book</span><br></pre></td></tr></table></figure>
<p>åœ¨bookæ–‡ä»¶å¤¹ä¸­çš„index.mdä¸­æ·»åŠ ä½ ç”Ÿæˆçš„pdfæ–‡ä»¶é“¾æ¥å³å¯</p>
<h3 id="æ–‡ç« ä¸­æ·»åŠ pdfé¢„è§ˆåŠŸèƒ½"><a href="#æ–‡ç« ä¸­æ·»åŠ pdfé¢„è§ˆåŠŸèƒ½" class="headerlink" title="æ–‡ç« ä¸­æ·»åŠ pdfé¢„è§ˆåŠŸèƒ½"></a>æ–‡ç« ä¸­æ·»åŠ pdfé¢„è§ˆåŠŸèƒ½</h3><p>PDFé¢„è§ˆåŠŸèƒ½éœ€è¦å€ŸåŠ©<a target="_blank" rel="noopener" href="https://github.com/superalsrk/hexo-pdf/">hexo-pdfæ’ä»¶</a>å®ç°ã€‚æ’ä»¶éå¸¸å°å·§æ–¹ä¾¿ï¼Œå…³äºæ’ä»¶çš„å®‰è£…å’Œä½¿ç”¨ï¼Œæ’ä»¶ä½œè€…å·²ç»åœ¨ä¸»é¡µä»‹ç»çš„å¾ˆè¯¦ç»†äº†ã€‚</p>
<ol>
<li>hexo-pdfæ’ä»¶ã€‚é€šè¿‡npmå®‰è£…ï¼Œæ³¨æ„æ˜¯åœ¨hexoæ ¹ç›®å½•ä¸‹æ‰§è¡Œè¯¥è¯­å¥ã€‚<code>npm install --save hexo-pdf</code></li>
<li>åº”ç”¨ã€‚åœ¨æ–‡ç« åˆé€‚ä½ç½®æ’å…¥ä»£ç ã€‚å¯¹äºä¸€èˆ¬çš„PDFæ–‡ä»¶ã€Google Driverå’ŒSlideshareéƒ½å¯ä»¥ä½¿ç”¨<code>&#123;% pdf é“¾æ¥ %&#125;</code>çš„å½¢å¼ï¼Œä¾‹å¦‚<code>&#123;% pdf http://xsdg217.github.io/221020fang.pdf %&#125;</code>ã€‚å¯¹äºä¸€èˆ¬çš„PDFæ–‡ä»¶ä¹Ÿå¯ä»¥æœ¬åœ°PDFã€‚</li>
</ol>
<h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43827595/article/details/104574959">ã€å¦‚ä½•åœ¨ç½‘é¡µä¸­å®ç°pdfåœ¨çº¿é¢„è§ˆã€‘10åˆ†é’Ÿå­¦ä¼šå¦‚ä½•åˆ©ç”¨Hexoåšå®¢ä¸Šä¼ æœ¬åœ°pdfæ–‡ä»¶å¹¶åœ¨çº¿é¢„è§ˆpdf</a></p>

      
    </div>

    
    
    
	
      

      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Hsu Quinn"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Hsu Quinn</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/Xsdg217" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;Xsdg217" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fawkes@mail.ustc.edu.cn" title="E-Mail â†’ mailto:fawkes@mail.ustc.edu.cn" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/6090876649" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;6090876649" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/bing-tang-bo-luo-89" title="Zhihu â†’ https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;bing-tang-bo-luo-89" rel="noopener" target="_blank"><i class="fa fa-globe fa-fw"></i>Zhihu</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://music.163.com/#/user/home?id=1383517537" title="Wangyiyun â†’ https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;1383517537" rel="noopener" target="_blank"><i class="fa fa-music fa-fw"></i>Wangyiyun</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://space.bilibili.com/58820360" title="BiliBili â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;58820360" rel="noopener" target="_blank"><i class="fa fa-telegram fa-fw"></i>BiliBili</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2015 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hsu Quinn</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> å¼ºåŠ›é©±åŠ¨
  </div>
        




  <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.3.3/firebase-firestore.js"></script>
  <script>
    firebase.initializeApp({
      apiKey   : '',
      projectId: 'count0908-21d35'
    });

    function getCount(doc, increaseCount) {
      // IncreaseCount will be false when not in article page
      return doc.get().then(d => {
        var count = 0;
        if (!d.exists) { // Has no data, initialize count
          if (increaseCount) {
            doc.set({
              count: 1
            });
            count = 1;
          }
        } else { // Has data
          count = d.data().count;
          if (increaseCount) {
            // If first view this article
            doc.set({ // Increase count
              count: count + 1
            });
            count++;
          }
        }

        return count;
      });
    }

    function appendCountTo(el) {
      return count => {
        el.innerText = count;
      }
    }
  </script>
  <script>
    (function() {
      var db = firebase.firestore();
      var articles = db.collection('articles');

      if (CONFIG.page.isPost) { // Is article page
        var title = document.querySelector('.post-title').innerText.trim();
        var doc = articles.doc(title);
        var increaseCount = CONFIG.hostname === location.hostname;
        if (localStorage.getItem(title)) {
          increaseCount = false;
        } else {
          // Mark as visited
          localStorage.setItem(title, true);
        }
        getCount(doc, increaseCount).then(appendCountTo(document.querySelector('.firestore-visitors-count')));
      } else if (CONFIG.page.isHome) { // Is index page
        var promises = [...document.querySelectorAll('.post-title')].map(element => {
          var title = element.innerText.trim();
          var doc = articles.doc(title);
          return getCount(doc);
        });
        Promise.all(promises).then(counts => {
          var metas = document.querySelectorAll('.firestore-visitors-count');
          counts.forEach((val, idx) => {
            appendCountTo(metas[idx])(val);
          });
        });
      }
    })();
  </script>




      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/medium-zoom@1/dist/medium-zoom.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  











<script>
document.querySelectorAll('.pdfobject-container').forEach(element => {
  let url = element.dataset.target;
  let pdfOpenParams = {
    navpanes : 0,
    toolbar  : 0,
    statusbar: 0,
    pagemode : 'thumbs',
    view     : 'FitH'
  };
  let pdfOpenFragment = '#' + Object.entries(pdfOpenParams).map(([key, value]) => `${key}=${encodeURIComponent(value)}`).join('&');
  let fullURL = `/lib/pdf/web/viewer.html?file=${encodeURIComponent(url)}${pdfOpenFragment}`;

  if (NexT.utils.supportsPDFs()) {
    element.innerHTML = `<embed class="pdfobject" src="${url + pdfOpenFragment}" type="application/pdf" style="height: ${element.dataset.height};">`;
  } else {
    element.innerHTML = `<iframe src="${fullURL}" style="height: ${element.dataset.height};" frameborder="0"></iframe>`;
  }
});
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
